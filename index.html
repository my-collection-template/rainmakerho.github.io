<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>亂馬客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="技術、架構只有最適合的方案">
<meta property="og:type" content="website">
<meta property="og:title" content="亂馬客">
<meta property="og:url" content="https://rainmakerho.github.io/index.html">
<meta property="og:site_name" content="亂馬客">
<meta property="og:description" content="技術、架構只有最適合的方案">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="亂馬客">
<meta name="twitter:description" content="技術、架構只有最適合的方案">
  
    <link rel="alternate" href="/atom.xml" title="亂馬客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">亂馬客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">技術得來速</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Søk"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://rainmakerho.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-2017012" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/16/2017012/" class="article-date">
  <time datetime="2017-11-16T01:57:34.000Z" itemprop="datePublished">2017-11-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/16/2017012/">解析 SQL Server Deadlocks</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="最近收到了-Deadlock-的-trace-file，如下圖，"><a href="#最近收到了-Deadlock-的-trace-file，如下圖，" class="headerlink" title="最近收到了 Deadlock 的 trace file，如下圖，"></a>最近收到了 Deadlock 的 trace file，如下圖，</h4><img src="/2017/11/16/2017012/001.png" alt="Deadlock graph" title="Deadlock graph">
<h4 id="如果直接看圖示資訊不夠清楚的話，可以將那個-trc-檔用-Notepad-來開，用-xml-方式檢視，就可以看到更多詳細的資料，如下圖，"><a href="#如果直接看圖示資訊不夠清楚的話，可以將那個-trc-檔用-Notepad-來開，用-xml-方式檢視，就可以看到更多詳細的資料，如下圖，" class="headerlink" title="如果直接看圖示資訊不夠清楚的話，可以將那個 trc 檔用 Notepad++ 來開，用 xml 方式檢視，就可以看到更多詳細的資料，如下圖，"></a>如果直接看圖示資訊不夠清楚的話，可以將那個 trc 檔用 Notepad++ 來開，用 xml 方式檢視，就可以看到更多詳細的資料，如下圖，</h4><img src="/2017/11/16/2017012/002.png" alt="View in Notepad++" title="View in Notepad++">
<h4 id="當然如果這樣資訊又太雜的話，那還有一個方式，就是在那個-Deadlock-graph-那列上面按右鍵，選取「擷取事件資料-X-」將它另存成-xdl-檔，然後用-「SQL-Sentry-Plan-Explorer」-來檢視，如下圖，"><a href="#當然如果這樣資訊又太雜的話，那還有一個方式，就是在那個-Deadlock-graph-那列上面按右鍵，選取「擷取事件資料-X-」將它另存成-xdl-檔，然後用-「SQL-Sentry-Plan-Explorer」-來檢視，如下圖，" class="headerlink" title="當然如果這樣資訊又太雜的話，那還有一個方式，就是在那個 Deadlock graph 那列上面按右鍵，選取「擷取事件資料(X)」將它另存成 .xdl 檔，然後用 「SQL Sentry Plan Explorer」 來檢視，如下圖，"></a>當然如果這樣資訊又太雜的話，那還有一個方式，就是在那個 Deadlock graph 那列上面按右鍵，選取「擷取事件資料(X)」將它另存成 .xdl 檔，然後用 「<a href="http://www.sentryone.com/plan-explorer" target="_blank" rel="external">SQL Sentry Plan Explorer</a>」 來檢視，如下圖，</h4><img src="/2017/11/16/2017012/003.png" alt="saveAs XDL file" title="saveAs XDL file">
<img src="/2017/11/16/2017012/004.png" alt="View in [SQL Sentry Plan Explorer]" title="View in [SQL Sentry Plan Explorer]">
<h3 id="案例分享"><a href="#案例分享" class="headerlink" title="案例分享"></a>案例分享</h3><ul>
<li><h4 id="Reader-Writer-Deadlocks"><a href="#Reader-Writer-Deadlocks" class="headerlink" title="Reader-Writer Deadlocks"></a>Reader-Writer Deadlocks</h4><h4 id="當可以看到詳細資料後，就要來開始解析看看是什麼原因造成的，以上面那個例子來說，一個是-update-，另一個是-select-，而-Isolation-Level-是-repeatable-read-。是典型的-Reader-Writer-Deadlocks-，解法如下，"><a href="#當可以看到詳細資料後，就要來開始解析看看是什麼原因造成的，以上面那個例子來說，一個是-update-，另一個是-select-，而-Isolation-Level-是-repeatable-read-。是典型的-Reader-Writer-Deadlocks-，解法如下，" class="headerlink" title="當可以看到詳細資料後，就要來開始解析看看是什麼原因造成的，以上面那個例子來說，一個是 update ，另一個是 select ，而 Isolation Level 是 repeatable read 。是典型的 Reader-Writer Deadlocks ，解法如下，"></a>當可以看到詳細資料後，就要來開始解析看看是什麼原因造成的，以上面那個例子來說，一個是 update ，另一個是 select ，而 Isolation Level 是 repeatable read 。是典型的 Reader-Writer Deadlocks ，解法如下，</h4></li>
</ul>
<ul>
<li>SELECT 語句不要包在交易之中。</li>
<li>檢查 SELECT 語句是否有用到合適的 INDEX (使用 SEEK, 而非 SCAN)，如果已用 SEEK 了，就嘗試下面的解法。</li>
<li>使用 row-version based isolation level，例如 READ COMMITTED SNAPSHOT 或是 SNAPSHOT。</li>
<li>SELECT 語句使用 NOLOCK。</li>
</ul>
<ul>
<li><h4 id="Writer-Writer-Deadlocks"><a href="#Writer-Writer-Deadlocks" class="headerlink" title="Writer-Writer Deadlocks"></a>Writer-Writer Deadlocks</h4><img src="/2017/11/16/2017012/005.png" alt="Writer-Writer Deadlock" title="Writer-Writer Deadlock">
<h4 id="從上圖來看都是針對同一個-Page-想要做-Update-而造成的-Deadlock，另外會有一個比較奇怪的就是「交換事件-exchangeEvent-」，是因為平行處理的原因，可能是沒用到適合的-index，所以才會讓-SQL-使用平行處理。"><a href="#從上圖來看都是針對同一個-Page-想要做-Update-而造成的-Deadlock，另外會有一個比較奇怪的就是「交換事件-exchangeEvent-」，是因為平行處理的原因，可能是沒用到適合的-index，所以才會讓-SQL-使用平行處理。" class="headerlink" title="從上圖來看都是針對同一個 Page 想要做 Update 而造成的 Deadlock，另外會有一個比較奇怪的就是「交換事件(exchangeEvent)」，是因為平行處理的原因，可能是沒用到適合的 index，所以才會讓 SQL 使用平行處理。"></a>從上圖來看都是針對同一個 Page 想要做 Update 而造成的 Deadlock，另外會有一個比較奇怪的就是「交換事件(exchangeEvent)」，是因為平行處理的原因，可能是沒用到適合的 index，所以才會讓 SQL 使用平行處理。</h4></li>
</ul>
<img src="/2017/11/16/2017012/006.png" alt="View in [SQL Sentry Plan Explorer]" title="View in [SQL Sentry Plan Explorer]">
<h4 id="從上圖可以發現，使用相同的-Store-Procedure-，而-Lock-在-Delete-，可以判斷那個-Delete-應該是沒有使用到適合的-index-，所以在-Delete-時，會使用-Scan-的方式去找到要刪除的那一些資料，如下的執行計畫，"><a href="#從上圖可以發現，使用相同的-Store-Procedure-，而-Lock-在-Delete-，可以判斷那個-Delete-應該是沒有使用到適合的-index-，所以在-Delete-時，會使用-Scan-的方式去找到要刪除的那一些資料，如下的執行計畫，" class="headerlink" title="從上圖可以發現，使用相同的 Store Procedure ，而 Lock 在 Delete ，可以判斷那個 Delete 應該是沒有使用到適合的 index ，所以在 Delete 時，會使用 Scan 的方式去找到要刪除的那一些資料，如下的執行計畫，"></a>從上圖可以發現，使用相同的 Store Procedure ，而 Lock 在 Delete ，可以判斷那個 Delete 應該是沒有使用到適合的 index ，所以在 Delete 時，會使用 Scan 的方式去找到要刪除的那一些資料，如下的執行計畫，</h4><img src="/2017/11/16/2017012/007.png" alt="Delete的執行計畫" title="Delete的執行計畫">
<h4 id="可以發現，它是真的是使用-SCAN-的方式。解法如下，"><a href="#可以發現，它是真的是使用-SCAN-的方式。解法如下，" class="headerlink" title="可以發現，它是真的是使用 SCAN 的方式。解法如下，"></a>可以發現，它是真的是使用 SCAN 的方式。解法如下，</h4><ul>
<li>建立適合的 index ，例如，<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> NONCLUSTERED <span class="keyword">INDEX</span> NIDX_SRB_QNTSCORE_DATA_CASEID <span class="keyword">ON</span> dbo.SRB_QNTSCORE_DATA(CASEID);</div></pre></td></tr></table></figure>
</li>
</ul>
<img src="/2017/11/16/2017012/008.png" alt="建立過index的執行計畫" title="建立過index的執行計畫">
<h3 id="其他解決方式"><a href="#其他解決方式" class="headerlink" title="其他解決方式"></a>其他解決方式</h3><h4 id="除了上述的-Case-的解法外，有其他的解法，"><a href="#除了上述的-Case-的解法外，有其他的解法，" class="headerlink" title="除了上述的 Case 的解法外，有其他的解法，"></a>除了上述的 Case 的解法外，有其他的解法，</h4><ul>
<li>更新資料表的順序<br>  針對 Tables 修改的順序也是要注意，例如 sp1 是更新 tblA 及 tblB ，另一個 sp2 則是先更新 tblB 再更新 tblA ，這樣子的順序交叉，就很容易造成 Deadlock。 所以在 更新的順序上也是要考量到哦!</li>
<li>Create Indexes with Included Columns<br>  有一些 Key Lookup deadlock 就是因為在 Update 某 Table 時，除了更新了 Clustered Index 後，還需要再更新 Non Clustered Index，而另一個 Select 除了透過 Non Clustered Index 找到資料後，還需要到 Lookup 到 Clustered Index 取得資料。這樣子就有可能會互相 Lock 到而造成 Deadlock，這種狀況可以加入 Included Columns 來解決。</li>
<li>MAXDOP<br>  有些光 SELECT 時，就會發生 Deadlock ，是因為平行處理造成的，解法就是調整 SQL 。如果還會有 Deadlock 的話，就設定 MAXDOP 看看能不能解決。</li>
</ul>
<h3 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h3><h4 id="SQL-Server-Deadlocks-by-Example"><a href="#SQL-Server-Deadlocks-by-Example" class="headerlink" title="SQL Server Deadlocks by Example"></a><a href="https://www.red-gate.com/simple-talk/sql/performance/sql-server-deadlocks-by-example/" target="_blank" rel="external">SQL Server Deadlocks by Example</a></h4>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/11/16/2017012/" data-id="cja22rtk20001109j6bdr39wq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/deadlock/">deadlock</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exchangeEvent/">exchangeEvent</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/交換事件/">交換事件</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017011" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/09/2017011/" class="article-date">
  <time datetime="2017-11-09T05:31:28.000Z" itemprop="datePublished">2017-11-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/09/2017011/">Aspose.Words DocumentBuilder 加入 htmlTable 轉成 PDF 檔問題</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="最近同事透過-Aspose-Words-DocumentBuilder-的-InsertHtml-Method-加入-Html-的-Table-含-css-，另存成-PDF-檔後，居然發現本來在-Word-檔中看起來好好的，PDF檔中的-Table-卻會超過頁面，如下，"><a href="#最近同事透過-Aspose-Words-DocumentBuilder-的-InsertHtml-Method-加入-Html-的-Table-含-css-，另存成-PDF-檔後，居然發現本來在-Word-檔中看起來好好的，PDF檔中的-Table-卻會超過頁面，如下，" class="headerlink" title="最近同事透過 Aspose.Words DocumentBuilder 的 InsertHtml Method 加入 Html 的 Table (含 css )，另存成 PDF 檔後，居然發現本來在 Word 檔中看起來好好的，PDF檔中的 Table 卻會超過頁面，如下，"></a>最近同事透過 Aspose.Words DocumentBuilder 的 InsertHtml Method 加入 Html 的 Table (含 css )，另存成 PDF 檔後，居然發現本來在 Word 檔中看起來好好的，PDF檔中的 Table 卻會超過頁面，如下，</h3><img src="/2017/11/09/2017011/exceedPage.png" alt="exceedPage.png" title="">
<h3 id="測試程式如下，"><a href="#測試程式如下，" class="headerlink" title="測試程式如下，"></a>測試程式如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> htmlTable = <span class="string">@"&lt;style&gt;</span></div><div class="line"><span class="string">.table &#123;</span></div><div class="line"><span class="string">	width: auto; </span></div><div class="line"><span class="string">	table-layout:fixed;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">.table, .table tr &#123;</span></div><div class="line"><span class="string">	height: 40px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">.table, .table td &#123;</span></div><div class="line"><span class="string">	border-collapse: collapse;</span></div><div class="line"><span class="string">	border: 1px solid #000000;</span></div><div class="line"><span class="string">	padding:2px 5px 2px 5px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">&lt;/style&gt;</span></div><div class="line"><span class="string">&lt;table class='table' style='width: 100%;'&gt;</span></div><div class="line"><span class="string">&lt;colgroup&gt;</span></div><div class="line"><span class="string">	&lt;col style='width: 15%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width: 35%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width: 15%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width: 35%;'&gt;</span></div><div class="line"><span class="string">&lt;/colgroup&gt;</span></div><div class="line"><span class="string">&lt;tbody&gt;</span></div><div class="line"><span class="string">	&lt;tr&gt;</span></div><div class="line"><span class="string">		&lt;td&gt;TITLE1：&lt;/td&gt;</span></div><div class="line"><span class="string">		&lt;td&gt;&lt;/td&gt;</span></div><div class="line"><span class="string">		&lt;td&gt;TITLE2：&lt;/td&gt;</span></div><div class="line"><span class="string">		&lt;td&gt;106/10/14 22:26&lt;/td&gt;</span></div><div class="line"><span class="string">	&lt;/tr&gt;</span></div><div class="line"><span class="string">	&lt;tr&gt;</span></div><div class="line"><span class="string">		&lt;td&gt;TITLE3：&lt;/td&gt;</span></div><div class="line"><span class="string">		&lt;td colspan='3'&gt;測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試&lt;/td&gt;</span></div><div class="line"><span class="string">	&lt;/tr&gt;</span></div><div class="line"><span class="string">&lt;/tbody&gt;</span></div><div class="line"><span class="string">&lt;/table&gt;"</span>;</div><div class="line"><span class="keyword">var</span> doc = <span class="keyword">new</span> Document();</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameFarEast = <span class="string">"標楷體"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameAscii = <span class="string">"Times New Roman"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.Size = <span class="number">16</span>D;</div><div class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> DocumentBuilder(doc);</div><div class="line">builder.InsertHtml(htmlTable, <span class="literal">true</span>);</div><div class="line">doc.Save(<span class="string">"TEST.doc"</span>, SaveFormat.Doc);</div><div class="line">doc.Save(<span class="string">"TEST.pdf"</span>, SaveFormat.Pdf);</div></pre></td></tr></table></figure>
<h3 id="原廠的回覆設定-CompatibilityOptions-GrowAutofit-選項為-false-就可以了，如下，"><a href="#原廠的回覆設定-CompatibilityOptions-GrowAutofit-選項為-false-就可以了，如下，" class="headerlink" title="原廠的回覆設定 CompatibilityOptions.GrowAutofit 選項為 false 就可以了，如下，"></a>原廠的回覆設定 CompatibilityOptions.GrowAutofit 選項為 false 就可以了，如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> doc = <span class="keyword">new</span> Document();</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameFarEast = <span class="string">"標楷體"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameAscii = <span class="string">"Times New Roman"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.Size = <span class="number">16</span>D;</div><div class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> DocumentBuilder(doc);</div><div class="line">builder.InsertHtml(htmlTable, <span class="literal">true</span>);</div><div class="line">doc.Save(<span class="string">"TEST.doc"</span>, SaveFormat.Doc);</div><div class="line">doc.CompatibilityOptions.GrowAutofit = <span class="literal">false</span>;</div><div class="line">doc.Save(<span class="string">"TEST.pdf"</span>, SaveFormat.Pdf);</div></pre></td></tr></table></figure>
<h3 id="果然設定-Document-的-CompatibilityOptions-GrowAutofit-為-false-，-PDF-中的-table-就不會超過頁面了，詳細可以參考DocumentBuilder-InsertHtml-Save-as-pdf-will-exceed-page。"><a href="#果然設定-Document-的-CompatibilityOptions-GrowAutofit-為-false-，-PDF-中的-table-就不會超過頁面了，詳細可以參考DocumentBuilder-InsertHtml-Save-as-pdf-will-exceed-page。" class="headerlink" title="果然設定 Document 的 CompatibilityOptions.GrowAutofit 為 false ， PDF 中的 table 就不會超過頁面了，詳細可以參考DocumentBuilder InsertHtml Save as pdf will exceed page。"></a>果然設定 Document 的 CompatibilityOptions.GrowAutofit 為 false ， PDF 中的 table 就不會超過頁面了，詳細可以參考<a href="https://forum.aspose.com/t/documentbuilder-inserthtml-save-as-pdf-will-exceed-page/165825" target="_blank" rel="external">DocumentBuilder InsertHtml Save as pdf will exceed page</a>。</h3><h3 id="後來同事用巢狀的-html-table-去試，這次變成不同TD的內容會疉在一起，如下，"><a href="#後來同事用巢狀的-html-table-去試，這次變成不同TD的內容會疉在一起，如下，" class="headerlink" title="後來同事用巢狀的 html table 去試，這次變成不同TD的內容會疉在一起，如下，"></a>後來同事用巢狀的 html table 去試，這次變成不同TD的內容會疉在一起，如下，</h3><img src="/2017/11/09/2017011/002.png" alt="002.png" title="">
<h3 id="測試的-html-table-如下，"><a href="#測試的-html-table-如下，" class="headerlink" title="測試的 html table 如下，"></a>測試的 html table 如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> htmlTable2 = <span class="string">@"&lt;style&gt;</span></div><div class="line"><span class="string">div[data-speed-id=seal-box] &#123;</span></div><div class="line"><span class="string">	margin-top: 20px;</span></div><div class="line"><span class="string">	margin-left: 0px;</span></div><div class="line"><span class="string">	margin-right: 0px;</span></div><div class="line"><span class="string">	margin-bottom: 0px;</span></div><div class="line"><span class="string">	height: 20px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">td[data-speed-sealouid] &#123;</span></div><div class="line"><span class="string">	width: 60px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id='seal-table'] &#123;</span></div><div class="line"><span class="string">	border: 1px solid red !important;</span></div><div class="line"><span class="string">	color: red !important;</span></div><div class="line"><span class="string">	border-collapse: initial;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id=seal-table] td &#123;</span></div><div class="line"><span class="string">	padding: 0px !important;</span></div><div class="line"><span class="string">	margin: 0px !important;</span></div><div class="line"><span class="string">	border: 0px;</span></div><div class="line"><span class="string">	border-collapse: collapse;</span></div><div class="line"><span class="string">	border-spacing: 0px !important;</span></div><div class="line"><span class="string">	vertical-align: middle !important;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">&lt;/style&gt;</span></div><div class="line"><span class="string">&lt;div style='color: blue;'&gt;下面是原本職章結構直接輸出，&lt;/div&gt;</span></div><div class="line"><span class="string">&lt;table&gt;</span></div><div class="line"><span class="string">&lt;colgroup&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:35%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:65%;'&gt;</span></div><div class="line"><span class="string">&lt;/colgroup&gt;</span></div><div class="line"><span class="string">&lt;tbody&gt;</span></div><div class="line"><span class="string">&lt;tr&gt;</span></div><div class="line"><span class="string">	&lt;td&gt;</span></div><div class="line"><span class="string">		&lt;div style='margin-top: 10px;' data-speed-id='seal-box'&gt;</span></div><div class="line"><span class="string">			&lt;table&gt;</span></div><div class="line"><span class="string">				&lt;tbody&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td&gt;</span></div><div class="line"><span class="string">						&lt;table data-speed-id='seal-table'&gt;</span></div><div class="line"><span class="string">							&lt;tbody&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;' data-speed-sealouid='10110'&gt;文化資源司&lt;/td&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 16px;' rowspan='2'&gt;亂馬客&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;'&gt;科員&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;/tbody&gt;</span></div><div class="line"><span class="string">						&lt;/table&gt;</span></div><div class="line"><span class="string">					&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td style='text-align: center; font-size: 12px;'&gt;106/10/18 10:36&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;/tbody&gt;</span></div><div class="line"><span class="string">			&lt;/table&gt;</span></div><div class="line"><span class="string">		&lt;/div&gt;</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">	&lt;td style='padding-left: 70px;'&gt;</span></div><div class="line"><span class="string">		案係亂馬客測試文化局將於本(105)年10月29日召開「106亂馬客測試社區營造平台工作小組第九十次會議」，本部為列席單位，擬視業務狀況再行派員，當否?請核示。文陳閱後存查。</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">&lt;/tr&gt;</span></div><div class="line"><span class="string">&lt;/tbody&gt;</span></div><div class="line"><span class="string">&lt;/table&gt;"</span>;</div></pre></td></tr></table></figure>
<h3 id="原廠建議可以改-TD-的-LeftPadding-來解這問題，詳細可以參考DocumentBuilder-InsertHtml-nested-table-Save-as-pdf-some-TD-will-disapper，不要使用-UpdateTableLayout-哦"><a href="#原廠建議可以改-TD-的-LeftPadding-來解這問題，詳細可以參考DocumentBuilder-InsertHtml-nested-table-Save-as-pdf-some-TD-will-disapper，不要使用-UpdateTableLayout-哦" class="headerlink" title="原廠建議可以改 TD 的 LeftPadding 來解這問題，詳細可以參考DocumentBuilder InsertHtml (nested table) Save as pdf , some TD will disapper，不要使用 UpdateTableLayout 哦!"></a>原廠建議可以改 TD 的 LeftPadding 來解這問題，詳細可以參考<a href="https://forum.aspose.com/t/documentbuilder-inserthtml-nested-table-save-as-pdf-some-td-will-disapper/166107" target="_blank" rel="external">DocumentBuilder InsertHtml (nested table) Save as pdf , some TD will disapper</a>，不要使用 UpdateTableLayout 哦!</h3><h3 id="所以我在-TD-中加入-style-’padding-left-70px-’-來看，右邊的-TD-內容果然往右移了，但左邊的那個職章-Table-卻還是小小的，如下，"><a href="#所以我在-TD-中加入-style-’padding-left-70px-’-來看，右邊的-TD-內容果然往右移了，但左邊的那個職章-Table-卻還是小小的，如下，" class="headerlink" title="所以我在 TD 中加入 style=’padding-left: 70px;’ 來看，右邊的 TD 內容果然往右移了，但左邊的那個職章 Table 卻還是小小的，如下，"></a>所以我在 TD 中加入 style=’padding-left: 70px;’ 來看，右邊的 TD 內容果然往右移了，但左邊的那個職章 Table 卻還是小小的，如下，</h3><img src="/2017/11/09/2017011/003.png" alt="003.png" title="">
<h3 id="測試的-Html-如下，"><a href="#測試的-Html-如下，" class="headerlink" title="測試的 Html 如下，"></a>測試的 Html 如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> htmlTable3 = <span class="string">@"&lt;style&gt;</span></div><div class="line"><span class="string">div[data-speed-id=seal-box] &#123;</span></div><div class="line"><span class="string">	margin-top: 20px;</span></div><div class="line"><span class="string">	margin-left: 0px;</span></div><div class="line"><span class="string">	margin-right: 0px;</span></div><div class="line"><span class="string">	margin-bottom: 0px;</span></div><div class="line"><span class="string">	height: 20px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">td[data-speed-sealouid] &#123;</span></div><div class="line"><span class="string">	width: 60px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id='seal-table'] &#123;</span></div><div class="line"><span class="string">	border: 1px solid red !important;</span></div><div class="line"><span class="string">	color: red !important;</span></div><div class="line"><span class="string">	border-collapse: initial;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id=seal-table] td &#123;</span></div><div class="line"><span class="string">	padding: 0px !important;</span></div><div class="line"><span class="string">	margin: 0px !important;</span></div><div class="line"><span class="string">	border: 0px;</span></div><div class="line"><span class="string">	border-collapse: collapse;</span></div><div class="line"><span class="string">	border-spacing: 0px !important;</span></div><div class="line"><span class="string">	vertical-align: middle !important;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">&lt;/style&gt;</span></div><div class="line"><span class="string">&lt;div style='color: blue;'&gt;下面是原本職章結構直接輸出，&lt;/div&gt;</span></div><div class="line"><span class="string">&lt;table&gt;</span></div><div class="line"><span class="string">&lt;colgroup&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:35%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:65%;'&gt;</span></div><div class="line"><span class="string">&lt;/colgroup&gt;</span></div><div class="line"><span class="string">&lt;tbody&gt;</span></div><div class="line"><span class="string">&lt;tr&gt;</span></div><div class="line"><span class="string">	&lt;td&gt;</span></div><div class="line"><span class="string">		&lt;div style='margin-top: 10px;' data-speed-id='seal-box'&gt;</span></div><div class="line"><span class="string">			&lt;table&gt;</span></div><div class="line"><span class="string">				&lt;tbody&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td&gt;</span></div><div class="line"><span class="string">						&lt;table data-speed-id='seal-table'&gt;</span></div><div class="line"><span class="string">							&lt;tbody&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;' data-speed-sealouid='10110'&gt;文化資源司&lt;/td&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 16px;' rowspan='2'&gt;亂馬客&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;'&gt;科員&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;/tbody&gt;</span></div><div class="line"><span class="string">						&lt;/table&gt;</span></div><div class="line"><span class="string">					&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td style='text-align: center; font-size: 12px;'&gt;106/10/18 10:36&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;/tbody&gt;</span></div><div class="line"><span class="string">			&lt;/table&gt;</span></div><div class="line"><span class="string">		&lt;/div&gt;</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">	&lt;td style='padding-left: 70px;'&gt;</span></div><div class="line"><span class="string">		案係亂馬客測試文化局將於本(105)年10月29日召開「106亂馬客測試社區營造平台工作小組第九十次會議」，本部為列席單位，擬視業務狀況再行派員，當否?請核示。文陳閱後存查。</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">&lt;/tr&gt;</span></div><div class="line"><span class="string">&lt;/tbody&gt;</span></div><div class="line"><span class="string">&lt;/table&gt;"</span>;</div></pre></td></tr></table></figure>
<h3 id="那只好在職章的那個-Table-中設定固定的寬度，最後PDF的結果如下，"><a href="#那只好在職章的那個-Table-中設定固定的寬度，最後PDF的結果如下，" class="headerlink" title="那只好在職章的那個 Table 中設定固定的寬度，最後PDF的結果如下，"></a>那只好在職章的那個 Table 中設定固定的寬度，最後PDF的結果如下，</h3><img src="/2017/11/09/2017011/004.png" alt="004.png" title="">
<h3 id="最後的測試程式如下，"><a href="#最後的測試程式如下，" class="headerlink" title="最後的測試程式如下，"></a>最後的測試程式如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> htmlTable4 = <span class="string">@"&lt;style&gt;</span></div><div class="line"><span class="string">div[data-speed-id=seal-box] &#123;</span></div><div class="line"><span class="string">	margin-top: 20px;</span></div><div class="line"><span class="string">	margin-left: 0px;</span></div><div class="line"><span class="string">	margin-right: 0px;</span></div><div class="line"><span class="string">	margin-bottom: 0px;</span></div><div class="line"><span class="string">	height: 20px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">td[data-speed-sealouid] &#123;</span></div><div class="line"><span class="string">	width: 60px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id='seal-table'] &#123;</span></div><div class="line"><span class="string">	border: 1px solid red !important;</span></div><div class="line"><span class="string">	color: red !important;</span></div><div class="line"><span class="string">	border-collapse: initial;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id=seal-table] td &#123;</span></div><div class="line"><span class="string">	padding: 0px !important;</span></div><div class="line"><span class="string">	margin: 0px !important;</span></div><div class="line"><span class="string">	border: 0px;</span></div><div class="line"><span class="string">	border-collapse: collapse;</span></div><div class="line"><span class="string">	border-spacing: 0px !important;</span></div><div class="line"><span class="string">	vertical-align: middle !important;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">&lt;/style&gt;</span></div><div class="line"><span class="string">&lt;div style='color: blue;'&gt;下面是原本職章結構直接輸出，&lt;/div&gt;</span></div><div class="line"><span class="string">&lt;table&gt;</span></div><div class="line"><span class="string">&lt;colgroup&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:35%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:65%;'&gt;</span></div><div class="line"><span class="string">&lt;/colgroup&gt;</span></div><div class="line"><span class="string">&lt;tbody&gt;</span></div><div class="line"><span class="string">&lt;tr&gt;</span></div><div class="line"><span class="string">	&lt;td&gt;</span></div><div class="line"><span class="string">		&lt;div style='margin-top: 10px;' data-speed-id='seal-box'&gt;</span></div><div class="line"><span class="string">			&lt;table width='120px'&gt;</span></div><div class="line"><span class="string">				&lt;tbody&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td&gt;</span></div><div class="line"><span class="string">						&lt;table data-speed-id='seal-table' &gt;</span></div><div class="line"><span class="string">							&lt;tbody&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;' data-speed-sealouid='10110'&gt;文化資源司&lt;/td&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 16px;' rowspan='2'&gt;亂馬客&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;'&gt;科員&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;/tbody&gt;</span></div><div class="line"><span class="string">						&lt;/table&gt;</span></div><div class="line"><span class="string">					&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td style='text-align: center; font-size: 12px;'&gt;106/10/18 10:36&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;/tbody&gt;</span></div><div class="line"><span class="string">			&lt;/table&gt;</span></div><div class="line"><span class="string">		&lt;/div&gt;</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">	&lt;td style='padding-left: 90px;'&gt;</span></div><div class="line"><span class="string">		案係亂馬客測試文化局將於本(105)年10月29日召開「106亂馬客測試社區營造平台工作小組第九十次會議」，本部為列席單位，擬視業務狀況再行派員，當否?請核示。文陳閱後存查。</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">&lt;/tr&gt;</span></div><div class="line"><span class="string">&lt;/tbody&gt;</span></div><div class="line"><span class="string">&lt;/table&gt;"</span>;</div><div class="line"><span class="keyword">var</span> doc = <span class="keyword">new</span> Document();</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameFarEast = <span class="string">"標楷體"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameAscii = <span class="string">"Times New Roman"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.Size = <span class="number">16</span>D;</div><div class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> DocumentBuilder(doc);</div><div class="line">builder.InsertHtml(htmlTable4, <span class="literal">true</span>);</div><div class="line">doc.CompatibilityOptions.GrowAutofit = <span class="literal">false</span>;</div><div class="line">doc.Save(<span class="string">"TEST.pdf"</span>, SaveFormat.Pdf);</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/11/09/2017011/" data-id="cja22rtk70003109jmey0gc4f" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Aspose-Words/">Aspose.Words</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CompatibilityOptions/">CompatibilityOptions</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DocumentBuilder/">DocumentBuilder</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GrowAutofit/">GrowAutofit</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/InsertHtml/">InsertHtml</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PDF/">PDF</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017010" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/27/2017010/" class="article-date">
  <time datetime="2017-10-27T05:28:10.000Z" itemprop="datePublished">2017-10-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/27/2017010/">log4net 檔名使用「大寫」字母造成檔案被覆寫問題</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="事情是這樣子的…我們有個專案裡面有使用-log4net-v-1-2-11-0-，在案子裡面是使用-RollingFileAppender-，-rollingStyle-是-Composite-，依日期時間及檔案大小來切檔，設定檔如下，"><a href="#事情是這樣子的…我們有個專案裡面有使用-log4net-v-1-2-11-0-，在案子裡面是使用-RollingFileAppender-，-rollingStyle-是-Composite-，依日期時間及檔案大小來切檔，設定檔如下，" class="headerlink" title="事情是這樣子的…我們有個專案裡面有使用 log4net v 1.2.11.0 ，在案子裡面是使用 RollingFileAppender ， rollingStyle 是 Composite ，依日期時間及檔案大小來切檔，設定檔如下，"></a>事情是這樣子的…我們有個專案裡面有使用 log4net v 1.2.11.0 ，在案子裡面是使用 RollingFileAppender ， rollingStyle 是 Composite ，依日期時間及檔案大小來切檔，設定檔如下，</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line">&lt;log4net debug=&quot;true&quot;&gt;</div><div class="line">	&lt;appender name=&quot;DBRollingFileAppender&quot; type=&quot;log4net.Appender.RollingFileAppender&quot;&gt;</div><div class="line">	  &lt;file type=&quot;log4net.Util.PatternString&quot; value=&quot;[你的路徑]\temp\%date&#123;yyyy&#125;\%date&#123;MM&#125;\%date&#123;dd&#125;\&quot; /&gt;</div><div class="line">	  &lt;staticLogFileName value=&quot;false&quot;/&gt;</div><div class="line">	  &lt;appendToFile value=&quot;true&quot;/&gt;</div><div class="line">	  &lt;!--設定檔案分割依據Date和Size--&gt;</div><div class="line">	  &lt;rollingStyle value=&quot;Composite&quot;/&gt;</div><div class="line">	  &lt;!--設定每個檔案的大小--&gt;</div><div class="line">	  &lt;MaximumFileSize value=&quot;250KB&quot; /&gt;</div><div class="line">	  &lt;!--設定分割檔案的最大數量--&gt;</div><div class="line">	  &lt;maxSizeRollBackups value=&quot;2000&quot; /&gt;</div><div class="line">	  &lt;CountDirection value=&quot;1&quot; /&gt;</div><div class="line">	  &lt;!--log檔案的命名--&gt;</div><div class="line">	  &lt;datePattern value=&quot;yyyy-MM-dd-HH-DB2.lo\g&quot;/&gt;</div><div class="line">	  &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;</div><div class="line">		&lt;conversionPattern value=&quot;[%date] [%-5level] From %logger%newline  %file:%line [%property&#123;NDC&#125;]%newline  %message%newline%newline&quot; /&gt;</div><div class="line">	  &lt;/layout&gt;</div><div class="line">	  &lt;filter type=&quot;log4net.Filter.LevelRangeFilter&quot;&gt;</div><div class="line">		&lt;param name=&quot;LevelMin&quot; value=&quot;INFO&quot;/&gt;</div><div class="line">		&lt;param name=&quot;LevelMax&quot; value=&quot;INFO&quot;/&gt;</div><div class="line">	  &lt;/filter&gt;</div><div class="line">	&lt;/appender&gt;</div><div class="line">	&lt;appender name=&quot;SystemRollingFileAppender&quot; type=&quot;log4net.Appender.RollingFileAppender&quot;&gt;</div><div class="line">	  &lt;!--存放log檔案的路徑(%property&#123;LogPath&#125;屬性請勿任意修改)--&gt;</div><div class="line">	  &lt;file type=&quot;log4net.Util.PatternString&quot; value=&quot;[你的路徑]\temp\%date&#123;yyyy&#125;\%date&#123;MM&#125;\%date&#123;dd&#125;\&quot; /&gt;</div><div class="line">	  &lt;staticLogFileName value=&quot;false&quot;/&gt;</div><div class="line">	  &lt;appendToFile value=&quot;true&quot;/&gt;</div><div class="line">	  &lt;!--設定檔案分割依據Date和Size--&gt;</div><div class="line">	  &lt;rollingStyle value=&quot;Composite&quot;/&gt;</div><div class="line">	  &lt;!--設定每個檔案的大小--&gt;</div><div class="line">	  &lt;MaximumFileSize value=&quot;20KB&quot; /&gt;</div><div class="line">	  &lt;!--設定分割檔案的最大數量--&gt;</div><div class="line">	  &lt;maxSizeRollBackups value=&quot;2000&quot; /&gt;</div><div class="line">	  &lt;lockingModel type=&quot;log4net.Appender.FileAppender+MinimalLock&quot; /&gt;</div><div class="line">	  &lt;CountDirection value=&quot;1&quot; /&gt;</div><div class="line">	  &lt;!--log檔案的命名--&gt;</div><div class="line">	  &lt;datePattern value=&quot;yyyy-MM-dd-HH-DB.lo\g&quot;/&gt;</div><div class="line">	  &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;</div><div class="line">		&lt;conversionPattern value=&quot;%d&#123;yyyy-MM-dd HH:mm&#125; %level %logger %ndc - %message%newline&quot; /&gt;</div><div class="line">	  &lt;/layout&gt;</div><div class="line">	  &lt;filter type=&quot;log4net.Filter.LevelRangeFilter&quot;&gt;</div><div class="line">		&lt;param name=&quot;LevelMin&quot; value=&quot;DEBUG&quot;/&gt;</div><div class="line">		&lt;param name=&quot;LevelMax&quot; value=&quot;DEBUG&quot;/&gt;</div><div class="line">	  &lt;/filter&gt;</div><div class="line">	&lt;/appender&gt;</div><div class="line">	&lt;!--紀錄錯誤訊息--&gt;</div><div class="line">	&lt;appender name=&quot;ErrorRollingFileAppender&quot; type=&quot;log4net.Appender.RollingFileAppender&quot;&gt;</div><div class="line">	  &lt;!--存放log檔案的路徑--&gt;</div><div class="line">	  &lt;file type=&quot;log4net.Util.PatternString&quot; value=&quot;[你的路徑]\temp\%date&#123;yyyy&#125;\%date&#123;MM&#125;\%date&#123;dd&#125;\&quot; /&gt;</div><div class="line">	  &lt;staticLogFileName value=&quot;false&quot;/&gt;</div><div class="line">	  &lt;appendToFile value=&quot;true&quot;/&gt;</div><div class="line">	  &lt;!--設定檔案分割依據Date和Size--&gt;</div><div class="line">	  &lt;rollingStyle value=&quot;Composite&quot;/&gt;</div><div class="line">	  &lt;!--設定每個檔案的大小--&gt;</div><div class="line">	  &lt;MaximumFileSize value=&quot;250KB&quot; /&gt;</div><div class="line">	  &lt;!--設定分割檔案的最大數量--&gt;</div><div class="line">	  &lt;maxSizeRollBackups value=&quot;2000&quot; /&gt;</div><div class="line">	  &lt;!--log檔案的命名--&gt;</div><div class="line">	  &lt;datePattern value=&quot;yyyy-MM-dd-HH-DB3.lo\g&quot;/&gt;</div><div class="line">	  &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;</div><div class="line">		&lt;conversionPattern value=&quot;[%date] [%-5level] From %logger%newline  %file:%line [%property&#123;NDC&#125;]%newline  %message%newline%newline&quot; /&gt;</div><div class="line">	  &lt;/layout&gt;</div><div class="line">	  &lt;filter type=&quot;log4net.Filter.LevelRangeFilter&quot;&gt;</div><div class="line">		&lt;param name=&quot;LevelMin&quot; value=&quot;WARN&quot;/&gt;</div><div class="line">	  &lt;/filter&gt;</div><div class="line">	&lt;/appender&gt;</div><div class="line">	&lt;root&gt;</div><div class="line">	  &lt;level value=&quot;ALL&quot;/&gt;</div><div class="line">	  &lt;appender-ref ref=&quot;DBRollingFileAppender&quot;/&gt;</div><div class="line">	  &lt;appender-ref ref=&quot;SystemRollingFileAppender&quot;/&gt;</div><div class="line">	  &lt;appender-ref ref=&quot;ErrorRollingFileAppender&quot;/&gt;</div><div class="line">	&lt;/root&gt;</div><div class="line">&lt;/log4net&gt;</div></pre></td></tr></table></figure>
<h3 id="這樣子的設定-log4net-會在-temp-目錄再依-年、月、日-建立目錄，然後產生-0-1-…的檔案如下圖，"><a href="#這樣子的設定-log4net-會在-temp-目錄再依-年、月、日-建立目錄，然後產生-0-1-…的檔案如下圖，" class="headerlink" title="這樣子的設定 log4net 會在 temp 目錄再依 年、月、日 建立目錄，然後產生 .0, .1 …的檔案如下圖，"></a>這樣子的設定 log4net 會在 temp 目錄再依 年、月、日 建立目錄，然後產生 .0, .1 …的檔案如下圖，</h3><img src="/2017/10/27/2017010/001.png" alt="001.png" title="">
<h3 id="這樣子的-log-在測試機都正常運作，唯獨在正式機卻會發生第1個檔案-0-的-log-檔有正常產生，但-1-的檔案卻一直被重覆的寫，導致要看-log-都常常看不到-SystemRollingFileAppender-。雖然-maxSizeRollBackups-設定了-2000-，但使終都只有-2-個檔案。-在我的-Local-測試也都沒什麼問題，用測試程式看它的-m-curSizeRollBackups-屬性也都正常，如下，"><a href="#這樣子的-log-在測試機都正常運作，唯獨在正式機卻會發生第1個檔案-0-的-log-檔有正常產生，但-1-的檔案卻一直被重覆的寫，導致要看-log-都常常看不到-SystemRollingFileAppender-。雖然-maxSizeRollBackups-設定了-2000-，但使終都只有-2-個檔案。-在我的-Local-測試也都沒什麼問題，用測試程式看它的-m-curSizeRollBackups-屬性也都正常，如下，" class="headerlink" title="這樣子的 log 在測試機都正常運作，唯獨在正式機卻會發生第1個檔案 .0 的 log 檔有正常產生，但 .1 的檔案卻一直被重覆的寫，導致要看 log 都常常看不到 (SystemRollingFileAppender)。雖然 maxSizeRollBackups 設定了 2000 ，但使終都只有 2 個檔案。 在我的 Local 測試也都沒什麼問題，用測試程式看它的 m_curSizeRollBackups 屬性也都正常，如下，"></a>這樣子的 log 在測試機都正常運作，唯獨在正式機卻會發生第1個檔案 .0 的 log 檔有正常產生，但 .1 的檔案卻一直被重覆的寫，導致要看 log 都常常看不到 (SystemRollingFileAppender)。雖然 maxSizeRollBackups 設定了 2000 ，但使終都只有 2 個檔案。 在我的 Local 測試也都沒什麼問題，用測試程式看它的 m_curSizeRollBackups 屬性也都正常，如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 如果不是透過 class access ，記得要在 Application_Start 呼叫 log4net.Config.XmlConfigurator.Configure(); 哦!</span></div><div class="line"><span class="keyword">var</span> logType = System.Reflection.MethodBase.GetCurrentMethod().DeclaringType;</div><div class="line"><span class="comment">//Assembly assem = logType.Assembly;</span></div><div class="line"><span class="keyword">var</span> logger = LogManager.GetLogger(logType);</div><div class="line"><span class="keyword">var</span> appenders = logger.Logger.Repository.GetAppenders();</div><div class="line"><span class="keyword">var</span> rollingAppenders = appenders.OfType&lt;RollingFileAppender&gt;();</div><div class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> appender <span class="keyword">in</span> rollingAppenders)</div><div class="line">&#123;</div><div class="line">	Response.Write(<span class="string">$"&lt;h3&gt;*** Name:<span class="subst">&#123;appender.Name&#125;</span> *** &lt;/h3&gt;"</span>);</div><div class="line">	Response.Write(<span class="string">$"File : <span class="subst">&#123;appender.File&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">	Response.Write(<span class="string">$"CountDirection : <span class="subst">&#123;appender.CountDirection&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">	Response.Write(<span class="string">$"MaxSizeRollBackups : <span class="subst">&#123;appender.MaxSizeRollBackups&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">	Response.Write(<span class="string">$"MaxFileSize : <span class="subst">&#123;appender.MaxFileSize&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">	Response.Write(<span class="string">$"StaticLogFileName : <span class="subst">&#123;appender.StaticLogFileName&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">	<span class="keyword">var</span> propInfo = appender.GetType().BaseType.BaseType</div><div class="line">		.GetProperty(<span class="string">"QuietWriter"</span>, BindingFlags.NonPublic | BindingFlags.Instance);</div><div class="line"></div><div class="line">	<span class="keyword">var</span> quiteWriter = propInfo?.GetValue(appender) <span class="keyword">as</span> CountingQuietTextWriter;</div><div class="line">	Response.Write(<span class="string">$"FileSize : <span class="subst">&#123;quiteWriter?.Count&#125;</span>&lt;br/&gt;"</span>);</div><div class="line"></div><div class="line">	<span class="keyword">var</span> scheduleFieldInfo = appender.GetType().GetField(<span class="string">"m_scheduledFilename"</span>, BindingFlags.NonPublic | BindingFlags.Instance);</div><div class="line">	<span class="keyword">var</span> scheduleField = scheduleFieldInfo.GetValue(appender) ;</div><div class="line">	Response.Write(<span class="string">$"m_scheduledFilename : <span class="subst">&#123;scheduleField&#125;</span>&lt;br/&gt;"</span>);</div><div class="line"></div><div class="line">	<span class="keyword">var</span> m_curSizeRollBackupsFieldInfo = appender.GetType().GetField(<span class="string">"m_curSizeRollBackups"</span>, BindingFlags.NonPublic | BindingFlags.Instance);</div><div class="line">	<span class="keyword">var</span> m_curSizeRollBackupsField = m_curSizeRollBackupsFieldInfo.GetValue(appender);</div><div class="line">	Response.Write(<span class="string">$"m_curSizeRollBackups : <span class="subst">&#123;m_curSizeRollBackupsField&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="如下，-log4net-寫到了-2017-10-27-14-DB-log-6-這個檔案，"><a href="#如下，-log4net-寫到了-2017-10-27-14-DB-log-6-這個檔案，" class="headerlink" title="如下， log4net 寫到了 2017-10-27-14-DB.log.6 這個檔案，"></a>如下， log4net 寫到了 2017-10-27-14-DB.log.6 這個檔案，</h3><img src="/2017/10/27/2017010/002.png" alt="002.png" title="">
<h3 id="後來我將-IIS-Express-的站台關掉再重新執行，結果-m-curSizeRollBackups-的值居然變成了-0-。如下，"><a href="#後來我將-IIS-Express-的站台關掉再重新執行，結果-m-curSizeRollBackups-的值居然變成了-0-。如下，" class="headerlink" title="後來我將 IIS Express 的站台關掉再重新執行，結果 m_curSizeRollBackups 的值居然變成了 0 。如下，"></a>後來我將 IIS Express 的站台關掉再重新執行，結果 m_curSizeRollBackups 的值居然變成了 0 。如下，</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">*** Name:SystemRollingFileAppender ***</div><div class="line"></div><div class="line">File : C:\Users\rainm\Documents\Visual Studio 2017\Projects\log4netTest\log4netTest\temp\2017\10\27\2017-10-27-14-DB.log.0</div><div class="line">CountDirection : 1</div><div class="line">MaxSizeRollBackups : 2000</div><div class="line">MaxFileSize : 20480</div><div class="line">StaticLogFileName : False</div><div class="line">FileSize : 20540</div><div class="line">m_scheduledFilename : C:\Users\rainm\Documents\Visual Studio 2017\Projects\log4netTest\log4netTest\temp\2017\10\27\2017-10-27-14-DB.log.0</div><div class="line">m_curSizeRollBackups : 0</div></pre></td></tr></table></figure>
<h3 id="天呀-我重現了問題了，當-系統重啟後，-log4net-的-m-curSizeRollBackups-就會被重置成-0-。maybe-是-log4net-的-bug-，從-github-下載最新的-log4net-v-2-0-9-來試，居然也是一樣的狀況-。"><a href="#天呀-我重現了問題了，當-系統重啟後，-log4net-的-m-curSizeRollBackups-就會被重置成-0-。maybe-是-log4net-的-bug-，從-github-下載最新的-log4net-v-2-0-9-來試，居然也是一樣的狀況-。" class="headerlink" title="天呀! 我重現了問題了，當 系統重啟後， log4net 的 m_curSizeRollBackups 就會被重置成 0 。maybe 是 log4net 的 bug ，從 github 下載最新的 log4net v 2.0.9 來試，居然也是一樣的狀況 。"></a>天呀! 我重現了問題了，當 系統重啟後， log4net 的 m_curSizeRollBackups 就會被重置成 0 。maybe 是 log4net 的 bug ，從 github 下載最新的 log4net v 2.0.9 來試，居然也是一樣的狀況 。</h3><h3 id="查看github-logging-log4net的-source-，開啟-RollingFileAppender-cs-來看，從-DetermineCurSizeRollBackups-這個-Method"><a href="#查看github-logging-log4net的-source-，開啟-RollingFileAppender-cs-來看，從-DetermineCurSizeRollBackups-這個-Method" class="headerlink" title="查看github logging-log4net的 source ，開啟 RollingFileAppender.cs 來看，從 DetermineCurSizeRollBackups 這個 Method"></a>查看<a href="https://github.com/apache/logging-log4net" target="_blank" rel="external">github logging-log4net</a>的 source ，開啟 RollingFileAppender.cs 來看，從 DetermineCurSizeRollBackups 這個 Method</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DetermineCurSizeRollBackups</span>(<span class="params"></span>)</span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	m_curSizeRollBackups = <span class="number">0</span>;</div><div class="line"></div><div class="line">	<span class="keyword">string</span> fullPath = <span class="literal">null</span>;</div><div class="line">	<span class="keyword">string</span> fileName = <span class="literal">null</span>;</div><div class="line"></div><div class="line">	<span class="keyword">using</span>(SecurityContext.Impersonate(<span class="keyword">this</span>))</div><div class="line">	&#123;</div><div class="line">		fullPath = System.IO.Path.GetFullPath(m_baseFileName);</div><div class="line">		fileName = System.IO.Path.GetFileName(fullPath);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	ArrayList arrayFiles = GetExistingFiles(fullPath);</div><div class="line">	InitializeRollBackups(fileName, arrayFiles);</div><div class="line"></div><div class="line">	LogLog.Debug(declaringType, <span class="string">"curSizeRollBackups starts at ["</span>+m_curSizeRollBackups+<span class="string">"]"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="它會把-Log-目錄中的檔案傳給-InitializeRollBackups-這個-Method，如下，"><a href="#它會把-Log-目錄中的檔案傳給-InitializeRollBackups-這個-Method，如下，" class="headerlink" title="它會把 Log 目錄中的檔案傳給 InitializeRollBackups 這個 Method，如下，"></a>它會把 Log 目錄中的檔案傳給 InitializeRollBackups 這個 Method，如下，</h3><pre><code class="csharp"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">InitializeRollBackups</span>(<span class="params"><span class="keyword">string</span> baseFile, ArrayList arrayFiles</span>)</span>
<span class="function"></span>{
    <span class="keyword">if</span> (<span class="literal">null</span> != arrayFiles)
    {
        <span class="keyword">string</span> baseFileLower = baseFile.ToLower(System.Globalization.CultureInfo.InvariantCulture);

        <span class="keyword">foreach</span>(<span class="keyword">string</span> curFileName <span class="keyword">in</span> arrayFiles)
        {
            InitializeFromOneFile(baseFileLower, curFileName.ToLower(System.Globalization.CultureInfo.InvariantCulture));
        }
    }
}
</code></pre>
<h3 id="而-InitializeRollBackups-中會將-baseFile-轉成小寫-再傳入-InitializeFromOneFile-這個-Method-去比較，而在-InitializeFromOneFile-有一行是比較-baseFile-與-prefix-及-suffix-比較-if-curFileName-StartsWith-prefix-curFileName-EndsWith-suffix-。"><a href="#而-InitializeRollBackups-中會將-baseFile-轉成小寫-再傳入-InitializeFromOneFile-這個-Method-去比較，而在-InitializeFromOneFile-有一行是比較-baseFile-與-prefix-及-suffix-比較-if-curFileName-StartsWith-prefix-curFileName-EndsWith-suffix-。" class="headerlink" title="而 InitializeRollBackups 中會將 baseFile 轉成小寫 再傳入 InitializeFromOneFile 這個 Method 去比較，而在 InitializeFromOneFile 有一行是比較 baseFile 與 prefix 及 suffix 比較(if (!curFileName.StartsWith(prefix) || !curFileName.EndsWith(suffix)))。"></a>而 InitializeRollBackups 中會將 baseFile <em>轉成小寫</em> 再傳入 InitializeFromOneFile 這個 Method 去比較，而在 InitializeFromOneFile 有一行是比較 baseFile 與 prefix 及 suffix 比較(<em>if (!curFileName.StartsWith(prefix) || !curFileName.EndsWith(suffix))</em>)。</h3><h3 id="prefix-就是-config-中-datePattern-的設定值-yyyy-MM-dd-HH-DB3-lo-g-，眼尖的朋友有發現了嗎-我們的檔名裡面的-DB-是大寫，但程式中-log4net-已將目前的-log-檔轉成了小寫，當然比不到。所以在系統重啟時，-m-curSizeRollBackups-的值就會是-0-。"><a href="#prefix-就是-config-中-datePattern-的設定值-yyyy-MM-dd-HH-DB3-lo-g-，眼尖的朋友有發現了嗎-我們的檔名裡面的-DB-是大寫，但程式中-log4net-已將目前的-log-檔轉成了小寫，當然比不到。所以在系統重啟時，-m-curSizeRollBackups-的值就會是-0-。" class="headerlink" title="prefix 就是 config 中 datePattern 的設定值 (yyyy-MM-dd-HH-DB3.lo\g)，眼尖的朋友有發現了嗎? 我們的檔名裡面的 DB 是大寫，但程式中 log4net 已將目前的 log 檔轉成了小寫，當然比不到。所以在系統重啟時， m_curSizeRollBackups 的值就會是 0 。"></a>prefix 就是 config 中 datePattern 的設定值 (<em>yyyy-MM-dd-HH-DB3.lo\g</em>)，眼尖的朋友有發現了嗎? 我們的檔名裡面的 DB 是大寫，但程式中 log4net 已將目前的 log 檔轉成了小寫，當然比不到。所以在系統重啟時， m_curSizeRollBackups 的值就會是 0 。</h3><h3 id="應該要將-if-curFileName-StartsWith-prefix-curFileName-EndsWith-suffix-改成不分大小寫的比較才對，if-curFileName-StartsWith-prefix-StringComparison-CurrentCultureIgnoreCase-curFileName-EndsWith-suffix-StringComparison-CurrentCultureIgnoreCase-。"><a href="#應該要將-if-curFileName-StartsWith-prefix-curFileName-EndsWith-suffix-改成不分大小寫的比較才對，if-curFileName-StartsWith-prefix-StringComparison-CurrentCultureIgnoreCase-curFileName-EndsWith-suffix-StringComparison-CurrentCultureIgnoreCase-。" class="headerlink" title="應該要將 if (!curFileName.StartsWith(prefix) || !curFileName.EndsWith(suffix)) 改成不分大小寫的比較才對，if (!curFileName.StartsWith(prefix, StringComparison.CurrentCultureIgnoreCase) || !curFileName.EndsWith(suffix, StringComparison.CurrentCultureIgnoreCase))。"></a>應該要將 <em>if (!curFileName.StartsWith(prefix) || !curFileName.EndsWith(suffix))</em> 改成不分大小寫的比較才對，<em>if (!curFileName.StartsWith(prefix, StringComparison.CurrentCultureIgnoreCase) || !curFileName.EndsWith(suffix, StringComparison.CurrentCultureIgnoreCase))</em>。</h3><ul>
<li><h2 id="請注意哦-目前-github-上的版本還沒有修正哦"><a href="#請注意哦-目前-github-上的版本還沒有修正哦" class="headerlink" title="請注意哦~~ 目前 github 上的版本還沒有修正哦 !!!"></a>請注意哦~~ 目前 github 上的版本還沒有修正哦 !!!</h2></li>
</ul>
<h3 id="所以目前有以下2項解法，"><a href="#所以目前有以下2項解法，" class="headerlink" title="所以目前有以下2項解法，"></a>所以目前有以下2項解法，</h3><ul>
<li><h3 id="改程式然後更新-log4net"><a href="#改程式然後更新-log4net" class="headerlink" title="改程式然後更新 log4net"></a>改程式然後更新 log4net</h3></li>
<li><h3 id="將檔名-datePattern-從大寫改成小寫，例如-yyyy-MM-dd-HH-db-lo-g-d前面要有-哦"><a href="#將檔名-datePattern-從大寫改成小寫，例如-yyyy-MM-dd-HH-db-lo-g-d前面要有-哦" class="headerlink" title="將檔名 datePattern 從大寫改成小寫，例如 yyyy-MM-dd-HH-\db.lo\g  (d前面要有 \ 哦!)"></a>將檔名 datePattern 從大寫改成小寫，例如 yyyy-MM-dd-HH-\db.lo\g  (d前面要有 \ 哦!)</h3></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/27/2017010/" data-id="cja22rtjx0000109jvxqc92yk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Composite/">Composite</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DetermineCurSizeRollBackups/">DetermineCurSizeRollBackups</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/InitializeFromOneFile/">InitializeFromOneFile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/InitializeRollBackups/">InitializeRollBackups</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RollingFileAppender/">RollingFileAppender</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/log4net/">log4net</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171027" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/27/20171027/" class="article-date">
  <time datetime="2017-10-27T03:21:44.000Z" itemprop="datePublished">2017-10-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/27/20171027/">透過 SmtpClient 寄送 Mail 時，主旨在 Zimbra 會有 ? 的狀況</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="最近同事詢問透過-SmtpClient-去寄送-Mail-時，在-Zimbra-的-Web-界面看會有-的狀況，如下圖，"><a href="#最近同事詢問透過-SmtpClient-去寄送-Mail-時，在-Zimbra-的-Web-界面看會有-的狀況，如下圖，" class="headerlink" title="最近同事詢問透過 SmtpClient 去寄送 Mail 時，在 Zimbra 的 Web 界面看會有 ? 的狀況，如下圖，"></a>最近同事詢問透過 <a href="https://msdn.microsoft.com/zh-tw/library/system.net.mail.smtpclient" target="_blank" rel="external">SmtpClient</a> 去寄送 Mail 時，在 Zimbra 的 Web 界面看會有 ? 的狀況，如下圖，</h3><img src="/2017/10/27/20171027/001.png" alt="001.png" title="">
<h3 id="觀察發現，當主旨太長時才會有這個問題。在-Zimbra-中檢查-Mail-的內容，發現主旨被切分成多段，如下圖，"><a href="#觀察發現，當主旨太長時才會有這個問題。在-Zimbra-中檢查-Mail-的內容，發現主旨被切分成多段，如下圖，" class="headerlink" title="觀察發現，當主旨太長時才會有這個問題。在 Zimbra 中檢查 Mail 的內容，發現主旨被切分成多段，如下圖，"></a>觀察發現，當主旨太長時才會有這個問題。在 Zimbra 中檢查 Mail 的內容，發現主旨被切分成多段，如下圖，</h3><img src="/2017/10/27/20171027/002.png" alt="002.png" title="">
<h3 id="而那些再透過-Base64-轉回來，的確會有-的狀況，看起來應該是-MailMessage-在切分時剛好切到一半所造成的，如下圖，"><a href="#而那些再透過-Base64-轉回來，的確會有-的狀況，看起來應該是-MailMessage-在切分時剛好切到一半所造成的，如下圖，" class="headerlink" title="而那些再透過 Base64 轉回來，的確會有 ? 的狀況，看起來應該是 MailMessage 在切分時剛好切到一半所造成的，如下圖，"></a>而那些再透過 Base64 轉回來，的確會有 ? 的狀況，看起來應該是 MailMessage 在切分時剛好切到一半所造成的，如下圖，</h3><img src="/2017/10/27/20171027/004.png" alt="004.png" title="">
<h3 id="但是這樣子的狀況，在-outlook-來看卻是沒問的哦-如下圖，"><a href="#但是這樣子的狀況，在-outlook-來看卻是沒問的哦-如下圖，" class="headerlink" title="但是這樣子的狀況，在 outlook 來看卻是沒問的哦~~~ 如下圖，"></a>但是這樣子的狀況，在 outlook 來看卻是沒問的哦~~~ 如下圖，</h3><img src="/2017/10/27/20171027/003.png" alt="003.png" title="">
<h3 id="在網路上查到-4-0-SMTPClient-Send-Attachments-mit-Umlauten-im-Dateinamen-，它指出-Base64-會每-30-個字切成一段去串，QuotedPrintable-則是每-76-個字去切。-而我們的狀況似乎是因為它是將字串轉成-Base64-去切，所以會有切到一半的狀況。"><a href="#在網路上查到-4-0-SMTPClient-Send-Attachments-mit-Umlauten-im-Dateinamen-，它指出-Base64-會每-30-個字切成一段去串，QuotedPrintable-則是每-76-個字去切。-而我們的狀況似乎是因為它是將字串轉成-Base64-去切，所以會有切到一半的狀況。" class="headerlink" title="在網路上查到 4.0 SMTPClient.Send Attachments mit Umlauten im Dateinamen ，它指出 Base64 會每 30 個字切成一段去串，QuotedPrintable 則是每 76 個字去切。 而我們的狀況似乎是因為它是將字串轉成 Base64 去切，所以會有切到一半的狀況。"></a>在網路上查到 <a href="https://social.msdn.microsoft.com/Forums/en-US/b6c764f7-4697-4394-b45f-128a24306d55/40-smtpclientsend-attachments-mit-umlauten-im-dateinamen?forum=dotnetframeworkde" target="_blank" rel="external">4.0 SMTPClient.Send Attachments mit Umlauten im Dateinamen</a> ，它指出 Base64 會每 30 個字切成一段去串，QuotedPrintable 則是每 76 個字去切。 而我們的狀況似乎是因為它是將字串轉成 Base64 去切，所以會有切到一半的狀況。</h3><h3 id="所以我們可以調整他的做法，將原始的字串依-7-個字串先切開再串接即可，如下，"><a href="#所以我們可以調整他的做法，將原始的字串依-7-個字串先切開再串接即可，如下，" class="headerlink" title="所以我們可以調整他的做法，將原始的字串依 7 個字串先切開再串接即可，如下，"></a>所以我們可以調整他的做法，將原始的字串依 7 個字串先切開再串接即可，如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EmailHeaderHelper</span></div><div class="line">&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">ToBase64</span>(<span class="params"><span class="keyword">string</span> displayName</span>)</span></div><div class="line"><span class="function">	</span>&#123;</div><div class="line">		<span class="keyword">string</span> tranferEncodingMarker = String.Empty;</div><div class="line">		<span class="keyword">string</span> encodingMarker = String.Empty;</div><div class="line">		<span class="keyword">int</span> maxChunkLength = <span class="number">0</span>;</div><div class="line"></div><div class="line">		tranferEncodingMarker = <span class="string">"B"</span>;</div><div class="line">		encodingMarker = <span class="string">"UTF-8"</span>;</div><div class="line">		maxChunkLength = <span class="number">30</span> / <span class="number">4</span>;</div><div class="line"></div><div class="line">		<span class="keyword">string</span> encodingtoken = String.Format(<span class="string">"=?&#123;0&#125;?&#123;1&#125;?"</span>, encodingMarker, tranferEncodingMarker);</div><div class="line">		<span class="keyword">string</span> softbreak = <span class="string">"?="</span>;</div><div class="line">		<span class="keyword">var</span> encodeDisplayName = <span class="keyword">new</span> StringBuilder();</div><div class="line"></div><div class="line">		<span class="keyword">foreach</span> (<span class="function"><span class="keyword">var</span> splitItem <span class="keyword">in</span> <span class="title">SplitByLength</span>(<span class="params">displayName, maxChunkLength</span>))</span></div><div class="line"><span class="function">		</span>&#123;</div><div class="line">			encodeDisplayName.Append(encodingtoken);</div><div class="line">			encodeDisplayName.Append(Convert.ToBase64String(Encoding.UTF8.GetBytes(splitItem)));</div><div class="line">			encodeDisplayName.Append(softbreak);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> encodeDisplayName.ToString();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> IEnumerable&lt;<span class="keyword">string</span>&gt; <span class="title">SplitByLength</span>(<span class="params"><span class="keyword">string</span> stringToSplit, <span class="keyword">int</span> length</span>)</span></div><div class="line"><span class="function">	</span>&#123;</div><div class="line">		<span class="keyword">while</span> (stringToSplit.Length &gt; length)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">yield</span> <span class="keyword">return</span> stringToSplit.Substring(<span class="number">0</span>, length);</div><div class="line">			stringToSplit = stringToSplit.Substring(length);</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="keyword">if</span> (stringToSplit.Length &gt; <span class="number">0</span>) <span class="keyword">yield</span> <span class="keyword">return</span> stringToSplit;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="所以使用如下，"><a href="#所以使用如下，" class="headerlink" title="所以使用如下，"></a>所以使用如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">string</span> subject = <span class="string">"華華華(華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華"</span>;</div><div class="line">message.Subject = EmailHeaderHelper.ToBase64(subject);</div></pre></td></tr></table></figure>
<h3 id="不過筆者發現，如果您有2個-utf-8-B-的話，-NET-的-Mail-元件似乎也不會自動去幫你切斷，所以另個寫法是自已串-Base64-的字串後，再串一個空的-utf-8-B-，如下，"><a href="#不過筆者發現，如果您有2個-utf-8-B-的話，-NET-的-Mail-元件似乎也不會自動去幫你切斷，所以另個寫法是自已串-Base64-的字串後，再串一個空的-utf-8-B-，如下，" class="headerlink" title="不過筆者發現，如果您有2個 =?utf-8?B? 的話， .NET 的 Mail 元件似乎也不會自動去幫你切斷，所以另個寫法是自已串 Base64 的字串後，再串一個空的 =?utf-8?B? ，如下，"></a>不過筆者發現，如果您有2個 <em>=?utf-8?B?</em> 的話， .NET 的 Mail 元件似乎也不會自動去幫你切斷，所以另個寫法是自已串 Base64 的字串後，再串一個空的 <em>=?utf-8?B?</em> ，如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">string</span> subject = <span class="string">"華華華(華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華"</span>;</div><div class="line"><span class="keyword">byte</span>[] subjectBytes = Encoding.GetEncoding(<span class="string">"utf-8"</span>).GetBytes(subject);</div><div class="line"><span class="keyword">string</span> subjectBase64 = <span class="string">"=?utf-8?B?"</span> + Convert.ToBase64String(subjectBytes) + <span class="string">"?="</span>;</div><div class="line"><span class="comment">//多加一個空的 =?utf-8?B??= ，就不會再被切開了</span></div><div class="line">subjectBase64 += <span class="string">"=?utf-8?B??="</span>;</div><div class="line">message.Subject = subjectBase64;</div></pre></td></tr></table></figure>
<img src="/2017/10/27/20171027/005.png" alt="005.png" title="">
<h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul>
<li><a href="https://social.msdn.microsoft.com/Forums/en-US/b6c764f7-4697-4394-b45f-128a24306d55/40-smtpclientsend-attachments-mit-umlauten-im-dateinamen?forum=dotnetframeworkde" target="_blank" rel="external">4.0 SMTPClient.Send Attachments mit Umlauten im Dateinamen</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/27/20171027/" data-id="cja22rtkl000e109j4v8wi9gq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/utf-8-B/">=?utf-8?B?</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/號/">?號</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Attachments/">Attachments</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MailMessage/">MailMessage</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Multiple/">Multiple</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SMTPClient/">SMTPClient</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Subject/">Subject</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171017-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/17/20171017-2/" class="article-date">
  <time datetime="2017-10-17T05:34:17.000Z" itemprop="datePublished">2017-10-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/17/20171017-2/">Compiling IB documents for earlier than iOS 7 is no longer supported.</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="最近透過-Xcode-9-建置舊的-Cordova-專案，在建置時就發生-Compiling-IB-documents-for-earlier-than-iOS-7-is-no-longer-supported-的錯誤，依Illegal-Configuration-Compiling-IB-documents-for-earlier-than-iOS-7-is-no-longer-supported的說明，只要將-Interface-Builder-Document-的-Builds-for-改成-iOS-7-0-後版本就可以了，如下圖所示，"><a href="#最近透過-Xcode-9-建置舊的-Cordova-專案，在建置時就發生-Compiling-IB-documents-for-earlier-than-iOS-7-is-no-longer-supported-的錯誤，依Illegal-Configuration-Compiling-IB-documents-for-earlier-than-iOS-7-is-no-longer-supported的說明，只要將-Interface-Builder-Document-的-Builds-for-改成-iOS-7-0-後版本就可以了，如下圖所示，" class="headerlink" title="最近透過 Xcode 9 建置舊的 Cordova 專案，在建置時就發生 Compiling IB documents for earlier than iOS 7 is no longer supported. 的錯誤，依Illegal Configuration: Compiling IB documents for earlier than iOS 7 is no longer supported的說明，只要將 Interface Builder Document 的 Builds for 改成 iOS 7.0 後版本就可以了，如下圖所示，"></a>最近透過 Xcode 9 建置舊的 Cordova 專案，在建置時就發生 <em>Compiling IB documents for earlier than iOS 7 is no longer supported.</em> 的錯誤，依<a href="https://stackoverflow.com/questions/44429415/illegal-configuration-compiling-ib-documents-for-earlier-than-ios-7-is-no-longe" target="_blank" rel="external">Illegal Configuration: Compiling IB documents for earlier than iOS 7 is no longer supported</a>的說明，只要將 Interface Builder Document 的 <em>Builds for</em> 改成 iOS 7.0 後版本就可以了，如下圖所示，</h3><img src="/2017/10/17/20171017-2/IBVersion.png" alt="IBVersion.png" title="">
      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/17/20171017-2/" data-id="cja22rtki000b109j8l29q0db" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ios/">ios</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xCode-9/">xCode 9</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171017" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/17/20171017/" class="article-date">
  <time datetime="2017-10-17T05:10:42.000Z" itemprop="datePublished">2017-10-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/17/20171017/">Add a profile to the provisioningProfiles dictionary in your Export Options property list.</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="最近透過-xcodebuild-來產生-ipa-檔時，以下的錯誤，"><a href="#最近透過-xcodebuild-來產生-ipa-檔時，以下的錯誤，" class="headerlink" title="最近透過 xcodebuild 來產生 ipa 檔時，以下的錯誤，"></a>最近透過 xcodebuild 來產生 ipa 檔時，以下的錯誤，</h3><p><em>error: exportArchive: …app requires a provisioning profile.</em><br><em>Error Domain=IDEProvisioningErrorDomain Code=9 …requires a provisioning profile. …NSLocalizedRecoverySuggestion=Add a profile to the “provisioningProfiles” dictionary in your Export Options property list.}</em></p>
<img src="/2017/10/17/20171017/exportArchiveFail.png" alt="exportArchiveFail.png" title="">
<h3 id="原來是因為-xCode-9-的-export-Options-plist-檔中需要再指定-provisioningProfiles-相關資料，內容如下圖，"><a href="#原來是因為-xCode-9-的-export-Options-plist-檔中需要再指定-provisioningProfiles-相關資料，內容如下圖，" class="headerlink" title="原來是因為 xCode 9 的 export Options plist 檔中需要再指定 provisioningProfiles 相關資料，內容如下圖，"></a>原來是因為 xCode 9 的 export Options plist 檔中需要再指定 <em>provisioningProfiles</em> 相關資料，內容如下圖，</h3><img src="/2017/10/17/20171017/exportOptionsPlist.png" alt="exportOptionsPlist.png" title="">
<h3 id="最簡單的方式可以參考-New-export-options-Plist-in-Xcode-9-的方式，先透過-Xcode-產生-ipa-後，在-ipa-的目錄中會有-ExportOptions-plist-檔案，直接將它拿來用就可以了哦"><a href="#最簡單的方式可以參考-New-export-options-Plist-in-Xcode-9-的方式，先透過-Xcode-產生-ipa-後，在-ipa-的目錄中會有-ExportOptions-plist-檔案，直接將它拿來用就可以了哦" class="headerlink" title="最簡單的方式可以參考 New export options Plist in Xcode 9 的方式，先透過 Xcode 產生 ipa 後，在 ipa 的目錄中會有 ExportOptions.plist 檔案，直接將它拿來用就可以了哦!"></a>最簡單的方式可以參考 <a href="https://blog.bitrise.io/new-export-options-plist-in-xcode-9" target="_blank" rel="external">New export options Plist in Xcode 9</a> 的方式，先透過 Xcode 產生 ipa 後，在 ipa 的目錄中會有 <em>ExportOptions.plist</em> 檔案，直接將它拿來用就可以了哦!</h3><h2 id="參考資訊"><a href="#參考資訊" class="headerlink" title="參考資訊"></a>參考資訊</h2><ul>
<li><p><a href="http://www.matrixprojects.net/p/xcodebuild-export-options-plist/" target="_blank" rel="external">xcodebuild’s new exportOptionsPlist flag</a></p>
</li>
<li><p><a href="https://blog.bitrise.io/new-export-options-plist-in-xcode-9" target="_blank" rel="external">New export options Plist in Xcode 9</a></p>
</li>
<li><p><a href="https://stackoverflow.com/questions/39674237/xcrun-command-to-export-ipa-file-xcode8-for-iphoneos10-0" target="_blank" rel="external">xcrun command to export ipa file xcode8 for iphoneos10.0</a></p>
</li>
<li><p><a href="https://medium.com/xcblog/xcodebuild-deploy-ios-app-from-command-line-c6defff0d8b8" target="_blank" rel="external">xcodebuild: Deploy iOS app from Command Line</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/88d9f2e57004" target="_blank" rel="external">xcodebuild命令简单使用</a></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/17/20171017/" data-id="cja22rtkk000d109jbf86fnlr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Export-Options-property-list/">Export Options property list</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Xcode-9/">Xcode 9</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exportArchive/">exportArchive</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exportOptionsPlist/">exportOptionsPlist</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ios/">ios</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/provisioningProfiles/">provisioningProfiles</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xcodebuild/">xcodebuild</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171013" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/13/20171013/" class="article-date">
  <time datetime="2017-10-13T14:02:06.000Z" itemprop="datePublished">2017-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/13/20171013/">從外部資料庫驅動程式產生的非預期的錯誤 (1) @ OleDbConnection.Open</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="今天同事詢問有沒有看過以下的錯誤訊息，"><a href="#今天同事詢問有沒有看過以下的錯誤訊息，" class="headerlink" title="今天同事詢問有沒有看過以下的錯誤訊息，"></a>今天同事詢問有沒有看過以下的錯誤訊息，</h3><p><em><system.data.oledb.oledbexception> 從外部資料庫驅動程式產生的非預期的錯誤 (1)。 [ OleDbException.ErrorCode : -2147467259 ]</system.data.oledb.oledbexception></em></p>
<p><em>Unexpected error from external database driver (1). (Microsoft JET Database Engine)</em></p>
<h3 id="程式只是透過-Provider-Microsoft-Jet-OLEDB-4-0-去開啟一個-excel-檔而已，而且同事詢問這個問題後，另一位同事也在詢問相同的問題。"><a href="#程式只是透過-Provider-Microsoft-Jet-OLEDB-4-0-去開啟一個-excel-檔而已，而且同事詢問這個問題後，另一位同事也在詢問相同的問題。" class="headerlink" title="程式只是透過 Provider=Microsoft.Jet.OLEDB.4.0; 去開啟一個 excel 檔而已，而且同事詢問這個問題後，另一位同事也在詢問相同的問題。"></a>程式只是透過 <em>Provider=Microsoft.Jet.OLEDB.4.0;</em> 去開啟一個 excel 檔而已，而且同事詢問這個問題後，另一位同事也在詢問相同的問題。</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> conn = <span class="keyword">new</span> System.Data.OleDb.OleDbConnection(<span class="string">"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\Users\\kt\\Documents\\VS Code\\TEST_EXCEL\\aa.xls;Extended Properties=\"Excel 8.0;HDR=Yes;IMEX=1;\""</span>);</div><div class="line">conn.Open();</div></pre></td></tr></table></figure>
<h3 id="但這支程式前陣子用的好好的呀-為什麼今天卻發生了這樣子的錯誤呢"><a href="#但這支程式前陣子用的好好的呀-為什麼今天卻發生了這樣子的錯誤呢" class="headerlink" title="但這支程式前陣子用的好好的呀! 為什麼今天卻發生了這樣子的錯誤呢?"></a>但這支程式前陣子用的好好的呀! 為什麼今天卻發生了這樣子的錯誤呢?</h3><h3 id="於是往-Windows-更新來看，發現有2個更新，如下，"><a href="#於是往-Windows-更新來看，發現有2個更新，如下，" class="headerlink" title="於是往 Windows 更新來看，發現有2個更新，如下，"></a>於是往 Windows 更新來看，發現有2個更新，如下，</h3><img src="/2017/10/13/20171013/windowsUpdate.png" alt="windowsUpdate.png" title="">
<h3 id="查看一下-kb4041681-裡面有更動到-Microsoft-JET-Database-Engine-而我們是有用到它呢-於是將它反安裝後重新開機後，再執行程式就沒問題了。"><a href="#查看一下-kb4041681-裡面有更動到-Microsoft-JET-Database-Engine-而我們是有用到它呢-於是將它反安裝後重新開機後，再執行程式就沒問題了。" class="headerlink" title="查看一下 kb4041681 , 裡面有更動到 Microsoft JET Database Engine 而我們是有用到它呢!!! 於是將它反安裝後重新開機後，再執行程式就沒問題了。"></a>查看一下 <a href="https://support.microsoft.com/en-us/help/4041681/windows-7-update-kb4041681" target="_blank" rel="external">kb4041681</a> , 裡面有更動到 <em>Microsoft JET Database Engine</em> 而我們是有用到它呢!!! 於是將它反安裝後重新開機後，再執行程式就沒問題了。</h3><h3 id="這個更新似乎將-msexcl40-dll-從-V4-00-9801-0-to-v4-00-9801-1-，-X64-在-C-Windows-SysWOW64-目錄。"><a href="#這個更新似乎將-msexcl40-dll-從-V4-00-9801-0-to-v4-00-9801-1-，-X64-在-C-Windows-SysWOW64-目錄。" class="headerlink" title="這個更新似乎將 msexcl40.dll 從 V4.00.9801.0 to v4.00.9801.1 ， X64 在 C:\Windows\SysWOW64 目錄。"></a>這個更新似乎將 msexcl40.dll 從 V4.00.9801.0 to v4.00.9801.1 ， X64 在 C:\Windows\SysWOW64 目錄。</h3><h2 id="依-“Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine-”-after-applying-October-security-updates-的說明，解法有以下3個，"><a href="#依-“Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine-”-after-applying-October-security-updates-的說明，解法有以下3個，" class="headerlink" title="依 “Unexpected error from external database driver (1). (Microsoft JET Database Engine)” after applying October security updates. 的說明，解法有以下3個，"></a>依 <a href="https://blogs.msdn.microsoft.com/dataaccesstechnologies/2017/10/18/unexpected-error-from-external-database-driver-1-microsoft-jet-database-engine-after-applying-october-security-updates/" target="_blank" rel="external">“Unexpected error from external database driver (1). (Microsoft JET Database Engine)” after applying October security updates.</a> 的說明，解法有以下3個，</h2><h3 id="1-安裝更新後，調整程式，方式如下，"><a href="#1-安裝更新後，調整程式，方式如下，" class="headerlink" title="1.安裝更新後，調整程式，方式如下，"></a>1.安裝更新後，調整程式，方式如下，</h3><ul>
<li>安裝 <a href="https://www.microsoft.com/zh-tw/download/details.aspx?id=13255" target="_blank" rel="external">Microsoft Access Database Engine 2010 可轉散發套件</a> 有分 x86/x64 版本哦! </li>
<li>將連線字串從 Provider=Microsoft.Jet.OLEDB.4.0  改成 Provider=Microsoft.ACE.OLEDB.12.0 </li>
</ul>
<h3 id="2-移除相關的-KB"><a href="#2-移除相關的-KB" class="headerlink" title="2.移除相關的 KB"></a>2.移除相關的 KB</h3><h3 id="3-使用舊的-msexcl40-dll-v4-00-9801-1-以前的版本"><a href="#3-使用舊的-msexcl40-dll-v4-00-9801-1-以前的版本" class="headerlink" title="3.使用舊的 msexcl40.dll (v4.00.9801.1 以前的版本)"></a>3.使用舊的 msexcl40.dll (v4.00.9801.1 以前的版本)</h3><ul>
<li>先到可以運作的電腦中 Copy msexcel40.dll 存到某個目錄之中，例如 c:\excel32 。</li>
<li>修改註冊機碼 [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Jet\4.0\Engines\Excel\Win32] 從原本的 C:\Windows\SysWOW64\msexcel40.dll 改成 c:\excel32\msexcel40.dll 。<img src="/2017/10/13/20171013/002.png" alt="002.png" title="">
</li>
</ul>
<h3 id="Windows-Update-其中的內容如下，"><a href="#Windows-Update-其中的內容如下，" class="headerlink" title="Windows Update 其中的內容如下，"></a>Windows Update 其中的內容如下，</h3><p><em>Security updates to Microsoft Windows Search Component, Windows kernel-mode drivers, Microsoft Graphics Component, Internet Explorer, Windows kernel, Windows Wireless Networking, Microsoft JET Database Engine, and the Windows SMB Server.</em></p>
<h3 id="目前發現有以下幾個-kb-會影響到，"><a href="#目前發現有以下幾個-kb-會影響到，" class="headerlink" title="目前發現有以下幾個 kb 會影響到，"></a>目前發現有以下幾個 kb 會影響到，</h3><ul>
<li><p><a href="https://support.microsoft.com/en-us/help/4041678/windows-7-update-kb4041678" target="_blank" rel="external">kb4041678</a> Win 7 / Win 2008 </p>
</li>
<li><p><a href="https://support.microsoft.com/en-us/help/4041681/windows-7-update-kb4041681" target="_blank" rel="external">kb4041681</a> Win 7 / Win 2008</p>
</li>
<li><p><a href="https://support.microsoft.com/zh-hk/help/4042007/description-of-the-security-update-for-the-microsoft-jet-database-engi" target="_blank" rel="external">Kb4042007</a> Win 2008</p>
</li>
<li><p><a href="https://support.microsoft.com/en-us/help/4041691/windows-10-update-kb4041691" target="_blank" rel="external">kb4041691</a> Win 10 / Win 2016</p>
</li>
<li><p><a href="https://support.microsoft.com/en-us/help/4041676/windows-10-update-kb4041676" target="_blank" rel="external">kb4041676</a> Win 10</p>
</li>
<li><p>如果有一樣的錯誤訊息，應該是因為 windows update ，請檢查最近的 windows update 哦! 可以的話也讓小弟知道一下下 ^_^</p>
</li>
</ul>
<h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><p><a href="http://www.cnblogs.com/net-god/p/7661313.html" target="_blank" rel="external">Excel Microsoft.Jet.OLEDB.4.0 外部数据库驱动程序中(1)的意外错误</a></p>
<p><a href="https://support.microsoft.com/zh-hk/help/4042007/description-of-the-security-update-for-the-microsoft-jet-database-engi" target="_blank" rel="external">Kb4042007 Microsoft Jet 资料库引擎遠端執行程式碼弱點的安全性更新：2017 年 10 月 10 日</a></p>
<p><a href="https://blogs.msdn.microsoft.com/dataaccesstechnologies/2017/10/18/unexpected-error-from-external-database-driver-1-microsoft-jet-database-engine-after-applying-october-security-updates/" target="_blank" rel="external">“Unexpected error from external database driver (1). (Microsoft JET Database Engine)” after applying October security updates.</a></p>
<p>本著作係採用<a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="external">創用 CC 姓名標示-相同方式分享 4.0 國際 授權條款</a>授權，文章歡迎轉載，請註明出處，謝謝~~~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/13/20171013/" data-id="cja22rtkh000a109jrdqrgqld" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Microsoft-Jet-OLEDB-4-0/">Microsoft.Jet.OLEDB.4.0</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unexpected-error-from-external-database-driver-1/">Unexpected error from external database driver (1)</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine/">Unexpected error from external database driver (1). (Microsoft JET Database Engine)</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kb4041676/">kb4041676</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kb4041678/">kb4041678</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kb4041681/">kb4041681</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kb4041691/">kb4041691</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/外部数据库驱动程序中-1-的意外错误/">外部数据库驱动程序中(1)的意外错误</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/從外部資料庫驅動程式產生的非預期的錯誤-1/">從外部資料庫驅動程式產生的非預期的錯誤 (1)</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171005" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/05/20171005/" class="article-date">
  <time datetime="2017-10-05T02:03:07.000Z" itemprop="datePublished">2017-10-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/05/20171005/">Cordova iOS No target specifed for emulator. Deploying to undefined simulator</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="最近建立一個簡單-Cordova-專案在-Mac-macOS-10-12-6-Xcode-9-上測試時，居然發「No-target-specified-for-emulator-」的錯誤，-iOS-emulator-就不會自動的跑起來。如下圖，"><a href="#最近建立一個簡單-Cordova-專案在-Mac-macOS-10-12-6-Xcode-9-上測試時，居然發「No-target-specified-for-emulator-」的錯誤，-iOS-emulator-就不會自動的跑起來。如下圖，" class="headerlink" title="最近建立一個簡單 Cordova 專案在 Mac (macOS 10.12.6, Xcode 9) 上測試時，居然發「No target specified for emulator.」的錯誤， iOS emulator 就不會自動的跑起來。如下圖，"></a>最近建立一個簡單 Cordova 專案在 Mac (macOS 10.12.6, Xcode 9) 上測試時，居然發「No target specified for emulator.」的錯誤， iOS emulator 就不會自動的跑起來。如下圖，</h3><img src="/2017/10/05/20171005/errSimDeviceTypeUndefined.png" alt="errSimDeviceTypeUndefined.png" title="">
<h3 id="輸入-「cordova-run-ios-–list」，-virtual-devices-都沒有顯示任何的資料，如下圖，"><a href="#輸入-「cordova-run-ios-–list」，-virtual-devices-都沒有顯示任何的資料，如下圖，" class="headerlink" title="輸入 「cordova run ios –list」， virtual devices 都沒有顯示任何的資料，如下圖，"></a>輸入 「cordova run ios –list」， virtual devices 都沒有顯示任何的資料，如下圖，</h3><img src="/2017/10/05/20171005/runioslist.png" alt="runioslist.png" title="">
<h3 id="查看No-target-specified-for-emulator-Deploying-to-iPhone-SE-10-3-simulator說明，更新-cordova-ios-到-4-5-0-就可以了，所以就先將原本的-cordova-ios-移除，再加入-4-5-0-版本的，如下，"><a href="#查看No-target-specified-for-emulator-Deploying-to-iPhone-SE-10-3-simulator說明，更新-cordova-ios-到-4-5-0-就可以了，所以就先將原本的-cordova-ios-移除，再加入-4-5-0-版本的，如下，" class="headerlink" title="查看No target specified for emulator. Deploying to iPhone-SE, 10.3 simulator說明，更新 cordova-ios 到 4.5.0 就可以了，所以就先將原本的 cordova-ios 移除，再加入 4.5.0 版本的，如下，"></a>查看<a href="https://github.com/ionic-team/ionic-cli/issues/2487" target="_blank" rel="external">No target specified for emulator. Deploying to iPhone-SE, 10.3 simulator</a>說明，更新 cordova-ios 到 4.5.0 就可以了，所以就先將原本的 cordova-ios 移除，再加入 4.5.0 版本的，如下，</h3><img src="/2017/10/05/20171005/platformAddiOS45.png" alt="platformAddiOS45.png" title="">
<h3 id="註"><a href="#註" class="headerlink" title="註:"></a>註:</h3><h3 id="如果沒特別設定版本的話，目前-cordova-ios-的版本是-4-4-哦-如下圖，"><a href="#如果沒特別設定版本的話，目前-cordova-ios-的版本是-4-4-哦-如下圖，" class="headerlink" title="如果沒特別設定版本的話，目前 cordova-ios 的版本是 4.4 哦! 如下圖，"></a>如果沒特別設定版本的話，目前 cordova-ios 的版本是 4.4 哦! 如下圖，</h3><img src="/2017/10/05/20171005/platformAddiOS.png" alt="platformAddiOS.png" title="">
<h3 id="再輸入-「cordova-run-ios-–list」，-virtual-devices-就出現了一堆的資料了，如下圖，"><a href="#再輸入-「cordova-run-ios-–list」，-virtual-devices-就出現了一堆的資料了，如下圖，" class="headerlink" title="再輸入 「cordova run ios –list」， virtual devices 就出現了一堆的資料了，如下圖，"></a>再輸入 「cordova run ios –list」， virtual devices 就出現了一堆的資料了，如下圖，</h3><img src="/2017/10/05/20171005/runioslistGot.png" alt="runioslistGot.png" title="">
<h3 id="輸入「cordova-run-ios」，emulator-就順利起動了，如下，"><a href="#輸入「cordova-run-ios」，emulator-就順利起動了，如下，" class="headerlink" title="輸入「cordova run ios」，emulator 就順利起動了，如下，"></a>輸入「cordova run ios」，emulator 就順利起動了，如下，</h3><img src="/2017/10/05/20171005/RunEmulator.png" alt="RunEmulator.png" title="">
<h3 id="另外，如果您在-Build-ipa-發生-「error-70-requires-provisioning-profile」，可以參考「After-upgrading-to-xcode-9-cordova-app-won’t-build-error-70-requires-provisioning-profile」的做法，在加入-ios-時，改取-github-上-master-這個版本，例如，"><a href="#另外，如果您在-Build-ipa-發生-「error-70-requires-provisioning-profile」，可以參考「After-upgrading-to-xcode-9-cordova-app-won’t-build-error-70-requires-provisioning-profile」的做法，在加入-ios-時，改取-github-上-master-這個版本，例如，" class="headerlink" title="另外，如果您在 Build ipa 發生 「error 70, requires provisioning profile」，可以參考「After upgrading to xcode 9, cordova app won’t build, error 70, requires provisioning profile」的做法，在加入 ios 時，改取 github 上 master 這個版本，例如，"></a>另外，如果您在 Build ipa 發生 「error 70, requires provisioning profile」，可以參考「<a href="https://stackoverflow.com/questions/46344443/after-upgrading-to-xcode-9-cordova-app-wont-build-error-70-requires-provisio" target="_blank" rel="external">After upgrading to xcode 9, cordova app won’t build, error 70, requires provisioning profile</a>」的做法，在加入 ios 時，改取 github 上 master 這個版本，例如，</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cordova platform add https://github.com/apache/cordova-ios.git</div></pre></td></tr></table></figure>
<h3 id="記得要新增-build-json-，然後設定相關的屬性哦"><a href="#記得要新增-build-json-，然後設定相關的屬性哦" class="headerlink" title="記得要新增 build.json ，然後設定相關的屬性哦!"></a>記得要新增 build.json ，然後設定相關的屬性哦!</h3><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><h3 id="No-target-specified-for-emulator-Deploying-to-iPhone-SE-10-3-simulator"><a href="#No-target-specified-for-emulator-Deploying-to-iPhone-SE-10-3-simulator" class="headerlink" title="No target specified for emulator. Deploying to iPhone-SE, 10.3 simulator"></a><a href="https://github.com/ionic-team/ionic-cli/issues/2487" target="_blank" rel="external">No target specified for emulator. Deploying to iPhone-SE, 10.3 simulator</a></h3><h3 id="After-upgrading-to-xcode-9-cordova-app-won’t-build-error-70-requires-provisioning-profile"><a href="#After-upgrading-to-xcode-9-cordova-app-won’t-build-error-70-requires-provisioning-profile" class="headerlink" title="After upgrading to xcode 9, cordova app won’t build, error 70, requires provisioning profile"></a><a href="https://stackoverflow.com/questions/46344443/after-upgrading-to-xcode-9-cordova-app-wont-build-error-70-requires-provisio" target="_blank" rel="external">After upgrading to xcode 9, cordova app won’t build, error 70, requires provisioning profile</a></h3><h3 id="Cordova-Error-Your-ios-platform-does-not-have-Api-js"><a href="#Cordova-Error-Your-ios-platform-does-not-have-Api-js" class="headerlink" title="Cordova Error: Your ios platform does not have Api.js"></a><a href="https://stackoverflow.com/questions/44042641/cordova-error-your-ios-platform-does-not-have-api-js" target="_blank" rel="external">Cordova Error: Your ios platform does not have Api.js</a></h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/05/20171005/" data-id="cja22rtkg0008109j84irjlad" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/com-apple-CoreSimulator-SimDeviceType-undefined/">com.apple.CoreSimulator.SimDeviceType.undefined</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cordova/">cordova</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ios-11/">ios 11</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171003-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/03/20171003-2/" class="article-date">
  <time datetime="2017-10-03T09:32:23.000Z" itemprop="datePublished">2017-10-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/03/20171003-2/">取得 Execute SQL 裡面資料的值</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="有同事詢問他要如何取得-Exec-t-sql-裡面的值，因為-Exec-與外面是不同的-Scope-所以要取得裡面值有以下幾種情況。"><a href="#有同事詢問他要如何取得-Exec-t-sql-裡面的值，因為-Exec-與外面是不同的-Scope-所以要取得裡面值有以下幾種情況。" class="headerlink" title="有同事詢問他要如何取得 Exec(t-sql) 裡面的值，因為 Exec 與外面是不同的 Scope 所以要取得裡面值有以下幾種情況。"></a>有同事詢問他要如何取得 Exec(t-sql) 裡面的值，因為 Exec 與外面是不同的 Scope 所以要取得裡面值有以下幾種情況。</h3><ul>
<li><p>Store Procedue ，透過 sp_executesql + 它的 output 參數來取得資料，例如，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DECLARE</span> @<span class="keyword">sql</span> <span class="keyword">NVARCHAR</span>(<span class="keyword">max</span>), @outputcode <span class="keyword">NVARCHAR</span>(<span class="number">4000</span>);</div><div class="line"><span class="keyword">SET</span> @<span class="keyword">sql</span> = </div><div class="line"><span class="string">'</span></div><div class="line"><span class="string">EXEC SP_GETSERNO @RETURNS=@outputcode output</span></div><div class="line"><span class="string">'</span>;</div><div class="line">exec sp_executesql @sql, N'@outputcode NVARCHAR(4000) out', @outputcode out</div><div class="line"><span class="keyword">SELECT</span> @outputcode;</div></pre></td></tr></table></figure>
</li>
<li><p>取得 t-sql 裡面的內容，需要先建立 temp table ，或是 TABLE 變數，然後在 Exec 的 t-sql 裡面使用，例如，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DECLARE</span> @ATT_IDENT <span class="keyword">TABLE</span> (ATT_IDENT <span class="built_in">int</span>);</div><div class="line"><span class="keyword">INSERT</span> @ATT_IDENT</div><div class="line">exec (<span class="string">'SELECT top 1 ATT_IDENT FROM [dbo].[myTable]'</span>);</div><div class="line"><span class="keyword">select</span> * <span class="keyword">FROM</span> @ATT_IDENT;</div></pre></td></tr></table></figure>
</li>
<li><p>t-sql，透過 sp_executesql + 它的 output 參數來取得資料，例如，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DECLARE</span> @IDT <span class="built_in">NUMERIC</span></div><div class="line">exec sp_executesql N<span class="string">'SELECT TOP 1 @IDT = ATT_IDENT FROM [dbo].[myTable]'</span>, N<span class="string">'@IDT NUMERIC out'</span>, @IDT <span class="keyword">OUT</span></div><div class="line"><span class="keyword">SELECT</span> @IDT;</div></pre></td></tr></table></figure>
</li>
<li><p>透過 OPENQUERY 的方式，詳細可以參考「<a href="https://dotblogs.com.tw/rainmaker/2015/02/02/148355" target="_blank" rel="external">讓 Execute 可以搭配 Select Into，而不再只有 Insert into</a>」</p>
</li>
</ul>
<h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><h3 id="How-to-set-value-to-variable-using-‘execute’-in-t-sql"><a href="#How-to-set-value-to-variable-using-‘execute’-in-t-sql" class="headerlink" title="How to set value to variable using ‘execute’ in t-sql?"></a><a href="https://stackoverflow.com/questions/7229070/how-to-set-value-to-variable-using-execute-in-t-sql" target="_blank" rel="external">How to set value to variable using ‘execute’ in t-sql?</a></h3><h3 id="讓-Execute-可以搭配-Select-Into，而不再只有-Insert-into"><a href="#讓-Execute-可以搭配-Select-Into，而不再只有-Insert-into" class="headerlink" title="讓 Execute 可以搭配 Select Into，而不再只有 Insert into"></a><a href="https://dotblogs.com.tw/rainmaker/2015/02/02/148355" target="_blank" rel="external">讓 Execute 可以搭配 Select Into，而不再只有 Insert into</a></h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/03/20171003-2/" data-id="cja22rtkb0005109jsy4jvbhp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/How-to-get-value-to-variable-using-execute-in-t-sql/">How to get value to variable using 'execute' in t-sql?</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exec/">exec</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exec-in-t-sql/">exec in t-sql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/execute/">execute</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql/">sql</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171003" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/03/20171003/" class="article-date">
  <time datetime="2017-10-03T03:52:14.000Z" itemprop="datePublished">2017-10-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/03/20171003/">ASPOSE.Words 產生 中文編號 一、 二、 在 doc 及 odt 的問題</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="我們透過-ASPOSE-Words-產生-Word-doc-檔-及-OpenOffice-odt-檔時，中文編號-NumberStyle-是使用-NumberStyle-TradChinNum3。-測試程式如下，"><a href="#我們透過-ASPOSE-Words-產生-Word-doc-檔-及-OpenOffice-odt-檔時，中文編號-NumberStyle-是使用-NumberStyle-TradChinNum3。-測試程式如下，" class="headerlink" title="我們透過 ASPOSE.Words 產生 Word doc 檔 及 OpenOffice odt 檔時，中文編號 (NumberStyle) 是使用 NumberStyle.TradChinNum3。 測試程式如下，"></a>我們透過 ASPOSE.Words 產生 Word doc 檔 及 OpenOffice odt 檔時，中文編號 (<a href="https://docs.aspose.com/display/wordsnet/Aspose.Words.NumberStyle+Enumeration" target="_blank" rel="external">NumberStyle</a>) 是使用 NumberStyle.TradChinNum3。 測試程式如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">NumberStyleTest</span>(<span class="params"></span>)</span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">var</span> doc = <span class="keyword">new</span> Document();</div><div class="line">	doc.Styles.DefaultParagraphFormat.Style.Font.NameFarEast = <span class="string">"標楷體"</span>;</div><div class="line">	doc.Styles.DefaultParagraphFormat.Style.Font.NameAscii = <span class="string">"Times New Roman"</span>;</div><div class="line">	doc.Styles.DefaultParagraphFormat.Style.Font.Size = <span class="number">16</span>D;</div><div class="line">	<span class="keyword">var</span> builder = <span class="keyword">new</span> DocumentBuilder(doc);</div><div class="line"></div><div class="line">	doc.Lists.Add(ListTemplate.NumberDefault);</div><div class="line">	builder.ListFormat.List = ListSetting(doc, <span class="number">0</span>);</div><div class="line"></div><div class="line">	builder.Font.Size = <span class="number">16</span>D;</div><div class="line">	builder.Font.Color = Color.Black;</div><div class="line">	builder.ParagraphFormat.LineSpacingRule = LineSpacingRule.Multiple;</div><div class="line">	builder.ParagraphFormat.LineSpacing = <span class="number">13.8</span>;</div><div class="line">	builder.ParagraphFormat.Alignment = ParagraphAlignment.Justify;</div><div class="line">	builder.ListFormat.ListLevelNumber = <span class="number">0</span>;</div><div class="line">	builder.Writeln(<span class="string">"測試一"</span>);</div><div class="line">	builder.ListFormat.ListLevelNumber = <span class="number">1</span>;</div><div class="line">	builder.Writeln(<span class="string">"測試二"</span>);</div><div class="line">	builder.ParagraphFormat.ClearFormatting();</div><div class="line">	builder.ListFormat.RemoveNumbers();</div><div class="line">	builder.Writeln();</div><div class="line"></div><div class="line">	doc.Save(<span class="string">"TEST.doc"</span>, SaveFormat.Doc);</div><div class="line">	doc.Save(<span class="string">"TEST.odt"</span>, SaveFormat.Odt);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List <span class="title">ListSetting</span>(<span class="params">Document doc, <span class="keyword">int</span> index</span>)</span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">var</span> list = doc.Lists[index];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</div><div class="line">		list.ListLevels[i].TrailingCharacter = ListTrailingCharacter.Nothing;</div><div class="line"></div><div class="line">	list.ListLevels[<span class="number">0</span>].NumberFormat = <span class="string">"\x0000、"</span>;</div><div class="line">	list.ListLevels[<span class="number">0</span>].NumberPosition = <span class="number">16</span>;</div><div class="line">	list.ListLevels[<span class="number">0</span>].TextPosition = <span class="number">16</span> + <span class="number">16</span> + <span class="number">16</span>;</div><div class="line">	list.ListLevels[<span class="number">0</span>].NumberStyle = NumberStyle.TradChinNum3;</div><div class="line"></div><div class="line">	list.ListLevels[<span class="number">1</span>].NumberPosition = <span class="number">38</span>;</div><div class="line">	list.ListLevels[<span class="number">1</span>].TextPosition = <span class="number">38</span> + <span class="number">16</span> + <span class="number">12</span>;</div><div class="line">	list.ListLevels[<span class="number">1</span>].NumberFormat = <span class="string">"(\x0001)"</span>;</div><div class="line">	list.ListLevels[<span class="number">1</span>].NumberStyle = NumberStyle.TradChinNum3;</div><div class="line">	<span class="keyword">return</span> list;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="結果-doc-檔是正常的-一、-，但是-odt-檔，透過-OpenOffice-Writer-看起來卻變成了阿拉伯數用-1-，如下圖，"><a href="#結果-doc-檔是正常的-一、-，但是-odt-檔，透過-OpenOffice-Writer-看起來卻變成了阿拉伯數用-1-，如下圖，" class="headerlink" title="結果 doc 檔是正常的 一、 ，但是 odt 檔，透過 OpenOffice Writer 看起來卻變成了阿拉伯數用 1 ，如下圖，"></a>結果 doc 檔是正常的 一、 ，但是 odt 檔，透過 OpenOffice Writer 看起來卻變成了阿拉伯數用 1 ，如下圖，</h3><img src="/2017/10/03/20171003/NumberStyleTradChinNum3.png" alt="NumberStyle.TradChinNum3" title="NumberStyle.TradChinNum3">
<h3 id="詢問原廠回覆是說那個行為是正常的，因為透過-MS-Word-另存成-odt-檔後，再用-OpenOffice-Writer-去開，就是會變成這樣子。-嗯-不過我們的客戶就是要國字的-一、二、-…-呀"><a href="#詢問原廠回覆是說那個行為是正常的，因為透過-MS-Word-另存成-odt-檔後，再用-OpenOffice-Writer-去開，就是會變成這樣子。-嗯-不過我們的客戶就是要國字的-一、二、-…-呀" class="headerlink" title="詢問原廠回覆是說那個行為是正常的，因為透過 MS Word 另存成 odt 檔後，再用 OpenOffice Writer 去開，就是會變成這樣子。 嗯~~~ 不過我們的客戶就是要國字的 一、二、 … 呀!"></a>詢問原廠回覆是說那個行為是正常的，因為透過 MS Word 另存成 odt 檔後，再用 OpenOffice Writer 去開，就是會變成這樣子。 嗯~~~ 不過我們的客戶就是要國字的 一、二、 … 呀!</h3><h3 id="不過原廠也很幫忙，有找出讓-ODT-檔也可以一併呈現，就是不要用-Taiwan-的-NumberStyle-，改用-Japanese-的-NumberStyle-KanjiDigit-就可以是我們要的效果。詳細可以參考List-labels-display-not-the-same-in-MS-Word-and-Open-Office-Writer上面的討論。"><a href="#不過原廠也很幫忙，有找出讓-ODT-檔也可以一併呈現，就是不要用-Taiwan-的-NumberStyle-，改用-Japanese-的-NumberStyle-KanjiDigit-就可以是我們要的效果。詳細可以參考List-labels-display-not-the-same-in-MS-Word-and-Open-Office-Writer上面的討論。" class="headerlink" title="不過原廠也很幫忙，有找出讓 ODT 檔也可以一併呈現，就是不要用 Taiwan 的 NumberStyle ，改用 Japanese 的 NumberStyle.KanjiDigit 就可以是我們要的效果。詳細可以參考List labels display not the same in MS Word and Open Office Writer上面的討論。"></a>不過原廠也很幫忙，有找出讓 ODT 檔也可以一併呈現，就是不要用 Taiwan 的 NumberStyle ，改用 Japanese 的 NumberStyle.KanjiDigit 就可以是我們要的效果。詳細可以參考<a href="https://forum.aspose.com/t/list-labels-display-not-the-same-in-ms-word-and-open-office-writer/8905/15" target="_blank" rel="external">List labels display not the same in MS Word and Open Office Writer</a>上面的討論。</h3><h3 id="NumberStyle-在-doc-docx-及-odt-上呈現有些許的不同，使用上需要注意一下哦-最後的測試程式如下，"><a href="#NumberStyle-在-doc-docx-及-odt-上呈現有些許的不同，使用上需要注意一下哦-最後的測試程式如下，" class="headerlink" title="NumberStyle 在 doc, docx 及 odt 上呈現有些許的不同，使用上需要注意一下哦! 最後的測試程式如下，"></a>NumberStyle 在 doc, docx 及 odt 上呈現有些許的不同，使用上需要注意一下哦! 最後的測試程式如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">NumberStyleTest</span>(<span class="params"></span>)</span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">var</span> doc = <span class="keyword">new</span> Document();</div><div class="line">	doc.Styles.DefaultParagraphFormat.Style.Font.NameFarEast = <span class="string">"標楷體"</span>;</div><div class="line">	doc.Styles.DefaultParagraphFormat.Style.Font.NameAscii = <span class="string">"Times New Roman"</span>;</div><div class="line">	doc.Styles.DefaultParagraphFormat.Style.Font.Size = <span class="number">16</span>D;</div><div class="line">	<span class="keyword">var</span> builder = <span class="keyword">new</span> DocumentBuilder(doc);</div><div class="line"></div><div class="line">	doc.Lists.Add(ListTemplate.NumberDefault);</div><div class="line">	builder.ListFormat.List = ListSetting(doc, <span class="number">0</span>);</div><div class="line"></div><div class="line">	builder.Font.Size = <span class="number">16</span>D;</div><div class="line">	builder.Font.Color = Color.Black;</div><div class="line">	builder.ParagraphFormat.LineSpacingRule = LineSpacingRule.Multiple;</div><div class="line">	builder.ParagraphFormat.LineSpacing = <span class="number">13.8</span>;</div><div class="line">	builder.ParagraphFormat.Alignment = ParagraphAlignment.Justify;</div><div class="line">	builder.ListFormat.ListLevelNumber = <span class="number">0</span>;</div><div class="line">	builder.Writeln(<span class="string">"測試一"</span>);</div><div class="line">	builder.ListFormat.ListLevelNumber = <span class="number">1</span>;</div><div class="line">	builder.Writeln(<span class="string">"測試二"</span>);</div><div class="line">	builder.ParagraphFormat.ClearFormatting();</div><div class="line">	builder.ListFormat.RemoveNumbers();</div><div class="line">	builder.Writeln();</div><div class="line"></div><div class="line">	doc.Save(<span class="string">"TEST.doc"</span>, SaveFormat.Doc);</div><div class="line">	doc.Save(<span class="string">"TEST.odt"</span>, SaveFormat.Odt);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List <span class="title">ListSetting</span>(<span class="params">Document doc, <span class="keyword">int</span> index</span>)</span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">var</span> list = doc.Lists[index];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</div><div class="line">		list.ListLevels[i].TrailingCharacter = ListTrailingCharacter.Nothing;</div><div class="line"></div><div class="line">	list.ListLevels[<span class="number">0</span>].NumberFormat = <span class="string">"\x0000、"</span>;</div><div class="line">	list.ListLevels[<span class="number">0</span>].NumberPosition = <span class="number">16</span>;</div><div class="line">	list.ListLevels[<span class="number">0</span>].TextPosition = <span class="number">16</span> + <span class="number">16</span> + <span class="number">16</span>;</div><div class="line">	list.ListLevels[<span class="number">0</span>].NumberStyle = NumberStyle.KanjiDigit;</div><div class="line"></div><div class="line">	list.ListLevels[<span class="number">1</span>].NumberPosition = <span class="number">38</span>;</div><div class="line">	list.ListLevels[<span class="number">1</span>].TextPosition = <span class="number">38</span> + <span class="number">16</span> + <span class="number">12</span>;</div><div class="line">	list.ListLevels[<span class="number">1</span>].NumberFormat = <span class="string">"(\x0001)"</span>;</div><div class="line">	list.ListLevels[<span class="number">1</span>].NumberStyle = NumberStyle.KanjiDigit;</div><div class="line">	<span class="keyword">return</span> list;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<img src="/2017/10/03/20171003/NumberStyleKanjiDigit.png" alt="NumberStyle.KanjiDigit" title="NumberStyle.KanjiDigit">
<h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><h3 id="List-labels-display-not-the-same-in-MS-Word-and-Open-Office-Writer"><a href="#List-labels-display-not-the-same-in-MS-Word-and-Open-Office-Writer" class="headerlink" title="List labels display not the same in MS Word and Open Office Writer"></a><a href="https://forum.aspose.com/t/list-labels-display-not-the-same-in-ms-word-and-open-office-writer/8905/15" target="_blank" rel="external">List labels display not the same in MS Word and Open Office Writer</a></h3><h3 id="MultiLevel-list-in-Asopse-Document"><a href="#MultiLevel-list-in-Asopse-Document" class="headerlink" title="MultiLevel list in Asopse Document"></a><a href="https://stackoverflow.com/questions/24989982/multilevel-list-in-asopse-document" target="_blank" rel="external">MultiLevel list in Asopse Document</a></h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/03/20171003/" data-id="cja22rtke0007109j29l3wr4z" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NumberStyle/">NumberStyle</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TradChinNum3/">TradChinNum3</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aspose-words/">aspose.words</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/utf-8-B/">=?utf-8?B?</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/號/">?號</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Aspose-Words/">Aspose.Words</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Attachments/">Attachments</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CompatibilityOptions/">CompatibilityOptions</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Composite/">Composite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Deployment-Target/">Deployment Target</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DetermineCurSizeRollBackups/">DetermineCurSizeRollBackups</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DocumentBuilder/">DocumentBuilder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Export-Options-property-list/">Export Options property list</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GrowAutofit/">GrowAutofit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/How-to-get-value-to-variable-using-execute-in-t-sql/">How to get value to variable using 'execute' in t-sql?</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/InitializeFromOneFile/">InitializeFromOneFile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/InitializeRollBackups/">InitializeRollBackups</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/InsertHtml/">InsertHtml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MailMessage/">MailMessage</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Microsoft-Jet-OLEDB-4-0/">Microsoft.Jet.OLEDB.4.0</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MinimumOSVersion/">MinimumOSVersion</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MtouchArch/">MtouchArch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Multiple/">Multiple</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NumberStyle/">NumberStyle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PDF/">PDF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RollingFileAppender/">RollingFileAppender</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SMTPClient/">SMTPClient</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL-License/">SQL License</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL援權/">SQL援權</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Subject/">Subject</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TradChinNum3/">TradChinNum3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unexpected-error-from-external-database-driver-1/">Unexpected error from external database driver (1)</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine/">Unexpected error from external database driver (1). (Microsoft JET Database Engine)</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Xcode-9/">Xcode 9</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aspose-words/">aspose.words</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/com-apple-CoreSimulator-SimDeviceType-undefined/">com.apple.CoreSimulator.SimDeviceType.undefined</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cordova/">cordova</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deadlock/">deadlock</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exchangeEvent/">exchangeEvent</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exec/">exec</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exec-in-t-sql/">exec in t-sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/execute/">execute</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exportArchive/">exportArchive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exportOptionsPlist/">exportOptionsPlist</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ibtoolerror/">ibtoolerror</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios/">ios</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios-11/">ios 11</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios11/">ios11</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kb4041676/">kb4041676</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kb4041678/">kb4041678</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kb4041681/">kb4041681</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kb4041691/">kb4041691</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log4net/">log4net</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/provisioningProfiles/">provisioningProfiles</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xCode-9/">xCode 9</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xamarin/">xamarin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xcodebuild/">xcodebuild</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/交換事件/">交換事件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/外部数据库驱动程序中-1-的意外错误/">外部数据库驱动程序中(1)的意外错误</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/從外部資料庫驅動程式產生的非預期的錯誤-1/">從外部資料庫驅動程式產生的非預期的錯誤 (1)</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/utf-8-B/" style="font-size: 10px;">=?utf-8?B?</a> <a href="/tags/號/" style="font-size: 10px;">?號</a> <a href="/tags/Aspose-Words/" style="font-size: 10px;">Aspose.Words</a> <a href="/tags/Attachments/" style="font-size: 10px;">Attachments</a> <a href="/tags/CompatibilityOptions/" style="font-size: 10px;">CompatibilityOptions</a> <a href="/tags/Composite/" style="font-size: 10px;">Composite</a> <a href="/tags/Deployment-Target/" style="font-size: 10px;">Deployment Target</a> <a href="/tags/DetermineCurSizeRollBackups/" style="font-size: 10px;">DetermineCurSizeRollBackups</a> <a href="/tags/DocumentBuilder/" style="font-size: 10px;">DocumentBuilder</a> <a href="/tags/Export-Options-property-list/" style="font-size: 10px;">Export Options property list</a> <a href="/tags/GrowAutofit/" style="font-size: 10px;">GrowAutofit</a> <a href="/tags/How-to-get-value-to-variable-using-execute-in-t-sql/" style="font-size: 10px;">How to get value to variable using 'execute' in t-sql?</a> <a href="/tags/InitializeFromOneFile/" style="font-size: 10px;">InitializeFromOneFile</a> <a href="/tags/InitializeRollBackups/" style="font-size: 10px;">InitializeRollBackups</a> <a href="/tags/InsertHtml/" style="font-size: 10px;">InsertHtml</a> <a href="/tags/MailMessage/" style="font-size: 10px;">MailMessage</a> <a href="/tags/Microsoft-Jet-OLEDB-4-0/" style="font-size: 10px;">Microsoft.Jet.OLEDB.4.0</a> <a href="/tags/MinimumOSVersion/" style="font-size: 10px;">MinimumOSVersion</a> <a href="/tags/MtouchArch/" style="font-size: 10px;">MtouchArch</a> <a href="/tags/Multiple/" style="font-size: 10px;">Multiple</a> <a href="/tags/NumberStyle/" style="font-size: 10px;">NumberStyle</a> <a href="/tags/PDF/" style="font-size: 10px;">PDF</a> <a href="/tags/RollingFileAppender/" style="font-size: 10px;">RollingFileAppender</a> <a href="/tags/SMTPClient/" style="font-size: 10px;">SMTPClient</a> <a href="/tags/SQL/" style="font-size: 10px;">SQL</a> <a href="/tags/SQL-License/" style="font-size: 10px;">SQL License</a> <a href="/tags/SQL援權/" style="font-size: 10px;">SQL援權</a> <a href="/tags/Subject/" style="font-size: 10px;">Subject</a> <a href="/tags/TradChinNum3/" style="font-size: 10px;">TradChinNum3</a> <a href="/tags/Unexpected-error-from-external-database-driver-1/" style="font-size: 10px;">Unexpected error from external database driver (1)</a> <a href="/tags/Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine/" style="font-size: 10px;">Unexpected error from external database driver (1). (Microsoft JET Database Engine)</a> <a href="/tags/Xcode-9/" style="font-size: 10px;">Xcode 9</a> <a href="/tags/aspose-words/" style="font-size: 10px;">aspose.words</a> <a href="/tags/com-apple-CoreSimulator-SimDeviceType-undefined/" style="font-size: 10px;">com.apple.CoreSimulator.SimDeviceType.undefined</a> <a href="/tags/cordova/" style="font-size: 10px;">cordova</a> <a href="/tags/deadlock/" style="font-size: 10px;">deadlock</a> <a href="/tags/exchangeEvent/" style="font-size: 10px;">exchangeEvent</a> <a href="/tags/exec/" style="font-size: 10px;">exec</a> <a href="/tags/exec-in-t-sql/" style="font-size: 10px;">exec in t-sql</a> <a href="/tags/execute/" style="font-size: 10px;">execute</a> <a href="/tags/exportArchive/" style="font-size: 10px;">exportArchive</a> <a href="/tags/exportOptionsPlist/" style="font-size: 10px;">exportOptionsPlist</a> <a href="/tags/ibtoolerror/" style="font-size: 10px;">ibtoolerror</a> <a href="/tags/ios/" style="font-size: 20px;">ios</a> <a href="/tags/ios-11/" style="font-size: 10px;">ios 11</a> <a href="/tags/ios11/" style="font-size: 10px;">ios11</a> <a href="/tags/kb4041676/" style="font-size: 10px;">kb4041676</a> <a href="/tags/kb4041678/" style="font-size: 10px;">kb4041678</a> <a href="/tags/kb4041681/" style="font-size: 10px;">kb4041681</a> <a href="/tags/kb4041691/" style="font-size: 10px;">kb4041691</a> <a href="/tags/log4net/" style="font-size: 10px;">log4net</a> <a href="/tags/provisioningProfiles/" style="font-size: 10px;">provisioningProfiles</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/xCode-9/" style="font-size: 10px;">xCode 9</a> <a href="/tags/xamarin/" style="font-size: 10px;">xamarin</a> <a href="/tags/xcodebuild/" style="font-size: 10px;">xcodebuild</a> <a href="/tags/交換事件/" style="font-size: 10px;">交換事件</a> <a href="/tags/外部数据库驱动程序中-1-的意外错误/" style="font-size: 10px;">外部数据库驱动程序中(1)的意外错误</a> <a href="/tags/從外部資料庫驅動程式產生的非預期的錯誤-1/" style="font-size: 10px;">從外部資料庫驅動程式產生的非預期的錯誤 (1)</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Arkiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Siste innlegg</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/11/16/2017012/">解析 SQL Server Deadlocks</a>
          </li>
        
          <li>
            <a href="/2017/11/09/2017011/">Aspose.Words DocumentBuilder 加入 htmlTable 轉成 PDF 檔問題</a>
          </li>
        
          <li>
            <a href="/2017/10/27/2017010/">log4net 檔名使用「大寫」字母造成檔案被覆寫問題</a>
          </li>
        
          <li>
            <a href="/2017/10/27/20171027/">透過 SmtpClient 寄送 Mail 時，主旨在 Zimbra 會有 ? 的狀況</a>
          </li>
        
          <li>
            <a href="/2017/10/17/20171017-2/">Compiling IB documents for earlier than iOS 7 is no longer supported.</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Rainmaker<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>