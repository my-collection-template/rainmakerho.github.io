<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>亂馬客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="技術、架構只有最適合的方案">
<meta property="og:type" content="website">
<meta property="og:title" content="亂馬客">
<meta property="og:url" content="https://rainmakerho.github.io/index.html">
<meta property="og:site_name" content="亂馬客">
<meta property="og:description" content="技術、架構只有最適合的方案">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="亂馬客">
<meta name="twitter:description" content="技術、架構只有最適合的方案">
  
    <link rel="alternate" href="/atom.xml" title="亂馬客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">亂馬客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">技術得來速</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Søk"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://rainmakerho.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-2017015" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/07/2017015/" class="article-date">
  <time datetime="2017-12-07T09:30:04.000Z" itemprop="datePublished">2017-12-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/07/2017015/">為什麼 OPTIONS 時會給 404 呢?</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="同事在-CALL-IIS-上的網頁時，因為-CORS-所以會先做-Preflight-request，跑-OPTIONS-時，居然回-404-。"><a href="#同事在-CALL-IIS-上的網頁時，因為-CORS-所以會先做-Preflight-request，跑-OPTIONS-時，居然回-404-。" class="headerlink" title="同事在 CALL IIS 上的網頁時，因為 CORS 所以會先做 Preflight request，跑 OPTIONS 時，居然回 404 。"></a>同事在 CALL IIS 上的網頁時，因為 CORS 所以會先做 <a href="https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request" target="_blank" rel="external">Preflight request</a>，跑 OPTIONS 時，居然回 404 。</h4><h4 id="在-web-config-中有允許-OPTIONS-呀-而且在-web-config-中設定的-header-也有-response-出來。-但-status-code-卻是-404-。"><a href="#在-web-config-中有允許-OPTIONS-呀-而且在-web-config-中設定的-header-也有-response-出來。-但-status-code-卻是-404-。" class="headerlink" title="在 web.config 中有允許 OPTIONS 呀 ~ 而且在 web.config 中設定的 header 也有 response 出來。 但 status code 卻是 404 。"></a>在 web.config 中有允許 OPTIONS 呀 ~ 而且在 web.config 中設定的 header 也有 response 出來。 但 status code 卻是 404 。</h4><h4 id="後來到-IIS-一看才知道，在-IIS-的「要求篩選」那裡，-OPTIONS-被設定成了-不允許，如下圖，"><a href="#後來到-IIS-一看才知道，在-IIS-的「要求篩選」那裡，-OPTIONS-被設定成了-不允許，如下圖，" class="headerlink" title="後來到 IIS 一看才知道，在 IIS 的「要求篩選」那裡， OPTIONS 被設定成了 不允許，如下圖，"></a>後來到 IIS 一看才知道，在 IIS 的「要求篩選」那裡， OPTIONS 被設定成了 不允許，如下圖，</h4><p><br><br><img src="/2017/12/07/2017015/REQFILTER.png" alt="要求篩選" title="要求篩選"><br><br></p>
<h4 id="後來將它移除後，就可以了哦"><a href="#後來將它移除後，就可以了哦" class="headerlink" title="後來將它移除後，就可以了哦 ~"></a>後來將它移除後，就可以了哦 ~</h4><h4 id="大家如果有類似的問題，可以檢查一下-IIS-的「要求篩選」設定哦"><a href="#大家如果有類似的問題，可以檢查一下-IIS-的「要求篩選」設定哦" class="headerlink" title="大家如果有類似的問題，可以檢查一下 IIS 的「要求篩選」設定哦 !"></a>大家如果有類似的問題，可以檢查一下 IIS 的「要求篩選」設定哦 !</h4>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/12/07/2017015/" data-id="cjawajb2z000aqk9jb3gqw9jt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/404/">404</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IIS/">IIS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OPTIONS/">OPTIONS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/要求篩選/">要求篩選</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017014" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/30/2017014/" class="article-date">
  <time datetime="2017-11-30T09:49:38.000Z" itemprop="datePublished">2017-11-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/30/2017014/">Writeable Session 造成網頁被卡住的問題</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="在之前有討論到不同網頁使用到-Writeable-Session-時會卡來卡去的狀況-Lock-or-Blocking-使用Session要小心網頁會被-卡住哦-，或是-Web-Service-如果開啟-Session-存取的話，預設是-Writeable-Session-模式-設定-WebService-使用-ReadOnly-Session-。"><a href="#在之前有討論到不同網頁使用到-Writeable-Session-時會卡來卡去的狀況-Lock-or-Blocking-使用Session要小心網頁會被-卡住哦-，或是-Web-Service-如果開啟-Session-存取的話，預設是-Writeable-Session-模式-設定-WebService-使用-ReadOnly-Session-。" class="headerlink" title="在之前有討論到不同網頁使用到 Writeable Session 時會卡來卡去的狀況 Lock or Blocking( 使用Session要小心網頁會被 卡住哦! )，或是 Web Service 如果開啟 Session 存取的話，預設是 Writeable Session 模式(設定 WebService 使用 ReadOnly Session)。"></a>在之前有討論到不同網頁使用到 Writeable Session 時會卡來卡去的狀況 Lock or Blocking( <a href="https://dotblogs.com.tw/rainmaker/2016/06/30/103719" target="_blank" rel="external">使用Session要小心網頁會被 卡住哦!</a> )，或是 Web Service 如果開啟 Session 存取的話，預設是 Writeable Session 模式(<a href="https://dotblogs.com.tw/rainmaker/2015/02/10/149456" target="_blank" rel="external">設定 WebService 使用 ReadOnly Session</a>)。</h4><h4 id="解法除了設定-SessionStateBehavior-ReadOnly-外，如果一定要用-Writeable-Session-時-怕改成-ReadOnly-會影響現有系統的話-，可以參考When-a-Single-ASP-NET-Client-makes-Concurrent-Requests-for-Writeable-Session-Variables提供的方式，因為在寫入-Session-時會造成-500ms-的-Delay-時間-請參考-Storing-Anything-in-ASP-NET-Session-Causes-500ms-Delays-，"><a href="#解法除了設定-SessionStateBehavior-ReadOnly-外，如果一定要用-Writeable-Session-時-怕改成-ReadOnly-會影響現有系統的話-，可以參考When-a-Single-ASP-NET-Client-makes-Concurrent-Requests-for-Writeable-Session-Variables提供的方式，因為在寫入-Session-時會造成-500ms-的-Delay-時間-請參考-Storing-Anything-in-ASP-NET-Session-Causes-500ms-Delays-，" class="headerlink" title="解法除了設定 SessionStateBehavior.ReadOnly 外，如果一定要用 Writeable Session 時(怕改成 ReadOnly 會影響現有系統的話)，可以參考When a Single ASP.NET Client makes Concurrent Requests for Writeable Session Variables提供的方式，因為在寫入  Session 時會造成 500ms 的 Delay 時間(請參考:Storing Anything in ASP.NET Session Causes 500ms Delays)，"></a>解法除了設定 SessionStateBehavior.ReadOnly 外，如果一定要用 Writeable Session 時(怕改成 ReadOnly 會影響現有系統的話)，可以參考<a href="https://www.red-gate.com/simple-talk/dotnet/asp-net/single-asp-net-client-makes-concurrent-requests-writeable-session-variables/" target="_blank" rel="external">When a Single ASP.NET Client makes Concurrent Requests for Writeable Session Variables</a>提供的方式，因為在寫入  Session 時會造成 500ms 的 Delay 時間(請參考:<a href="https://stackoverflow.com/questions/8349033/storing-anything-in-asp-net-session-causes-500ms-delays" target="_blank" rel="external">Storing Anything in ASP.NET Session Causes 500ms Delays</a>)，</h4><ul>
<li><h4 id="降低-Session-Lock-Check-的時間"><a href="#降低-Session-Lock-Check-的時間" class="headerlink" title="降低 Session Lock Check 的時間"></a>降低 Session Lock Check 的時間</h4><h4 id="可以在-Global-asax-cs-的-Application-Start-Method-去設定預設值，-Polling-Interval-從-500ms-改成-30ms-Polling-Delta-從-250ms-改成-15ms-，如下，"><a href="#可以在-Global-asax-cs-的-Application-Start-Method-去設定預設值，-Polling-Interval-從-500ms-改成-30ms-Polling-Delta-從-250ms-改成-15ms-，如下，" class="headerlink" title="可以在 Global.asax.cs 的 Application_Start Method 去設定預設值， Polling Interval 從 500ms 改成 30ms, Polling Delta 從 250ms 改成 15ms ，如下，"></a>可以在 Global.asax.cs 的 Application_Start Method 去設定預設值， Polling Interval 從 500ms 改成 30ms, Polling Delta 從 250ms 改成 15ms ，如下，</h4>  <figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Application_Start</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">var</span> sessionStateModuleType = <span class="keyword">typeof</span>(SessionStateModule);</div><div class="line">    <span class="keyword">var</span> pollingIntervalFieldInfo = sessionStateModuleType.GetField(<span class="string">"LOCKED_ITEM_POLLING_INTERVAL"</span>, BindingFlags.NonPublic | BindingFlags.Static);</div><div class="line">    <span class="keyword">var</span> orgpollingInterval = pollingIntervalFieldInfo.GetValue(<span class="literal">null</span>);</div><div class="line">    pollingIntervalFieldInfo.SetValue(<span class="literal">null</span>, <span class="number">30</span>); <span class="comment">// default 500ms</span></div><div class="line">    <span class="keyword">var</span> pollingDeltaFieldInfo = sessionStateModuleType.GetField(<span class="string">"LOCKED_ITEM_POLLING_DELTA"</span>, BindingFlags.NonPublic | BindingFlags.Static);</div><div class="line">    <span class="keyword">var</span> orgPollingDelta = pollingDeltaFieldInfo.GetValue(<span class="literal">null</span>);</div><div class="line">    pollingDeltaFieldInfo.SetValue(<span class="literal">null</span>, TimeSpan.FromMilliseconds(<span class="number">15.0</span>)); <span class="comment">// default 250ms</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<img src="/2017/11/30/2017014/application_start.png" alt="在Application Start 事件中更改預設值" title="在Application Start 事件中更改預設值">  
<p><br><br><img src="/2017/11/30/2017014/beginRequest.png" alt="可以在 Request 時發現，預設值已經被更改了" title="可以在 Request 時發現，預設值已經被更改了"><br><br></p>
<ul>
<li><h4 id="實作-Lockless-SessionStateStoreProvider"><a href="#實作-Lockless-SessionStateStoreProvider" class="headerlink" title="實作 Lockless SessionStateStoreProvider"></a>實作 Lockless SessionStateStoreProvider</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LocklessInProcSessionStateStore</span> : <span class="title">SessionStateStoreProviderBase</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">private</span> SessionStateStoreProviderBase _store;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Initialize</span>(<span class="params"><span class="keyword">string</span> name, NameValueCollection config</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">base</span>.Initialize(name, config);</div><div class="line"></div><div class="line">        <span class="keyword">var</span> storeType = <span class="keyword">typeof</span>(SessionStateStoreProviderBase).Assembly.GetType(<span class="string">"System.Web.SessionState.InProcSessionStateStore"</span>);</div><div class="line">        _store = (SessionStateStoreProviderBase)Activator.CreateInstance(storeType);</div><div class="line">        _store.Initialize(name, config);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Dispose</span>(<span class="params"></span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        _store.Dispose();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">bool</span> <span class="title">SetItemExpireCallback</span>(<span class="params">SessionStateItemExpireCallback expireCallback</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">return</span> _store.SetItemExpireCallback(expireCallback);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">InitializeRequest</span>(<span class="params">HttpContext context</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        _store.InitializeRequest(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> SessionStateStoreData <span class="title">GetItem</span>(<span class="params">HttpContext context, <span class="keyword">string</span> id, <span class="keyword">out</span> <span class="keyword">bool</span> locked, <span class="keyword">out</span> TimeSpan lockAge, <span class="keyword">out</span> <span class="keyword">object</span> lockId,</span></span></div><div class="line"><span class="function"><span class="params">        <span class="keyword">out</span> SessionStateActions actions</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">var</span> returnValue = _store.GetItem(context, id, <span class="keyword">out</span> locked, <span class="keyword">out</span> lockAge, <span class="keyword">out</span> lockId, <span class="keyword">out</span> actions);</div><div class="line">        <span class="keyword">if</span> (returnValue == <span class="literal">null</span> &amp;&amp; lockId != <span class="literal">null</span>)</div><div class="line">        &#123;</div><div class="line">            _store.ReleaseItemExclusive(context, id, lockId);</div><div class="line">            returnValue = _store.GetItem(context, id, <span class="keyword">out</span> locked, <span class="keyword">out</span> lockAge, <span class="keyword">out</span> lockId, <span class="keyword">out</span> actions);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> returnValue;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> SessionStateStoreData <span class="title">GetItemExclusive</span>(<span class="params">HttpContext context, <span class="keyword">string</span> id, <span class="keyword">out</span> <span class="keyword">bool</span> locked, <span class="keyword">out</span> TimeSpan lockAge,</span></span></div><div class="line"><span class="function"><span class="params">        <span class="keyword">out</span> <span class="keyword">object</span> lockId, <span class="keyword">out</span> SessionStateActions actions</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">var</span> returnValue = _store.GetItemExclusive(context, id, <span class="keyword">out</span> locked, <span class="keyword">out</span> lockAge, <span class="keyword">out</span> lockId, <span class="keyword">out</span> actions);</div><div class="line">        <span class="keyword">if</span> (returnValue == <span class="literal">null</span> &amp;&amp; lockId != <span class="literal">null</span>)</div><div class="line">        &#123;</div><div class="line">            _store.ReleaseItemExclusive(context, id, lockId);</div><div class="line">            returnValue = _store.GetItemExclusive(context, id, <span class="keyword">out</span> locked, <span class="keyword">out</span> lockAge, <span class="keyword">out</span> lockId, <span class="keyword">out</span> actions);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> returnValue;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">ReleaseItemExclusive</span>(<span class="params">HttpContext context, <span class="keyword">string</span> id, <span class="keyword">object</span> lockId</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        _store.ReleaseItemExclusive(context, id, lockId);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">SetAndReleaseItemExclusive</span>(<span class="params">HttpContext context, <span class="keyword">string</span> id, SessionStateStoreData item, <span class="keyword">object</span> lockId, <span class="keyword">bool</span> newItem</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        _store.SetAndReleaseItemExclusive(context, id, item, lockId, newItem);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">RemoveItem</span>(<span class="params">HttpContext context, <span class="keyword">string</span> id, <span class="keyword">object</span> lockId, SessionStateStoreData item</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        _store.RemoveItem(context, id, lockId, item);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">ResetItemTimeout</span>(<span class="params">HttpContext context, <span class="keyword">string</span> id</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        _store.ResetItemTimeout(context, id);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> SessionStateStoreData <span class="title">CreateNewStoreData</span>(<span class="params">HttpContext context, <span class="keyword">int</span> timeout</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">return</span> _store.CreateNewStoreData(context, timeout);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">CreateUninitializedItem</span>(<span class="params">HttpContext context, <span class="keyword">string</span> id, <span class="keyword">int</span> timeout</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        _store.CreateUninitializedItem(context, id, timeout);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">EndRequest</span>(<span class="params">HttpContext context</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        _store.EndRequest(context);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="在-web-config-中加入設定自定的-SessionState，如下，"><a href="#在-web-config-中加入設定自定的-SessionState，如下，" class="headerlink" title="在 web.config 中加入設定自定的 SessionState，如下，"></a>在 web.config 中加入設定自定的 SessionState，如下，</h4>  <figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">sessionState</span> <span class="attr">mode</span>=<span class="string">"Custom"</span> <span class="attr">customProvider</span>=<span class="string">"LocklessInProcSessionStateStore"</span> <span class="attr">cookieless</span>=<span class="string">"false"</span> <span class="attr">timeout</span>=<span class="string">"1"</span> &gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">providers</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">"LocklessInProcSessionStateStore"</span> </span></div><div class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">"你專案的namespace.LocklessInProcSessionStateStore"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">providers</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">sessionState</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/11/30/2017014/" data-id="cjawajb2r0005qk9jqy6ds9i5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Concurrent/">Concurrent</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/EnableSessionState/">EnableSessionState</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Session/">Session</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SessionStateStoreProvider/">SessionStateStoreProvider</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017013" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/29/2017013/" class="article-date">
  <time datetime="2017-11-29T01:33:20.000Z" itemprop="datePublished">2017-11-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/29/2017013/">為什麼 scrollbar 在 mac os 的 browser 無法顯示出來呢?</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="最近在-div-上加入-overflow-y-scroll-height-250px-讓-div-高度超過-250px-時就呈現-scrollbar-。-在-Windows-的機器上測試顯示都正常。"><a href="#最近在-div-上加入-overflow-y-scroll-height-250px-讓-div-高度超過-250px-時就呈現-scrollbar-。-在-Windows-的機器上測試顯示都正常。" class="headerlink" title="最近在 div 上加入 overflow-y: scroll; height:250px; 讓 div 高度超過 250px 時就呈現 scrollbar 。 在 Windows 的機器上測試顯示都正常。"></a>最近在 div 上加入 <em>overflow-y: scroll; height:250px;</em> 讓 div 高度超過 250px 時就呈現 scrollbar 。 在 Windows 的機器上測試顯示都正常。</h4><h4 id="但是在-mac-上測試，-scrollbar-卻沒有呈現出來。"><a href="#但是在-mac-上測試，-scrollbar-卻沒有呈現出來。" class="headerlink" title="但是在 mac 上測試， scrollbar 卻沒有呈現出來。"></a>但是在 mac 上測試， scrollbar 卻沒有呈現出來。</h4><h4 id="後來有查到-Force-the-scrollbar-back-這些的說明，我們需要針對-webkit-scrollbar-來設定它，所以在-css-中需要再加入以下的設定，來讓-scrollbar-在-mac-的瀏覽器可以正常呈現-scrollbar-哦"><a href="#後來有查到-Force-the-scrollbar-back-這些的說明，我們需要針對-webkit-scrollbar-來設定它，所以在-css-中需要再加入以下的設定，來讓-scrollbar-在-mac-的瀏覽器可以正常呈現-scrollbar-哦" class="headerlink" title="後來有查到 Force the scrollbar back 這些的說明，我們需要針對 -webkit-scrollbar 來設定它，所以在 css 中需要再加入以下的設定，來讓 scrollbar 在 mac 的瀏覽器可以正常呈現 scrollbar 哦!"></a>後來有查到 <a href="http://simurai.com/blog/2011/07/26/webkit-scrollbar" target="_blank" rel="external">Force the scrollbar back</a> 這些的說明，我們需要針對 -webkit-scrollbar 來設定它，所以在 css 中需要再加入以下的設定，來讓 scrollbar 在 mac 的瀏覽器可以正常呈現 scrollbar 哦!</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-pseudo">::-webkit-scrollbar</span> &#123;</div><div class="line">    <span class="attribute">-webkit-appearance</span>: none;</div><div class="line">    <span class="attribute">width</span>: <span class="number">7px</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-pseudo">::-webkit-scrollbar-thumb</span> &#123;</div><div class="line">    <span class="attribute">border-radius</span>: <span class="number">4px</span>;</div><div class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(0,0,0,.5);</div><div class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">rgba</span>(255,255,255,.5);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><a href="http://jsfiddle.net/simurai/UsvLN/" target="_blank" rel="external">測試網頁</a> </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/11/29/2017013/" data-id="cjawajb2e0001qk9j0kps98m2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mac/">mac</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scrollbar/">scrollbar</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017012" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/16/2017012/" class="article-date">
  <time datetime="2017-11-16T01:57:34.000Z" itemprop="datePublished">2017-11-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/16/2017012/">解析 SQL Server Deadlocks</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="最近收到了-Deadlock-的-trace-file，如下圖，"><a href="#最近收到了-Deadlock-的-trace-file，如下圖，" class="headerlink" title="最近收到了 Deadlock 的 trace file，如下圖，"></a>最近收到了 Deadlock 的 trace file，如下圖，</h4><img src="/2017/11/16/2017012/001.png" alt="Deadlock graph" title="Deadlock graph">
<h4 id="如果直接看圖示資訊不夠清楚的話，可以將那個-trc-檔用-Notepad-來開，用-xml-方式檢視，就可以看到更多詳細的資料，如下圖，"><a href="#如果直接看圖示資訊不夠清楚的話，可以將那個-trc-檔用-Notepad-來開，用-xml-方式檢視，就可以看到更多詳細的資料，如下圖，" class="headerlink" title="如果直接看圖示資訊不夠清楚的話，可以將那個 trc 檔用 Notepad++ 來開，用 xml 方式檢視，就可以看到更多詳細的資料，如下圖，"></a>如果直接看圖示資訊不夠清楚的話，可以將那個 trc 檔用 Notepad++ 來開，用 xml 方式檢視，就可以看到更多詳細的資料，如下圖，</h4><img src="/2017/11/16/2017012/002.png" alt="View in Notepad++" title="View in Notepad++">
<h4 id="當然如果這樣資訊又太雜的話，那還有一個方式，就是在那個-Deadlock-graph-那列上面按右鍵，選取「擷取事件資料-X-」將它另存成-xdl-檔，然後用-「SQL-Sentry-Plan-Explorer」-來檢視，如下圖，"><a href="#當然如果這樣資訊又太雜的話，那還有一個方式，就是在那個-Deadlock-graph-那列上面按右鍵，選取「擷取事件資料-X-」將它另存成-xdl-檔，然後用-「SQL-Sentry-Plan-Explorer」-來檢視，如下圖，" class="headerlink" title="當然如果這樣資訊又太雜的話，那還有一個方式，就是在那個 Deadlock graph 那列上面按右鍵，選取「擷取事件資料(X)」將它另存成 .xdl 檔，然後用 「SQL Sentry Plan Explorer」 來檢視，如下圖，"></a>當然如果這樣資訊又太雜的話，那還有一個方式，就是在那個 Deadlock graph 那列上面按右鍵，選取「擷取事件資料(X)」將它另存成 .xdl 檔，然後用 「<a href="http://www.sentryone.com/plan-explorer" target="_blank" rel="external">SQL Sentry Plan Explorer</a>」 來檢視，如下圖，</h4><img src="/2017/11/16/2017012/003.png" alt="saveAs XDL file" title="saveAs XDL file">
<img src="/2017/11/16/2017012/004.png" alt="View in [SQL Sentry Plan Explorer]" title="View in [SQL Sentry Plan Explorer]">
<h3 id="案例分享"><a href="#案例分享" class="headerlink" title="案例分享"></a>案例分享</h3><ul>
<li><h4 id="Reader-Writer-Deadlocks"><a href="#Reader-Writer-Deadlocks" class="headerlink" title="Reader-Writer Deadlocks"></a>Reader-Writer Deadlocks</h4><h4 id="當可以看到詳細資料後，就要來開始解析看看是什麼原因造成的，以上面那個例子來說，一個是-update-，另一個是-select-，而-Isolation-Level-是-repeatable-read-。是典型的-Reader-Writer-Deadlocks-，解法如下，"><a href="#當可以看到詳細資料後，就要來開始解析看看是什麼原因造成的，以上面那個例子來說，一個是-update-，另一個是-select-，而-Isolation-Level-是-repeatable-read-。是典型的-Reader-Writer-Deadlocks-，解法如下，" class="headerlink" title="當可以看到詳細資料後，就要來開始解析看看是什麼原因造成的，以上面那個例子來說，一個是 update ，另一個是 select ，而 Isolation Level 是 repeatable read 。是典型的 Reader-Writer Deadlocks ，解法如下，"></a>當可以看到詳細資料後，就要來開始解析看看是什麼原因造成的，以上面那個例子來說，一個是 update ，另一個是 select ，而 Isolation Level 是 repeatable read 。是典型的 Reader-Writer Deadlocks ，解法如下，</h4></li>
</ul>
<ul>
<li>SELECT 語句不要包在交易之中。</li>
<li>檢查 SELECT 語句是否有用到合適的 INDEX (使用 SEEK, 而非 SCAN)，如果已用 SEEK 了，就嘗試下面的解法。</li>
<li>使用 row-version based isolation level，例如 READ COMMITTED SNAPSHOT 或是 SNAPSHOT。</li>
<li>SELECT 語句使用 NOLOCK。</li>
</ul>
<ul>
<li><h4 id="Writer-Writer-Deadlocks"><a href="#Writer-Writer-Deadlocks" class="headerlink" title="Writer-Writer Deadlocks"></a>Writer-Writer Deadlocks</h4><img src="/2017/11/16/2017012/005.png" alt="Writer-Writer Deadlock" title="Writer-Writer Deadlock">
<h4 id="從上圖來看都是針對同一個-Page-想要做-Update-而造成的-Deadlock，另外會有一個比較奇怪的就是「交換事件-exchangeEvent-」，是因為平行處理的原因，可能是沒用到適合的-index，所以才會讓-SQL-使用平行處理。"><a href="#從上圖來看都是針對同一個-Page-想要做-Update-而造成的-Deadlock，另外會有一個比較奇怪的就是「交換事件-exchangeEvent-」，是因為平行處理的原因，可能是沒用到適合的-index，所以才會讓-SQL-使用平行處理。" class="headerlink" title="從上圖來看都是針對同一個 Page 想要做 Update 而造成的 Deadlock，另外會有一個比較奇怪的就是「交換事件(exchangeEvent)」，是因為平行處理的原因，可能是沒用到適合的 index，所以才會讓 SQL 使用平行處理。"></a>從上圖來看都是針對同一個 Page 想要做 Update 而造成的 Deadlock，另外會有一個比較奇怪的就是「交換事件(exchangeEvent)」，是因為平行處理的原因，可能是沒用到適合的 index，所以才會讓 SQL 使用平行處理。</h4></li>
</ul>
<img src="/2017/11/16/2017012/006.png" alt="View in [SQL Sentry Plan Explorer]" title="View in [SQL Sentry Plan Explorer]">
<h4 id="從上圖可以發現，使用相同的-Store-Procedure-，而-Lock-在-Delete-，可以判斷那個-Delete-應該是沒有使用到適合的-index-，所以在-Delete-時，會使用-Scan-的方式去找到要刪除的那一些資料，如下的執行計畫，"><a href="#從上圖可以發現，使用相同的-Store-Procedure-，而-Lock-在-Delete-，可以判斷那個-Delete-應該是沒有使用到適合的-index-，所以在-Delete-時，會使用-Scan-的方式去找到要刪除的那一些資料，如下的執行計畫，" class="headerlink" title="從上圖可以發現，使用相同的 Store Procedure ，而 Lock 在 Delete ，可以判斷那個 Delete 應該是沒有使用到適合的 index ，所以在 Delete 時，會使用 Scan 的方式去找到要刪除的那一些資料，如下的執行計畫，"></a>從上圖可以發現，使用相同的 Store Procedure ，而 Lock 在 Delete ，可以判斷那個 Delete 應該是沒有使用到適合的 index ，所以在 Delete 時，會使用 Scan 的方式去找到要刪除的那一些資料，如下的執行計畫，</h4><img src="/2017/11/16/2017012/007.png" alt="Delete的執行計畫" title="Delete的執行計畫">
<h4 id="可以發現，它是真的是使用-SCAN-的方式。解法如下，"><a href="#可以發現，它是真的是使用-SCAN-的方式。解法如下，" class="headerlink" title="可以發現，它是真的是使用 SCAN 的方式。解法如下，"></a>可以發現，它是真的是使用 SCAN 的方式。解法如下，</h4><ul>
<li>建立適合的 index ，例如，<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> NONCLUSTERED <span class="keyword">INDEX</span> NIDX_SRB_QNTSCORE_DATA_CASEID <span class="keyword">ON</span> dbo.SRB_QNTSCORE_DATA(CASEID);</div></pre></td></tr></table></figure>
</li>
</ul>
<img src="/2017/11/16/2017012/008.png" alt="建立過index的執行計畫" title="建立過index的執行計畫">
<h3 id="其他解決方式"><a href="#其他解決方式" class="headerlink" title="其他解決方式"></a>其他解決方式</h3><h4 id="除了上述的-Case-的解法外，有其他的解法，"><a href="#除了上述的-Case-的解法外，有其他的解法，" class="headerlink" title="除了上述的 Case 的解法外，有其他的解法，"></a>除了上述的 Case 的解法外，有其他的解法，</h4><ul>
<li>更新資料表的順序<br>  針對 Tables 修改的順序也是要注意，例如 sp1 是更新 tblA 及 tblB ，另一個 sp2 則是先更新 tblB 再更新 tblA ，這樣子的順序交叉，就很容易造成 Deadlock。 所以在 更新的順序上也是要考量到哦!</li>
<li>Create Indexes with Included Columns<br>  有一些 Key Lookup deadlock 就是因為在 Update 某 Table 時，除了更新了 Clustered Index 後，還需要再更新 Non Clustered Index，而另一個 Select 除了透過 Non Clustered Index 找到資料後，還需要到 Lookup 到 Clustered Index 取得資料。這樣子就有可能會互相 Lock 到而造成 Deadlock，這種狀況可以加入 Included Columns 來解決。</li>
<li>MAXDOP<br>  有些光 SELECT 時，就會發生 Deadlock ，是因為平行處理造成的，解法就是調整 SQL 。如果還會有 Deadlock 的話，就設定 MAXDOP 看看能不能解決。</li>
</ul>
<h3 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h3><h4 id="SQL-Server-Deadlocks-by-Example"><a href="#SQL-Server-Deadlocks-by-Example" class="headerlink" title="SQL Server Deadlocks by Example"></a><a href="https://www.red-gate.com/simple-talk/sql/performance/sql-server-deadlocks-by-example/" target="_blank" rel="external">SQL Server Deadlocks by Example</a></h4>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/11/16/2017012/" data-id="cjawajb2k0003qk9jqtsujy0z" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/deadlock/">deadlock</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exchangeEvent/">exchangeEvent</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/交換事件/">交換事件</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017011" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/09/2017011/" class="article-date">
  <time datetime="2017-11-09T05:31:28.000Z" itemprop="datePublished">2017-11-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/09/2017011/">Aspose.Words DocumentBuilder 加入 htmlTable 轉成 PDF 檔問題</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="最近同事透過-Aspose-Words-DocumentBuilder-的-InsertHtml-Method-加入-Html-的-Table-含-css-，另存成-PDF-檔後，居然發現本來在-Word-檔中看起來好好的，PDF檔中的-Table-卻會超過頁面，如下，"><a href="#最近同事透過-Aspose-Words-DocumentBuilder-的-InsertHtml-Method-加入-Html-的-Table-含-css-，另存成-PDF-檔後，居然發現本來在-Word-檔中看起來好好的，PDF檔中的-Table-卻會超過頁面，如下，" class="headerlink" title="最近同事透過 Aspose.Words DocumentBuilder 的 InsertHtml Method 加入 Html 的 Table (含 css )，另存成 PDF 檔後，居然發現本來在 Word 檔中看起來好好的，PDF檔中的 Table 卻會超過頁面，如下，"></a>最近同事透過 Aspose.Words DocumentBuilder 的 InsertHtml Method 加入 Html 的 Table (含 css )，另存成 PDF 檔後，居然發現本來在 Word 檔中看起來好好的，PDF檔中的 Table 卻會超過頁面，如下，</h3><img src="/2017/11/09/2017011/exceedPage.png" alt="exceedPage.png" title="">
<h3 id="測試程式如下，"><a href="#測試程式如下，" class="headerlink" title="測試程式如下，"></a>測試程式如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> htmlTable = <span class="string">@"&lt;style&gt;</span></div><div class="line"><span class="string">.table &#123;</span></div><div class="line"><span class="string">	width: auto; </span></div><div class="line"><span class="string">	table-layout:fixed;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">.table, .table tr &#123;</span></div><div class="line"><span class="string">	height: 40px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">.table, .table td &#123;</span></div><div class="line"><span class="string">	border-collapse: collapse;</span></div><div class="line"><span class="string">	border: 1px solid #000000;</span></div><div class="line"><span class="string">	padding:2px 5px 2px 5px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">&lt;/style&gt;</span></div><div class="line"><span class="string">&lt;table class='table' style='width: 100%;'&gt;</span></div><div class="line"><span class="string">&lt;colgroup&gt;</span></div><div class="line"><span class="string">	&lt;col style='width: 15%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width: 35%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width: 15%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width: 35%;'&gt;</span></div><div class="line"><span class="string">&lt;/colgroup&gt;</span></div><div class="line"><span class="string">&lt;tbody&gt;</span></div><div class="line"><span class="string">	&lt;tr&gt;</span></div><div class="line"><span class="string">		&lt;td&gt;TITLE1：&lt;/td&gt;</span></div><div class="line"><span class="string">		&lt;td&gt;&lt;/td&gt;</span></div><div class="line"><span class="string">		&lt;td&gt;TITLE2：&lt;/td&gt;</span></div><div class="line"><span class="string">		&lt;td&gt;106/10/14 22:26&lt;/td&gt;</span></div><div class="line"><span class="string">	&lt;/tr&gt;</span></div><div class="line"><span class="string">	&lt;tr&gt;</span></div><div class="line"><span class="string">		&lt;td&gt;TITLE3：&lt;/td&gt;</span></div><div class="line"><span class="string">		&lt;td colspan='3'&gt;測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試測試&lt;/td&gt;</span></div><div class="line"><span class="string">	&lt;/tr&gt;</span></div><div class="line"><span class="string">&lt;/tbody&gt;</span></div><div class="line"><span class="string">&lt;/table&gt;"</span>;</div><div class="line"><span class="keyword">var</span> doc = <span class="keyword">new</span> Document();</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameFarEast = <span class="string">"標楷體"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameAscii = <span class="string">"Times New Roman"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.Size = <span class="number">16</span>D;</div><div class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> DocumentBuilder(doc);</div><div class="line">builder.InsertHtml(htmlTable, <span class="literal">true</span>);</div><div class="line">doc.Save(<span class="string">"TEST.doc"</span>, SaveFormat.Doc);</div><div class="line">doc.Save(<span class="string">"TEST.pdf"</span>, SaveFormat.Pdf);</div></pre></td></tr></table></figure>
<h3 id="原廠的回覆設定-CompatibilityOptions-GrowAutofit-選項為-false-就可以了，如下，"><a href="#原廠的回覆設定-CompatibilityOptions-GrowAutofit-選項為-false-就可以了，如下，" class="headerlink" title="原廠的回覆設定 CompatibilityOptions.GrowAutofit 選項為 false 就可以了，如下，"></a>原廠的回覆設定 CompatibilityOptions.GrowAutofit 選項為 false 就可以了，如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> doc = <span class="keyword">new</span> Document();</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameFarEast = <span class="string">"標楷體"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameAscii = <span class="string">"Times New Roman"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.Size = <span class="number">16</span>D;</div><div class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> DocumentBuilder(doc);</div><div class="line">builder.InsertHtml(htmlTable, <span class="literal">true</span>);</div><div class="line">doc.Save(<span class="string">"TEST.doc"</span>, SaveFormat.Doc);</div><div class="line">doc.CompatibilityOptions.GrowAutofit = <span class="literal">false</span>;</div><div class="line">doc.Save(<span class="string">"TEST.pdf"</span>, SaveFormat.Pdf);</div></pre></td></tr></table></figure>
<h3 id="果然設定-Document-的-CompatibilityOptions-GrowAutofit-為-false-，-PDF-中的-table-就不會超過頁面了，詳細可以參考DocumentBuilder-InsertHtml-Save-as-pdf-will-exceed-page。"><a href="#果然設定-Document-的-CompatibilityOptions-GrowAutofit-為-false-，-PDF-中的-table-就不會超過頁面了，詳細可以參考DocumentBuilder-InsertHtml-Save-as-pdf-will-exceed-page。" class="headerlink" title="果然設定 Document 的 CompatibilityOptions.GrowAutofit 為 false ， PDF 中的 table 就不會超過頁面了，詳細可以參考DocumentBuilder InsertHtml Save as pdf will exceed page。"></a>果然設定 Document 的 CompatibilityOptions.GrowAutofit 為 false ， PDF 中的 table 就不會超過頁面了，詳細可以參考<a href="https://forum.aspose.com/t/documentbuilder-inserthtml-save-as-pdf-will-exceed-page/165825" target="_blank" rel="external">DocumentBuilder InsertHtml Save as pdf will exceed page</a>。</h3><h3 id="後來同事用巢狀的-html-table-去試，這次變成不同TD的內容會疉在一起，如下，"><a href="#後來同事用巢狀的-html-table-去試，這次變成不同TD的內容會疉在一起，如下，" class="headerlink" title="後來同事用巢狀的 html table 去試，這次變成不同TD的內容會疉在一起，如下，"></a>後來同事用巢狀的 html table 去試，這次變成不同TD的內容會疉在一起，如下，</h3><img src="/2017/11/09/2017011/002.png" alt="002.png" title="">
<h3 id="測試的-html-table-如下，"><a href="#測試的-html-table-如下，" class="headerlink" title="測試的 html table 如下，"></a>測試的 html table 如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> htmlTable2 = <span class="string">@"&lt;style&gt;</span></div><div class="line"><span class="string">div[data-speed-id=seal-box] &#123;</span></div><div class="line"><span class="string">	margin-top: 20px;</span></div><div class="line"><span class="string">	margin-left: 0px;</span></div><div class="line"><span class="string">	margin-right: 0px;</span></div><div class="line"><span class="string">	margin-bottom: 0px;</span></div><div class="line"><span class="string">	height: 20px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">td[data-speed-sealouid] &#123;</span></div><div class="line"><span class="string">	width: 60px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id='seal-table'] &#123;</span></div><div class="line"><span class="string">	border: 1px solid red !important;</span></div><div class="line"><span class="string">	color: red !important;</span></div><div class="line"><span class="string">	border-collapse: initial;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id=seal-table] td &#123;</span></div><div class="line"><span class="string">	padding: 0px !important;</span></div><div class="line"><span class="string">	margin: 0px !important;</span></div><div class="line"><span class="string">	border: 0px;</span></div><div class="line"><span class="string">	border-collapse: collapse;</span></div><div class="line"><span class="string">	border-spacing: 0px !important;</span></div><div class="line"><span class="string">	vertical-align: middle !important;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">&lt;/style&gt;</span></div><div class="line"><span class="string">&lt;div style='color: blue;'&gt;下面是原本職章結構直接輸出，&lt;/div&gt;</span></div><div class="line"><span class="string">&lt;table&gt;</span></div><div class="line"><span class="string">&lt;colgroup&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:35%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:65%;'&gt;</span></div><div class="line"><span class="string">&lt;/colgroup&gt;</span></div><div class="line"><span class="string">&lt;tbody&gt;</span></div><div class="line"><span class="string">&lt;tr&gt;</span></div><div class="line"><span class="string">	&lt;td&gt;</span></div><div class="line"><span class="string">		&lt;div style='margin-top: 10px;' data-speed-id='seal-box'&gt;</span></div><div class="line"><span class="string">			&lt;table&gt;</span></div><div class="line"><span class="string">				&lt;tbody&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td&gt;</span></div><div class="line"><span class="string">						&lt;table data-speed-id='seal-table'&gt;</span></div><div class="line"><span class="string">							&lt;tbody&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;' data-speed-sealouid='10110'&gt;文化資源司&lt;/td&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 16px;' rowspan='2'&gt;亂馬客&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;'&gt;科員&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;/tbody&gt;</span></div><div class="line"><span class="string">						&lt;/table&gt;</span></div><div class="line"><span class="string">					&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td style='text-align: center; font-size: 12px;'&gt;106/10/18 10:36&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;/tbody&gt;</span></div><div class="line"><span class="string">			&lt;/table&gt;</span></div><div class="line"><span class="string">		&lt;/div&gt;</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">	&lt;td style='padding-left: 70px;'&gt;</span></div><div class="line"><span class="string">		案係亂馬客測試文化局將於本(105)年10月29日召開「106亂馬客測試社區營造平台工作小組第九十次會議」，本部為列席單位，擬視業務狀況再行派員，當否?請核示。文陳閱後存查。</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">&lt;/tr&gt;</span></div><div class="line"><span class="string">&lt;/tbody&gt;</span></div><div class="line"><span class="string">&lt;/table&gt;"</span>;</div></pre></td></tr></table></figure>
<h3 id="原廠建議可以改-TD-的-LeftPadding-來解這問題，詳細可以參考DocumentBuilder-InsertHtml-nested-table-Save-as-pdf-some-TD-will-disapper，不要使用-UpdateTableLayout-哦"><a href="#原廠建議可以改-TD-的-LeftPadding-來解這問題，詳細可以參考DocumentBuilder-InsertHtml-nested-table-Save-as-pdf-some-TD-will-disapper，不要使用-UpdateTableLayout-哦" class="headerlink" title="原廠建議可以改 TD 的 LeftPadding 來解這問題，詳細可以參考DocumentBuilder InsertHtml (nested table) Save as pdf , some TD will disapper，不要使用 UpdateTableLayout 哦!"></a>原廠建議可以改 TD 的 LeftPadding 來解這問題，詳細可以參考<a href="https://forum.aspose.com/t/documentbuilder-inserthtml-nested-table-save-as-pdf-some-td-will-disapper/166107" target="_blank" rel="external">DocumentBuilder InsertHtml (nested table) Save as pdf , some TD will disapper</a>，不要使用 UpdateTableLayout 哦!</h3><h3 id="所以我在-TD-中加入-style-’padding-left-70px-’-來看，右邊的-TD-內容果然往右移了，但左邊的那個職章-Table-卻還是小小的，如下，"><a href="#所以我在-TD-中加入-style-’padding-left-70px-’-來看，右邊的-TD-內容果然往右移了，但左邊的那個職章-Table-卻還是小小的，如下，" class="headerlink" title="所以我在 TD 中加入 style=’padding-left: 70px;’ 來看，右邊的 TD 內容果然往右移了，但左邊的那個職章 Table 卻還是小小的，如下，"></a>所以我在 TD 中加入 style=’padding-left: 70px;’ 來看，右邊的 TD 內容果然往右移了，但左邊的那個職章 Table 卻還是小小的，如下，</h3><img src="/2017/11/09/2017011/003.png" alt="003.png" title="">
<h3 id="測試的-Html-如下，"><a href="#測試的-Html-如下，" class="headerlink" title="測試的 Html 如下，"></a>測試的 Html 如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> htmlTable3 = <span class="string">@"&lt;style&gt;</span></div><div class="line"><span class="string">div[data-speed-id=seal-box] &#123;</span></div><div class="line"><span class="string">	margin-top: 20px;</span></div><div class="line"><span class="string">	margin-left: 0px;</span></div><div class="line"><span class="string">	margin-right: 0px;</span></div><div class="line"><span class="string">	margin-bottom: 0px;</span></div><div class="line"><span class="string">	height: 20px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">td[data-speed-sealouid] &#123;</span></div><div class="line"><span class="string">	width: 60px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id='seal-table'] &#123;</span></div><div class="line"><span class="string">	border: 1px solid red !important;</span></div><div class="line"><span class="string">	color: red !important;</span></div><div class="line"><span class="string">	border-collapse: initial;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id=seal-table] td &#123;</span></div><div class="line"><span class="string">	padding: 0px !important;</span></div><div class="line"><span class="string">	margin: 0px !important;</span></div><div class="line"><span class="string">	border: 0px;</span></div><div class="line"><span class="string">	border-collapse: collapse;</span></div><div class="line"><span class="string">	border-spacing: 0px !important;</span></div><div class="line"><span class="string">	vertical-align: middle !important;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">&lt;/style&gt;</span></div><div class="line"><span class="string">&lt;div style='color: blue;'&gt;下面是原本職章結構直接輸出，&lt;/div&gt;</span></div><div class="line"><span class="string">&lt;table&gt;</span></div><div class="line"><span class="string">&lt;colgroup&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:35%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:65%;'&gt;</span></div><div class="line"><span class="string">&lt;/colgroup&gt;</span></div><div class="line"><span class="string">&lt;tbody&gt;</span></div><div class="line"><span class="string">&lt;tr&gt;</span></div><div class="line"><span class="string">	&lt;td&gt;</span></div><div class="line"><span class="string">		&lt;div style='margin-top: 10px;' data-speed-id='seal-box'&gt;</span></div><div class="line"><span class="string">			&lt;table&gt;</span></div><div class="line"><span class="string">				&lt;tbody&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td&gt;</span></div><div class="line"><span class="string">						&lt;table data-speed-id='seal-table'&gt;</span></div><div class="line"><span class="string">							&lt;tbody&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;' data-speed-sealouid='10110'&gt;文化資源司&lt;/td&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 16px;' rowspan='2'&gt;亂馬客&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;'&gt;科員&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;/tbody&gt;</span></div><div class="line"><span class="string">						&lt;/table&gt;</span></div><div class="line"><span class="string">					&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td style='text-align: center; font-size: 12px;'&gt;106/10/18 10:36&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;/tbody&gt;</span></div><div class="line"><span class="string">			&lt;/table&gt;</span></div><div class="line"><span class="string">		&lt;/div&gt;</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">	&lt;td style='padding-left: 70px;'&gt;</span></div><div class="line"><span class="string">		案係亂馬客測試文化局將於本(105)年10月29日召開「106亂馬客測試社區營造平台工作小組第九十次會議」，本部為列席單位，擬視業務狀況再行派員，當否?請核示。文陳閱後存查。</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">&lt;/tr&gt;</span></div><div class="line"><span class="string">&lt;/tbody&gt;</span></div><div class="line"><span class="string">&lt;/table&gt;"</span>;</div></pre></td></tr></table></figure>
<h3 id="那只好在職章的那個-Table-中設定固定的寬度，最後PDF的結果如下，"><a href="#那只好在職章的那個-Table-中設定固定的寬度，最後PDF的結果如下，" class="headerlink" title="那只好在職章的那個 Table 中設定固定的寬度，最後PDF的結果如下，"></a>那只好在職章的那個 Table 中設定固定的寬度，最後PDF的結果如下，</h3><img src="/2017/11/09/2017011/004.png" alt="004.png" title="">
<h3 id="最後的測試程式如下，"><a href="#最後的測試程式如下，" class="headerlink" title="最後的測試程式如下，"></a>最後的測試程式如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> htmlTable4 = <span class="string">@"&lt;style&gt;</span></div><div class="line"><span class="string">div[data-speed-id=seal-box] &#123;</span></div><div class="line"><span class="string">	margin-top: 20px;</span></div><div class="line"><span class="string">	margin-left: 0px;</span></div><div class="line"><span class="string">	margin-right: 0px;</span></div><div class="line"><span class="string">	margin-bottom: 0px;</span></div><div class="line"><span class="string">	height: 20px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">td[data-speed-sealouid] &#123;</span></div><div class="line"><span class="string">	width: 60px;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id='seal-table'] &#123;</span></div><div class="line"><span class="string">	border: 1px solid red !important;</span></div><div class="line"><span class="string">	color: red !important;</span></div><div class="line"><span class="string">	border-collapse: initial;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">table[data-speed-id=seal-table] td &#123;</span></div><div class="line"><span class="string">	padding: 0px !important;</span></div><div class="line"><span class="string">	margin: 0px !important;</span></div><div class="line"><span class="string">	border: 0px;</span></div><div class="line"><span class="string">	border-collapse: collapse;</span></div><div class="line"><span class="string">	border-spacing: 0px !important;</span></div><div class="line"><span class="string">	vertical-align: middle !important;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">&lt;/style&gt;</span></div><div class="line"><span class="string">&lt;div style='color: blue;'&gt;下面是原本職章結構直接輸出，&lt;/div&gt;</span></div><div class="line"><span class="string">&lt;table&gt;</span></div><div class="line"><span class="string">&lt;colgroup&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:35%;'&gt;</span></div><div class="line"><span class="string">	&lt;col style='width:65%;'&gt;</span></div><div class="line"><span class="string">&lt;/colgroup&gt;</span></div><div class="line"><span class="string">&lt;tbody&gt;</span></div><div class="line"><span class="string">&lt;tr&gt;</span></div><div class="line"><span class="string">	&lt;td&gt;</span></div><div class="line"><span class="string">		&lt;div style='margin-top: 10px;' data-speed-id='seal-box'&gt;</span></div><div class="line"><span class="string">			&lt;table width='120px'&gt;</span></div><div class="line"><span class="string">				&lt;tbody&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td&gt;</span></div><div class="line"><span class="string">						&lt;table data-speed-id='seal-table' &gt;</span></div><div class="line"><span class="string">							&lt;tbody&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;' data-speed-sealouid='10110'&gt;文化資源司&lt;/td&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 16px;' rowspan='2'&gt;亂馬客&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;tr&gt;</span></div><div class="line"><span class="string">								&lt;td style='font-size: 10px;'&gt;科員&lt;/td&gt;</span></div><div class="line"><span class="string">							&lt;/tr&gt;</span></div><div class="line"><span class="string">							&lt;/tbody&gt;</span></div><div class="line"><span class="string">						&lt;/table&gt;</span></div><div class="line"><span class="string">					&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;tr&gt;</span></div><div class="line"><span class="string">					&lt;td style='text-align: center; font-size: 12px;'&gt;106/10/18 10:36&lt;/td&gt;</span></div><div class="line"><span class="string">				&lt;/tr&gt;</span></div><div class="line"><span class="string">				&lt;/tbody&gt;</span></div><div class="line"><span class="string">			&lt;/table&gt;</span></div><div class="line"><span class="string">		&lt;/div&gt;</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">	&lt;td style='padding-left: 90px;'&gt;</span></div><div class="line"><span class="string">		案係亂馬客測試文化局將於本(105)年10月29日召開「106亂馬客測試社區營造平台工作小組第九十次會議」，本部為列席單位，擬視業務狀況再行派員，當否?請核示。文陳閱後存查。</span></div><div class="line"><span class="string">	&lt;/td&gt;</span></div><div class="line"><span class="string">&lt;/tr&gt;</span></div><div class="line"><span class="string">&lt;/tbody&gt;</span></div><div class="line"><span class="string">&lt;/table&gt;"</span>;</div><div class="line"><span class="keyword">var</span> doc = <span class="keyword">new</span> Document();</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameFarEast = <span class="string">"標楷體"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.NameAscii = <span class="string">"Times New Roman"</span>;</div><div class="line">doc.Styles.DefaultParagraphFormat.Style.Font.Size = <span class="number">16</span>D;</div><div class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> DocumentBuilder(doc);</div><div class="line">builder.InsertHtml(htmlTable4, <span class="literal">true</span>);</div><div class="line">doc.CompatibilityOptions.GrowAutofit = <span class="literal">false</span>;</div><div class="line">doc.Save(<span class="string">"TEST.pdf"</span>, SaveFormat.Pdf);</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/11/09/2017011/" data-id="cjawajb2n0004qk9jp66znp40" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Aspose-Words/">Aspose.Words</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CompatibilityOptions/">CompatibilityOptions</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DocumentBuilder/">DocumentBuilder</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GrowAutofit/">GrowAutofit</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/InsertHtml/">InsertHtml</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PDF/">PDF</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017010" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/27/2017010/" class="article-date">
  <time datetime="2017-10-27T05:28:10.000Z" itemprop="datePublished">2017-10-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/27/2017010/">log4net 檔名使用「大寫」字母造成檔案被覆寫問題</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="事情是這樣子的…我們有個專案裡面有使用-log4net-v-1-2-11-0-，在案子裡面是使用-RollingFileAppender-，-rollingStyle-是-Composite-，依日期時間及檔案大小來切檔，設定檔如下，"><a href="#事情是這樣子的…我們有個專案裡面有使用-log4net-v-1-2-11-0-，在案子裡面是使用-RollingFileAppender-，-rollingStyle-是-Composite-，依日期時間及檔案大小來切檔，設定檔如下，" class="headerlink" title="事情是這樣子的…我們有個專案裡面有使用 log4net v 1.2.11.0 ，在案子裡面是使用 RollingFileAppender ， rollingStyle 是 Composite ，依日期時間及檔案大小來切檔，設定檔如下，"></a>事情是這樣子的…我們有個專案裡面有使用 log4net v 1.2.11.0 ，在案子裡面是使用 RollingFileAppender ， rollingStyle 是 Composite ，依日期時間及檔案大小來切檔，設定檔如下，</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line">&lt;log4net debug=&quot;true&quot;&gt;</div><div class="line">	&lt;appender name=&quot;DBRollingFileAppender&quot; type=&quot;log4net.Appender.RollingFileAppender&quot;&gt;</div><div class="line">	  &lt;file type=&quot;log4net.Util.PatternString&quot; value=&quot;[你的路徑]\temp\%date&#123;yyyy&#125;\%date&#123;MM&#125;\%date&#123;dd&#125;\&quot; /&gt;</div><div class="line">	  &lt;staticLogFileName value=&quot;false&quot;/&gt;</div><div class="line">	  &lt;appendToFile value=&quot;true&quot;/&gt;</div><div class="line">	  &lt;!--設定檔案分割依據Date和Size--&gt;</div><div class="line">	  &lt;rollingStyle value=&quot;Composite&quot;/&gt;</div><div class="line">	  &lt;!--設定每個檔案的大小--&gt;</div><div class="line">	  &lt;MaximumFileSize value=&quot;250KB&quot; /&gt;</div><div class="line">	  &lt;!--設定分割檔案的最大數量--&gt;</div><div class="line">	  &lt;maxSizeRollBackups value=&quot;2000&quot; /&gt;</div><div class="line">	  &lt;CountDirection value=&quot;1&quot; /&gt;</div><div class="line">	  &lt;!--log檔案的命名--&gt;</div><div class="line">	  &lt;datePattern value=&quot;yyyy-MM-dd-HH-DB2.lo\g&quot;/&gt;</div><div class="line">	  &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;</div><div class="line">		&lt;conversionPattern value=&quot;[%date] [%-5level] From %logger%newline  %file:%line [%property&#123;NDC&#125;]%newline  %message%newline%newline&quot; /&gt;</div><div class="line">	  &lt;/layout&gt;</div><div class="line">	  &lt;filter type=&quot;log4net.Filter.LevelRangeFilter&quot;&gt;</div><div class="line">		&lt;param name=&quot;LevelMin&quot; value=&quot;INFO&quot;/&gt;</div><div class="line">		&lt;param name=&quot;LevelMax&quot; value=&quot;INFO&quot;/&gt;</div><div class="line">	  &lt;/filter&gt;</div><div class="line">	&lt;/appender&gt;</div><div class="line">	&lt;appender name=&quot;SystemRollingFileAppender&quot; type=&quot;log4net.Appender.RollingFileAppender&quot;&gt;</div><div class="line">	  &lt;!--存放log檔案的路徑(%property&#123;LogPath&#125;屬性請勿任意修改)--&gt;</div><div class="line">	  &lt;file type=&quot;log4net.Util.PatternString&quot; value=&quot;[你的路徑]\temp\%date&#123;yyyy&#125;\%date&#123;MM&#125;\%date&#123;dd&#125;\&quot; /&gt;</div><div class="line">	  &lt;staticLogFileName value=&quot;false&quot;/&gt;</div><div class="line">	  &lt;appendToFile value=&quot;true&quot;/&gt;</div><div class="line">	  &lt;!--設定檔案分割依據Date和Size--&gt;</div><div class="line">	  &lt;rollingStyle value=&quot;Composite&quot;/&gt;</div><div class="line">	  &lt;!--設定每個檔案的大小--&gt;</div><div class="line">	  &lt;MaximumFileSize value=&quot;20KB&quot; /&gt;</div><div class="line">	  &lt;!--設定分割檔案的最大數量--&gt;</div><div class="line">	  &lt;maxSizeRollBackups value=&quot;2000&quot; /&gt;</div><div class="line">	  &lt;lockingModel type=&quot;log4net.Appender.FileAppender+MinimalLock&quot; /&gt;</div><div class="line">	  &lt;CountDirection value=&quot;1&quot; /&gt;</div><div class="line">	  &lt;!--log檔案的命名--&gt;</div><div class="line">	  &lt;datePattern value=&quot;yyyy-MM-dd-HH-DB.lo\g&quot;/&gt;</div><div class="line">	  &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;</div><div class="line">		&lt;conversionPattern value=&quot;%d&#123;yyyy-MM-dd HH:mm&#125; %level %logger %ndc - %message%newline&quot; /&gt;</div><div class="line">	  &lt;/layout&gt;</div><div class="line">	  &lt;filter type=&quot;log4net.Filter.LevelRangeFilter&quot;&gt;</div><div class="line">		&lt;param name=&quot;LevelMin&quot; value=&quot;DEBUG&quot;/&gt;</div><div class="line">		&lt;param name=&quot;LevelMax&quot; value=&quot;DEBUG&quot;/&gt;</div><div class="line">	  &lt;/filter&gt;</div><div class="line">	&lt;/appender&gt;</div><div class="line">	&lt;!--紀錄錯誤訊息--&gt;</div><div class="line">	&lt;appender name=&quot;ErrorRollingFileAppender&quot; type=&quot;log4net.Appender.RollingFileAppender&quot;&gt;</div><div class="line">	  &lt;!--存放log檔案的路徑--&gt;</div><div class="line">	  &lt;file type=&quot;log4net.Util.PatternString&quot; value=&quot;[你的路徑]\temp\%date&#123;yyyy&#125;\%date&#123;MM&#125;\%date&#123;dd&#125;\&quot; /&gt;</div><div class="line">	  &lt;staticLogFileName value=&quot;false&quot;/&gt;</div><div class="line">	  &lt;appendToFile value=&quot;true&quot;/&gt;</div><div class="line">	  &lt;!--設定檔案分割依據Date和Size--&gt;</div><div class="line">	  &lt;rollingStyle value=&quot;Composite&quot;/&gt;</div><div class="line">	  &lt;!--設定每個檔案的大小--&gt;</div><div class="line">	  &lt;MaximumFileSize value=&quot;250KB&quot; /&gt;</div><div class="line">	  &lt;!--設定分割檔案的最大數量--&gt;</div><div class="line">	  &lt;maxSizeRollBackups value=&quot;2000&quot; /&gt;</div><div class="line">	  &lt;!--log檔案的命名--&gt;</div><div class="line">	  &lt;datePattern value=&quot;yyyy-MM-dd-HH-DB3.lo\g&quot;/&gt;</div><div class="line">	  &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;</div><div class="line">		&lt;conversionPattern value=&quot;[%date] [%-5level] From %logger%newline  %file:%line [%property&#123;NDC&#125;]%newline  %message%newline%newline&quot; /&gt;</div><div class="line">	  &lt;/layout&gt;</div><div class="line">	  &lt;filter type=&quot;log4net.Filter.LevelRangeFilter&quot;&gt;</div><div class="line">		&lt;param name=&quot;LevelMin&quot; value=&quot;WARN&quot;/&gt;</div><div class="line">	  &lt;/filter&gt;</div><div class="line">	&lt;/appender&gt;</div><div class="line">	&lt;root&gt;</div><div class="line">	  &lt;level value=&quot;ALL&quot;/&gt;</div><div class="line">	  &lt;appender-ref ref=&quot;DBRollingFileAppender&quot;/&gt;</div><div class="line">	  &lt;appender-ref ref=&quot;SystemRollingFileAppender&quot;/&gt;</div><div class="line">	  &lt;appender-ref ref=&quot;ErrorRollingFileAppender&quot;/&gt;</div><div class="line">	&lt;/root&gt;</div><div class="line">&lt;/log4net&gt;</div></pre></td></tr></table></figure>
<h3 id="這樣子的設定-log4net-會在-temp-目錄再依-年、月、日-建立目錄，然後產生-0-1-…的檔案如下圖，"><a href="#這樣子的設定-log4net-會在-temp-目錄再依-年、月、日-建立目錄，然後產生-0-1-…的檔案如下圖，" class="headerlink" title="這樣子的設定 log4net 會在 temp 目錄再依 年、月、日 建立目錄，然後產生 .0, .1 …的檔案如下圖，"></a>這樣子的設定 log4net 會在 temp 目錄再依 年、月、日 建立目錄，然後產生 .0, .1 …的檔案如下圖，</h3><img src="/2017/10/27/2017010/001.png" alt="001.png" title="">
<h3 id="這樣子的-log-在測試機都正常運作，唯獨在正式機卻會發生第1個檔案-0-的-log-檔有正常產生，但-1-的檔案卻一直被重覆的寫，導致要看-log-都常常看不到-SystemRollingFileAppender-。雖然-maxSizeRollBackups-設定了-2000-，但使終都只有-2-個檔案。-在我的-Local-測試也都沒什麼問題，用測試程式看它的-m-curSizeRollBackups-屬性也都正常，如下，"><a href="#這樣子的-log-在測試機都正常運作，唯獨在正式機卻會發生第1個檔案-0-的-log-檔有正常產生，但-1-的檔案卻一直被重覆的寫，導致要看-log-都常常看不到-SystemRollingFileAppender-。雖然-maxSizeRollBackups-設定了-2000-，但使終都只有-2-個檔案。-在我的-Local-測試也都沒什麼問題，用測試程式看它的-m-curSizeRollBackups-屬性也都正常，如下，" class="headerlink" title="這樣子的 log 在測試機都正常運作，唯獨在正式機卻會發生第1個檔案 .0 的 log 檔有正常產生，但 .1 的檔案卻一直被重覆的寫，導致要看 log 都常常看不到 (SystemRollingFileAppender)。雖然 maxSizeRollBackups 設定了 2000 ，但使終都只有 2 個檔案。 在我的 Local 測試也都沒什麼問題，用測試程式看它的 m_curSizeRollBackups 屬性也都正常，如下，"></a>這樣子的 log 在測試機都正常運作，唯獨在正式機卻會發生第1個檔案 .0 的 log 檔有正常產生，但 .1 的檔案卻一直被重覆的寫，導致要看 log 都常常看不到 (SystemRollingFileAppender)。雖然 maxSizeRollBackups 設定了 2000 ，但使終都只有 2 個檔案。 在我的 Local 測試也都沒什麼問題，用測試程式看它的 m_curSizeRollBackups 屬性也都正常，如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 如果不是透過 class access ，記得要在 Application_Start 呼叫 log4net.Config.XmlConfigurator.Configure(); 哦!</span></div><div class="line"><span class="keyword">var</span> logType = System.Reflection.MethodBase.GetCurrentMethod().DeclaringType;</div><div class="line"><span class="comment">//Assembly assem = logType.Assembly;</span></div><div class="line"><span class="keyword">var</span> logger = LogManager.GetLogger(logType);</div><div class="line"><span class="keyword">var</span> appenders = logger.Logger.Repository.GetAppenders();</div><div class="line"><span class="keyword">var</span> rollingAppenders = appenders.OfType&lt;RollingFileAppender&gt;();</div><div class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> appender <span class="keyword">in</span> rollingAppenders)</div><div class="line">&#123;</div><div class="line">	Response.Write(<span class="string">$"&lt;h3&gt;*** Name:<span class="subst">&#123;appender.Name&#125;</span> *** &lt;/h3&gt;"</span>);</div><div class="line">	Response.Write(<span class="string">$"File : <span class="subst">&#123;appender.File&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">	Response.Write(<span class="string">$"CountDirection : <span class="subst">&#123;appender.CountDirection&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">	Response.Write(<span class="string">$"MaxSizeRollBackups : <span class="subst">&#123;appender.MaxSizeRollBackups&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">	Response.Write(<span class="string">$"MaxFileSize : <span class="subst">&#123;appender.MaxFileSize&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">	Response.Write(<span class="string">$"StaticLogFileName : <span class="subst">&#123;appender.StaticLogFileName&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">	<span class="keyword">var</span> propInfo = appender.GetType().BaseType.BaseType</div><div class="line">		.GetProperty(<span class="string">"QuietWriter"</span>, BindingFlags.NonPublic | BindingFlags.Instance);</div><div class="line"></div><div class="line">	<span class="keyword">var</span> quiteWriter = propInfo?.GetValue(appender) <span class="keyword">as</span> CountingQuietTextWriter;</div><div class="line">	Response.Write(<span class="string">$"FileSize : <span class="subst">&#123;quiteWriter?.Count&#125;</span>&lt;br/&gt;"</span>);</div><div class="line"></div><div class="line">	<span class="keyword">var</span> scheduleFieldInfo = appender.GetType().GetField(<span class="string">"m_scheduledFilename"</span>, BindingFlags.NonPublic | BindingFlags.Instance);</div><div class="line">	<span class="keyword">var</span> scheduleField = scheduleFieldInfo.GetValue(appender) ;</div><div class="line">	Response.Write(<span class="string">$"m_scheduledFilename : <span class="subst">&#123;scheduleField&#125;</span>&lt;br/&gt;"</span>);</div><div class="line"></div><div class="line">	<span class="keyword">var</span> m_curSizeRollBackupsFieldInfo = appender.GetType().GetField(<span class="string">"m_curSizeRollBackups"</span>, BindingFlags.NonPublic | BindingFlags.Instance);</div><div class="line">	<span class="keyword">var</span> m_curSizeRollBackupsField = m_curSizeRollBackupsFieldInfo.GetValue(appender);</div><div class="line">	Response.Write(<span class="string">$"m_curSizeRollBackups : <span class="subst">&#123;m_curSizeRollBackupsField&#125;</span>&lt;br/&gt;"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="如下，-log4net-寫到了-2017-10-27-14-DB-log-6-這個檔案，"><a href="#如下，-log4net-寫到了-2017-10-27-14-DB-log-6-這個檔案，" class="headerlink" title="如下， log4net 寫到了 2017-10-27-14-DB.log.6 這個檔案，"></a>如下， log4net 寫到了 2017-10-27-14-DB.log.6 這個檔案，</h3><img src="/2017/10/27/2017010/002.png" alt="002.png" title="">
<h3 id="後來我將-IIS-Express-的站台關掉再重新執行，結果-m-curSizeRollBackups-的值居然變成了-0-。如下，"><a href="#後來我將-IIS-Express-的站台關掉再重新執行，結果-m-curSizeRollBackups-的值居然變成了-0-。如下，" class="headerlink" title="後來我將 IIS Express 的站台關掉再重新執行，結果 m_curSizeRollBackups 的值居然變成了 0 。如下，"></a>後來我將 IIS Express 的站台關掉再重新執行，結果 m_curSizeRollBackups 的值居然變成了 0 。如下，</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">*** Name:SystemRollingFileAppender ***</div><div class="line"></div><div class="line">File : C:\Users\rainm\Documents\Visual Studio 2017\Projects\log4netTest\log4netTest\temp\2017\10\27\2017-10-27-14-DB.log.0</div><div class="line">CountDirection : 1</div><div class="line">MaxSizeRollBackups : 2000</div><div class="line">MaxFileSize : 20480</div><div class="line">StaticLogFileName : False</div><div class="line">FileSize : 20540</div><div class="line">m_scheduledFilename : C:\Users\rainm\Documents\Visual Studio 2017\Projects\log4netTest\log4netTest\temp\2017\10\27\2017-10-27-14-DB.log.0</div><div class="line">m_curSizeRollBackups : 0</div></pre></td></tr></table></figure>
<h3 id="天呀-我重現了問題了，當-系統重啟後，-log4net-的-m-curSizeRollBackups-就會被重置成-0-。maybe-是-log4net-的-bug-，從-github-下載最新的-log4net-v-2-0-9-來試，居然也是一樣的狀況-。"><a href="#天呀-我重現了問題了，當-系統重啟後，-log4net-的-m-curSizeRollBackups-就會被重置成-0-。maybe-是-log4net-的-bug-，從-github-下載最新的-log4net-v-2-0-9-來試，居然也是一樣的狀況-。" class="headerlink" title="天呀! 我重現了問題了，當 系統重啟後， log4net 的 m_curSizeRollBackups 就會被重置成 0 。maybe 是 log4net 的 bug ，從 github 下載最新的 log4net v 2.0.9 來試，居然也是一樣的狀況 。"></a>天呀! 我重現了問題了，當 系統重啟後， log4net 的 m_curSizeRollBackups 就會被重置成 0 。maybe 是 log4net 的 bug ，從 github 下載最新的 log4net v 2.0.9 來試，居然也是一樣的狀況 。</h3><h3 id="查看github-logging-log4net的-source-，開啟-RollingFileAppender-cs-來看，從-DetermineCurSizeRollBackups-這個-Method"><a href="#查看github-logging-log4net的-source-，開啟-RollingFileAppender-cs-來看，從-DetermineCurSizeRollBackups-這個-Method" class="headerlink" title="查看github logging-log4net的 source ，開啟 RollingFileAppender.cs 來看，從 DetermineCurSizeRollBackups 這個 Method"></a>查看<a href="https://github.com/apache/logging-log4net" target="_blank" rel="external">github logging-log4net</a>的 source ，開啟 RollingFileAppender.cs 來看，從 DetermineCurSizeRollBackups 這個 Method</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DetermineCurSizeRollBackups</span>(<span class="params"></span>)</span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	m_curSizeRollBackups = <span class="number">0</span>;</div><div class="line"></div><div class="line">	<span class="keyword">string</span> fullPath = <span class="literal">null</span>;</div><div class="line">	<span class="keyword">string</span> fileName = <span class="literal">null</span>;</div><div class="line"></div><div class="line">	<span class="keyword">using</span>(SecurityContext.Impersonate(<span class="keyword">this</span>))</div><div class="line">	&#123;</div><div class="line">		fullPath = System.IO.Path.GetFullPath(m_baseFileName);</div><div class="line">		fileName = System.IO.Path.GetFileName(fullPath);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	ArrayList arrayFiles = GetExistingFiles(fullPath);</div><div class="line">	InitializeRollBackups(fileName, arrayFiles);</div><div class="line"></div><div class="line">	LogLog.Debug(declaringType, <span class="string">"curSizeRollBackups starts at ["</span>+m_curSizeRollBackups+<span class="string">"]"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="它會把-Log-目錄中的檔案傳給-InitializeRollBackups-這個-Method，如下，"><a href="#它會把-Log-目錄中的檔案傳給-InitializeRollBackups-這個-Method，如下，" class="headerlink" title="它會把 Log 目錄中的檔案傳給 InitializeRollBackups 這個 Method，如下，"></a>它會把 Log 目錄中的檔案傳給 InitializeRollBackups 這個 Method，如下，</h3><pre><code class="csharp"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">InitializeRollBackups</span>(<span class="params"><span class="keyword">string</span> baseFile, ArrayList arrayFiles</span>)</span>
<span class="function"></span>{
    <span class="keyword">if</span> (<span class="literal">null</span> != arrayFiles)
    {
        <span class="keyword">string</span> baseFileLower = baseFile.ToLower(System.Globalization.CultureInfo.InvariantCulture);

        <span class="keyword">foreach</span>(<span class="keyword">string</span> curFileName <span class="keyword">in</span> arrayFiles)
        {
            InitializeFromOneFile(baseFileLower, curFileName.ToLower(System.Globalization.CultureInfo.InvariantCulture));
        }
    }
}
</code></pre>
<h3 id="而-InitializeRollBackups-中會將-baseFile-轉成小寫-再傳入-InitializeFromOneFile-這個-Method-去比較，而在-InitializeFromOneFile-有一行是比較-baseFile-與-prefix-及-suffix-比較-if-curFileName-StartsWith-prefix-curFileName-EndsWith-suffix-。"><a href="#而-InitializeRollBackups-中會將-baseFile-轉成小寫-再傳入-InitializeFromOneFile-這個-Method-去比較，而在-InitializeFromOneFile-有一行是比較-baseFile-與-prefix-及-suffix-比較-if-curFileName-StartsWith-prefix-curFileName-EndsWith-suffix-。" class="headerlink" title="而 InitializeRollBackups 中會將 baseFile 轉成小寫 再傳入 InitializeFromOneFile 這個 Method 去比較，而在 InitializeFromOneFile 有一行是比較 baseFile 與 prefix 及 suffix 比較(if (!curFileName.StartsWith(prefix) || !curFileName.EndsWith(suffix)))。"></a>而 InitializeRollBackups 中會將 baseFile <em>轉成小寫</em> 再傳入 InitializeFromOneFile 這個 Method 去比較，而在 InitializeFromOneFile 有一行是比較 baseFile 與 prefix 及 suffix 比較(<em>if (!curFileName.StartsWith(prefix) || !curFileName.EndsWith(suffix))</em>)。</h3><h3 id="prefix-就是-config-中-datePattern-的設定值-yyyy-MM-dd-HH-DB3-lo-g-，眼尖的朋友有發現了嗎-我們的檔名裡面的-DB-是大寫，但程式中-log4net-已將目前的-log-檔轉成了小寫，當然比不到。所以在系統重啟時，-m-curSizeRollBackups-的值就會是-0-。"><a href="#prefix-就是-config-中-datePattern-的設定值-yyyy-MM-dd-HH-DB3-lo-g-，眼尖的朋友有發現了嗎-我們的檔名裡面的-DB-是大寫，但程式中-log4net-已將目前的-log-檔轉成了小寫，當然比不到。所以在系統重啟時，-m-curSizeRollBackups-的值就會是-0-。" class="headerlink" title="prefix 就是 config 中 datePattern 的設定值 (yyyy-MM-dd-HH-DB3.lo\g)，眼尖的朋友有發現了嗎? 我們的檔名裡面的 DB 是大寫，但程式中 log4net 已將目前的 log 檔轉成了小寫，當然比不到。所以在系統重啟時， m_curSizeRollBackups 的值就會是 0 。"></a>prefix 就是 config 中 datePattern 的設定值 (<em>yyyy-MM-dd-HH-DB3.lo\g</em>)，眼尖的朋友有發現了嗎? 我們的檔名裡面的 DB 是大寫，但程式中 log4net 已將目前的 log 檔轉成了小寫，當然比不到。所以在系統重啟時， m_curSizeRollBackups 的值就會是 0 。</h3><h3 id="應該要將-if-curFileName-StartsWith-prefix-curFileName-EndsWith-suffix-改成不分大小寫的比較才對，if-curFileName-StartsWith-prefix-StringComparison-CurrentCultureIgnoreCase-curFileName-EndsWith-suffix-StringComparison-CurrentCultureIgnoreCase-。"><a href="#應該要將-if-curFileName-StartsWith-prefix-curFileName-EndsWith-suffix-改成不分大小寫的比較才對，if-curFileName-StartsWith-prefix-StringComparison-CurrentCultureIgnoreCase-curFileName-EndsWith-suffix-StringComparison-CurrentCultureIgnoreCase-。" class="headerlink" title="應該要將 if (!curFileName.StartsWith(prefix) || !curFileName.EndsWith(suffix)) 改成不分大小寫的比較才對，if (!curFileName.StartsWith(prefix, StringComparison.CurrentCultureIgnoreCase) || !curFileName.EndsWith(suffix, StringComparison.CurrentCultureIgnoreCase))。"></a>應該要將 <em>if (!curFileName.StartsWith(prefix) || !curFileName.EndsWith(suffix))</em> 改成不分大小寫的比較才對，<em>if (!curFileName.StartsWith(prefix, StringComparison.CurrentCultureIgnoreCase) || !curFileName.EndsWith(suffix, StringComparison.CurrentCultureIgnoreCase))</em>。</h3><ul>
<li><h2 id="請注意哦-目前-github-上的版本還沒有修正哦"><a href="#請注意哦-目前-github-上的版本還沒有修正哦" class="headerlink" title="請注意哦~~ 目前 github 上的版本還沒有修正哦 !!!"></a>請注意哦~~ 目前 github 上的版本還沒有修正哦 !!!</h2></li>
</ul>
<h3 id="所以目前有以下2項解法，"><a href="#所以目前有以下2項解法，" class="headerlink" title="所以目前有以下2項解法，"></a>所以目前有以下2項解法，</h3><ul>
<li><h3 id="改程式然後更新-log4net"><a href="#改程式然後更新-log4net" class="headerlink" title="改程式然後更新 log4net"></a>改程式然後更新 log4net</h3></li>
<li><h3 id="將檔名-datePattern-從大寫改成小寫，例如-yyyy-MM-dd-HH-db-lo-g-d前面要有-哦"><a href="#將檔名-datePattern-從大寫改成小寫，例如-yyyy-MM-dd-HH-db-lo-g-d前面要有-哦" class="headerlink" title="將檔名 datePattern 從大寫改成小寫，例如 yyyy-MM-dd-HH-\db.lo\g  (d前面要有 \ 哦!)"></a>將檔名 datePattern 從大寫改成小寫，例如 yyyy-MM-dd-HH-\db.lo\g  (d前面要有 \ 哦!)</h3></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/27/2017010/" data-id="cjawajb260000qk9j2xs4tqws" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Composite/">Composite</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DetermineCurSizeRollBackups/">DetermineCurSizeRollBackups</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/InitializeFromOneFile/">InitializeFromOneFile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/InitializeRollBackups/">InitializeRollBackups</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RollingFileAppender/">RollingFileAppender</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/log4net/">log4net</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171027" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/27/20171027/" class="article-date">
  <time datetime="2017-10-27T03:21:44.000Z" itemprop="datePublished">2017-10-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/27/20171027/">透過 SmtpClient 寄送 Mail 時，主旨在 Zimbra 會有 ? 的狀況</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="最近同事詢問透過-SmtpClient-去寄送-Mail-時，在-Zimbra-的-Web-界面看會有-的狀況，如下圖，"><a href="#最近同事詢問透過-SmtpClient-去寄送-Mail-時，在-Zimbra-的-Web-界面看會有-的狀況，如下圖，" class="headerlink" title="最近同事詢問透過 SmtpClient 去寄送 Mail 時，在 Zimbra 的 Web 界面看會有 ? 的狀況，如下圖，"></a>最近同事詢問透過 <a href="https://msdn.microsoft.com/zh-tw/library/system.net.mail.smtpclient" target="_blank" rel="external">SmtpClient</a> 去寄送 Mail 時，在 Zimbra 的 Web 界面看會有 ? 的狀況，如下圖，</h3><img src="/2017/10/27/20171027/001.png" alt="001.png" title="">
<h3 id="觀察發現，當主旨太長時才會有這個問題。在-Zimbra-中檢查-Mail-的內容，發現主旨被切分成多段，如下圖，"><a href="#觀察發現，當主旨太長時才會有這個問題。在-Zimbra-中檢查-Mail-的內容，發現主旨被切分成多段，如下圖，" class="headerlink" title="觀察發現，當主旨太長時才會有這個問題。在 Zimbra 中檢查 Mail 的內容，發現主旨被切分成多段，如下圖，"></a>觀察發現，當主旨太長時才會有這個問題。在 Zimbra 中檢查 Mail 的內容，發現主旨被切分成多段，如下圖，</h3><img src="/2017/10/27/20171027/002.png" alt="002.png" title="">
<h3 id="而那些再透過-Base64-轉回來，的確會有-的狀況，看起來應該是-MailMessage-在切分時剛好切到一半所造成的，如下圖，"><a href="#而那些再透過-Base64-轉回來，的確會有-的狀況，看起來應該是-MailMessage-在切分時剛好切到一半所造成的，如下圖，" class="headerlink" title="而那些再透過 Base64 轉回來，的確會有 ? 的狀況，看起來應該是 MailMessage 在切分時剛好切到一半所造成的，如下圖，"></a>而那些再透過 Base64 轉回來，的確會有 ? 的狀況，看起來應該是 MailMessage 在切分時剛好切到一半所造成的，如下圖，</h3><img src="/2017/10/27/20171027/004.png" alt="004.png" title="">
<h3 id="但是這樣子的狀況，在-outlook-來看卻是沒問的哦-如下圖，"><a href="#但是這樣子的狀況，在-outlook-來看卻是沒問的哦-如下圖，" class="headerlink" title="但是這樣子的狀況，在 outlook 來看卻是沒問的哦~~~ 如下圖，"></a>但是這樣子的狀況，在 outlook 來看卻是沒問的哦~~~ 如下圖，</h3><img src="/2017/10/27/20171027/003.png" alt="003.png" title="">
<h3 id="在網路上查到-4-0-SMTPClient-Send-Attachments-mit-Umlauten-im-Dateinamen-，它指出-Base64-會每-30-個字切成一段去串，QuotedPrintable-則是每-76-個字去切。-而我們的狀況似乎是因為它是將字串轉成-Base64-去切，所以會有切到一半的狀況。"><a href="#在網路上查到-4-0-SMTPClient-Send-Attachments-mit-Umlauten-im-Dateinamen-，它指出-Base64-會每-30-個字切成一段去串，QuotedPrintable-則是每-76-個字去切。-而我們的狀況似乎是因為它是將字串轉成-Base64-去切，所以會有切到一半的狀況。" class="headerlink" title="在網路上查到 4.0 SMTPClient.Send Attachments mit Umlauten im Dateinamen ，它指出 Base64 會每 30 個字切成一段去串，QuotedPrintable 則是每 76 個字去切。 而我們的狀況似乎是因為它是將字串轉成 Base64 去切，所以會有切到一半的狀況。"></a>在網路上查到 <a href="https://social.msdn.microsoft.com/Forums/en-US/b6c764f7-4697-4394-b45f-128a24306d55/40-smtpclientsend-attachments-mit-umlauten-im-dateinamen?forum=dotnetframeworkde" target="_blank" rel="external">4.0 SMTPClient.Send Attachments mit Umlauten im Dateinamen</a> ，它指出 Base64 會每 30 個字切成一段去串，QuotedPrintable 則是每 76 個字去切。 而我們的狀況似乎是因為它是將字串轉成 Base64 去切，所以會有切到一半的狀況。</h3><h3 id="所以我們可以調整他的做法，將原始的字串依-7-個字串先切開再串接即可，如下，"><a href="#所以我們可以調整他的做法，將原始的字串依-7-個字串先切開再串接即可，如下，" class="headerlink" title="所以我們可以調整他的做法，將原始的字串依 7 個字串先切開再串接即可，如下，"></a>所以我們可以調整他的做法，將原始的字串依 7 個字串先切開再串接即可，如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EmailHeaderHelper</span></div><div class="line">&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">ToBase64</span>(<span class="params"><span class="keyword">string</span> displayName</span>)</span></div><div class="line"><span class="function">	</span>&#123;</div><div class="line">		<span class="keyword">string</span> tranferEncodingMarker = String.Empty;</div><div class="line">		<span class="keyword">string</span> encodingMarker = String.Empty;</div><div class="line">		<span class="keyword">int</span> maxChunkLength = <span class="number">0</span>;</div><div class="line"></div><div class="line">		tranferEncodingMarker = <span class="string">"B"</span>;</div><div class="line">		encodingMarker = <span class="string">"UTF-8"</span>;</div><div class="line">		maxChunkLength = <span class="number">30</span> / <span class="number">4</span>;</div><div class="line"></div><div class="line">		<span class="keyword">string</span> encodingtoken = String.Format(<span class="string">"=?&#123;0&#125;?&#123;1&#125;?"</span>, encodingMarker, tranferEncodingMarker);</div><div class="line">		<span class="keyword">string</span> softbreak = <span class="string">"?="</span>;</div><div class="line">		<span class="keyword">var</span> encodeDisplayName = <span class="keyword">new</span> StringBuilder();</div><div class="line"></div><div class="line">		<span class="keyword">foreach</span> (<span class="function"><span class="keyword">var</span> splitItem <span class="keyword">in</span> <span class="title">SplitByLength</span>(<span class="params">displayName, maxChunkLength</span>))</span></div><div class="line"><span class="function">		</span>&#123;</div><div class="line">			encodeDisplayName.Append(encodingtoken);</div><div class="line">			encodeDisplayName.Append(Convert.ToBase64String(Encoding.UTF8.GetBytes(splitItem)));</div><div class="line">			encodeDisplayName.Append(softbreak);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> encodeDisplayName.ToString();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> IEnumerable&lt;<span class="keyword">string</span>&gt; <span class="title">SplitByLength</span>(<span class="params"><span class="keyword">string</span> stringToSplit, <span class="keyword">int</span> length</span>)</span></div><div class="line"><span class="function">	</span>&#123;</div><div class="line">		<span class="keyword">while</span> (stringToSplit.Length &gt; length)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">yield</span> <span class="keyword">return</span> stringToSplit.Substring(<span class="number">0</span>, length);</div><div class="line">			stringToSplit = stringToSplit.Substring(length);</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="keyword">if</span> (stringToSplit.Length &gt; <span class="number">0</span>) <span class="keyword">yield</span> <span class="keyword">return</span> stringToSplit;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="所以使用如下，"><a href="#所以使用如下，" class="headerlink" title="所以使用如下，"></a>所以使用如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">string</span> subject = <span class="string">"華華華(華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華"</span>;</div><div class="line">message.Subject = EmailHeaderHelper.ToBase64(subject);</div></pre></td></tr></table></figure>
<h3 id="不過筆者發現，如果您有2個-utf-8-B-的話，-NET-的-Mail-元件似乎也不會自動去幫你切斷，所以另個寫法是自已串-Base64-的字串後，再串一個空的-utf-8-B-，如下，"><a href="#不過筆者發現，如果您有2個-utf-8-B-的話，-NET-的-Mail-元件似乎也不會自動去幫你切斷，所以另個寫法是自已串-Base64-的字串後，再串一個空的-utf-8-B-，如下，" class="headerlink" title="不過筆者發現，如果您有2個 =?utf-8?B? 的話， .NET 的 Mail 元件似乎也不會自動去幫你切斷，所以另個寫法是自已串 Base64 的字串後，再串一個空的 =?utf-8?B? ，如下，"></a>不過筆者發現，如果您有2個 <em>=?utf-8?B?</em> 的話， .NET 的 Mail 元件似乎也不會自動去幫你切斷，所以另個寫法是自已串 Base64 的字串後，再串一個空的 <em>=?utf-8?B?</em> ，如下，</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">string</span> subject = <span class="string">"華華華(華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華華"</span>;</div><div class="line"><span class="keyword">byte</span>[] subjectBytes = Encoding.GetEncoding(<span class="string">"utf-8"</span>).GetBytes(subject);</div><div class="line"><span class="keyword">string</span> subjectBase64 = <span class="string">"=?utf-8?B?"</span> + Convert.ToBase64String(subjectBytes) + <span class="string">"?="</span>;</div><div class="line"><span class="comment">//多加一個空的 =?utf-8?B??= ，就不會再被切開了</span></div><div class="line">subjectBase64 += <span class="string">"=?utf-8?B??="</span>;</div><div class="line">message.Subject = subjectBase64;</div></pre></td></tr></table></figure>
<img src="/2017/10/27/20171027/005.png" alt="005.png" title="">
<h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul>
<li><a href="https://social.msdn.microsoft.com/Forums/en-US/b6c764f7-4697-4394-b45f-128a24306d55/40-smtpclientsend-attachments-mit-umlauten-im-dateinamen?forum=dotnetframeworkde" target="_blank" rel="external">4.0 SMTPClient.Send Attachments mit Umlauten im Dateinamen</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/27/20171027/" data-id="cjawajb36000hqk9ji61hdkst" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/utf-8-B/">=?utf-8?B?</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/號/">?號</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Attachments/">Attachments</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MailMessage/">MailMessage</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Multiple/">Multiple</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SMTPClient/">SMTPClient</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Subject/">Subject</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171017-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/17/20171017-2/" class="article-date">
  <time datetime="2017-10-17T05:34:17.000Z" itemprop="datePublished">2017-10-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/17/20171017-2/">Compiling IB documents for earlier than iOS 7 is no longer supported.</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="最近透過-Xcode-9-建置舊的-Cordova-專案，在建置時就發生-Compiling-IB-documents-for-earlier-than-iOS-7-is-no-longer-supported-的錯誤，依Illegal-Configuration-Compiling-IB-documents-for-earlier-than-iOS-7-is-no-longer-supported的說明，只要將-Interface-Builder-Document-的-Builds-for-改成-iOS-7-0-後版本就可以了，如下圖所示，"><a href="#最近透過-Xcode-9-建置舊的-Cordova-專案，在建置時就發生-Compiling-IB-documents-for-earlier-than-iOS-7-is-no-longer-supported-的錯誤，依Illegal-Configuration-Compiling-IB-documents-for-earlier-than-iOS-7-is-no-longer-supported的說明，只要將-Interface-Builder-Document-的-Builds-for-改成-iOS-7-0-後版本就可以了，如下圖所示，" class="headerlink" title="最近透過 Xcode 9 建置舊的 Cordova 專案，在建置時就發生 Compiling IB documents for earlier than iOS 7 is no longer supported. 的錯誤，依Illegal Configuration: Compiling IB documents for earlier than iOS 7 is no longer supported的說明，只要將 Interface Builder Document 的 Builds for 改成 iOS 7.0 後版本就可以了，如下圖所示，"></a>最近透過 Xcode 9 建置舊的 Cordova 專案，在建置時就發生 <em>Compiling IB documents for earlier than iOS 7 is no longer supported.</em> 的錯誤，依<a href="https://stackoverflow.com/questions/44429415/illegal-configuration-compiling-ib-documents-for-earlier-than-ios-7-is-no-longe" target="_blank" rel="external">Illegal Configuration: Compiling IB documents for earlier than iOS 7 is no longer supported</a>的說明，只要將 Interface Builder Document 的 <em>Builds for</em> 改成 iOS 7.0 後版本就可以了，如下圖所示，</h3><img src="/2017/10/17/20171017-2/IBVersion.png" alt="IBVersion.png" title="">
      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/17/20171017-2/" data-id="cjawajb33000eqk9j6frxaonq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ios/">ios</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xCode-9/">xCode 9</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171017" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/17/20171017/" class="article-date">
  <time datetime="2017-10-17T05:10:42.000Z" itemprop="datePublished">2017-10-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/17/20171017/">Add a profile to the provisioningProfiles dictionary in your Export Options property list.</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="最近透過-xcodebuild-來產生-ipa-檔時，以下的錯誤，"><a href="#最近透過-xcodebuild-來產生-ipa-檔時，以下的錯誤，" class="headerlink" title="最近透過 xcodebuild 來產生 ipa 檔時，以下的錯誤，"></a>最近透過 xcodebuild 來產生 ipa 檔時，以下的錯誤，</h3><p><em>error: exportArchive: …app requires a provisioning profile.</em><br><em>Error Domain=IDEProvisioningErrorDomain Code=9 …requires a provisioning profile. …NSLocalizedRecoverySuggestion=Add a profile to the “provisioningProfiles” dictionary in your Export Options property list.}</em></p>
<img src="/2017/10/17/20171017/exportArchiveFail.png" alt="exportArchiveFail.png" title="">
<h3 id="原來是因為-xCode-9-的-export-Options-plist-檔中需要再指定-provisioningProfiles-相關資料，內容如下圖，"><a href="#原來是因為-xCode-9-的-export-Options-plist-檔中需要再指定-provisioningProfiles-相關資料，內容如下圖，" class="headerlink" title="原來是因為 xCode 9 的 export Options plist 檔中需要再指定 provisioningProfiles 相關資料，內容如下圖，"></a>原來是因為 xCode 9 的 export Options plist 檔中需要再指定 <em>provisioningProfiles</em> 相關資料，內容如下圖，</h3><img src="/2017/10/17/20171017/exportOptionsPlist.png" alt="exportOptionsPlist.png" title="">
<h3 id="最簡單的方式可以參考-New-export-options-Plist-in-Xcode-9-的方式，先透過-Xcode-產生-ipa-後，在-ipa-的目錄中會有-ExportOptions-plist-檔案，直接將它拿來用就可以了哦"><a href="#最簡單的方式可以參考-New-export-options-Plist-in-Xcode-9-的方式，先透過-Xcode-產生-ipa-後，在-ipa-的目錄中會有-ExportOptions-plist-檔案，直接將它拿來用就可以了哦" class="headerlink" title="最簡單的方式可以參考 New export options Plist in Xcode 9 的方式，先透過 Xcode 產生 ipa 後，在 ipa 的目錄中會有 ExportOptions.plist 檔案，直接將它拿來用就可以了哦!"></a>最簡單的方式可以參考 <a href="https://blog.bitrise.io/new-export-options-plist-in-xcode-9" target="_blank" rel="external">New export options Plist in Xcode 9</a> 的方式，先透過 Xcode 產生 ipa 後，在 ipa 的目錄中會有 <em>ExportOptions.plist</em> 檔案，直接將它拿來用就可以了哦!</h3><h2 id="參考資訊"><a href="#參考資訊" class="headerlink" title="參考資訊"></a>參考資訊</h2><ul>
<li><p><a href="http://www.matrixprojects.net/p/xcodebuild-export-options-plist/" target="_blank" rel="external">xcodebuild’s new exportOptionsPlist flag</a></p>
</li>
<li><p><a href="https://blog.bitrise.io/new-export-options-plist-in-xcode-9" target="_blank" rel="external">New export options Plist in Xcode 9</a></p>
</li>
<li><p><a href="https://stackoverflow.com/questions/39674237/xcrun-command-to-export-ipa-file-xcode8-for-iphoneos10-0" target="_blank" rel="external">xcrun command to export ipa file xcode8 for iphoneos10.0</a></p>
</li>
<li><p><a href="https://medium.com/xcblog/xcodebuild-deploy-ios-app-from-command-line-c6defff0d8b8" target="_blank" rel="external">xcodebuild: Deploy iOS app from Command Line</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/88d9f2e57004" target="_blank" rel="external">xcodebuild命令简单使用</a></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/17/20171017/" data-id="cjawajb35000gqk9jbcfp4qyc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Export-Options-property-list/">Export Options property list</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Xcode-9/">Xcode 9</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exportArchive/">exportArchive</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exportOptionsPlist/">exportOptionsPlist</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ios/">ios</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/provisioningProfiles/">provisioningProfiles</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xcodebuild/">xcodebuild</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-20171013" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/13/20171013/" class="article-date">
  <time datetime="2017-10-13T14:02:06.000Z" itemprop="datePublished">2017-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/13/20171013/">從外部資料庫驅動程式產生的非預期的錯誤 (1) @ OleDbConnection.Open</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="今天同事詢問有沒有看過以下的錯誤訊息，"><a href="#今天同事詢問有沒有看過以下的錯誤訊息，" class="headerlink" title="今天同事詢問有沒有看過以下的錯誤訊息，"></a>今天同事詢問有沒有看過以下的錯誤訊息，</h3><p><em><system.data.oledb.oledbexception> 從外部資料庫驅動程式產生的非預期的錯誤 (1)。 [ OleDbException.ErrorCode : -2147467259 ]</system.data.oledb.oledbexception></em></p>
<p><em>Unexpected error from external database driver (1). (Microsoft JET Database Engine)</em></p>
<h3 id="程式只是透過-Provider-Microsoft-Jet-OLEDB-4-0-去開啟一個-excel-檔而已，而且同事詢問這個問題後，另一位同事也在詢問相同的問題。"><a href="#程式只是透過-Provider-Microsoft-Jet-OLEDB-4-0-去開啟一個-excel-檔而已，而且同事詢問這個問題後，另一位同事也在詢問相同的問題。" class="headerlink" title="程式只是透過 Provider=Microsoft.Jet.OLEDB.4.0; 去開啟一個 excel 檔而已，而且同事詢問這個問題後，另一位同事也在詢問相同的問題。"></a>程式只是透過 <em>Provider=Microsoft.Jet.OLEDB.4.0;</em> 去開啟一個 excel 檔而已，而且同事詢問這個問題後，另一位同事也在詢問相同的問題。</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> conn = <span class="keyword">new</span> System.Data.OleDb.OleDbConnection(<span class="string">"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\Users\\kt\\Documents\\VS Code\\TEST_EXCEL\\aa.xls;Extended Properties=\"Excel 8.0;HDR=Yes;IMEX=1;\""</span>);</div><div class="line">conn.Open();</div></pre></td></tr></table></figure>
<h3 id="但這支程式前陣子用的好好的呀-為什麼今天卻發生了這樣子的錯誤呢"><a href="#但這支程式前陣子用的好好的呀-為什麼今天卻發生了這樣子的錯誤呢" class="headerlink" title="但這支程式前陣子用的好好的呀! 為什麼今天卻發生了這樣子的錯誤呢?"></a>但這支程式前陣子用的好好的呀! 為什麼今天卻發生了這樣子的錯誤呢?</h3><h3 id="於是往-Windows-更新來看，發現有2個更新，如下，"><a href="#於是往-Windows-更新來看，發現有2個更新，如下，" class="headerlink" title="於是往 Windows 更新來看，發現有2個更新，如下，"></a>於是往 Windows 更新來看，發現有2個更新，如下，</h3><img src="/2017/10/13/20171013/windowsUpdate.png" alt="windowsUpdate.png" title="">
<h3 id="查看一下-kb4041681-裡面有更動到-Microsoft-JET-Database-Engine-而我們是有用到它呢-於是將它反安裝後重新開機後，再執行程式就沒問題了。"><a href="#查看一下-kb4041681-裡面有更動到-Microsoft-JET-Database-Engine-而我們是有用到它呢-於是將它反安裝後重新開機後，再執行程式就沒問題了。" class="headerlink" title="查看一下 kb4041681 , 裡面有更動到 Microsoft JET Database Engine 而我們是有用到它呢!!! 於是將它反安裝後重新開機後，再執行程式就沒問題了。"></a>查看一下 <a href="https://support.microsoft.com/en-us/help/4041681/windows-7-update-kb4041681" target="_blank" rel="external">kb4041681</a> , 裡面有更動到 <em>Microsoft JET Database Engine</em> 而我們是有用到它呢!!! 於是將它反安裝後重新開機後，再執行程式就沒問題了。</h3><h3 id="這個更新似乎將-msexcl40-dll-從-V4-00-9801-0-to-v4-00-9801-1-，-X64-在-C-Windows-SysWOW64-目錄。"><a href="#這個更新似乎將-msexcl40-dll-從-V4-00-9801-0-to-v4-00-9801-1-，-X64-在-C-Windows-SysWOW64-目錄。" class="headerlink" title="這個更新似乎將 msexcl40.dll 從 V4.00.9801.0 to v4.00.9801.1 ， X64 在 C:\Windows\SysWOW64 目錄。"></a>這個更新似乎將 msexcl40.dll 從 V4.00.9801.0 to v4.00.9801.1 ， X64 在 C:\Windows\SysWOW64 目錄。</h3><h2 id="依-“Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine-”-after-applying-October-security-updates-的說明，解法有以下3個，"><a href="#依-“Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine-”-after-applying-October-security-updates-的說明，解法有以下3個，" class="headerlink" title="依 “Unexpected error from external database driver (1). (Microsoft JET Database Engine)” after applying October security updates. 的說明，解法有以下3個，"></a>依 <a href="https://blogs.msdn.microsoft.com/dataaccesstechnologies/2017/10/18/unexpected-error-from-external-database-driver-1-microsoft-jet-database-engine-after-applying-october-security-updates/" target="_blank" rel="external">“Unexpected error from external database driver (1). (Microsoft JET Database Engine)” after applying October security updates.</a> 的說明，解法有以下3個，</h2><h3 id="1-安裝更新後，調整程式，方式如下，"><a href="#1-安裝更新後，調整程式，方式如下，" class="headerlink" title="1.安裝更新後，調整程式，方式如下，"></a>1.安裝更新後，調整程式，方式如下，</h3><ul>
<li>安裝 <a href="https://www.microsoft.com/zh-tw/download/details.aspx?id=13255" target="_blank" rel="external">Microsoft Access Database Engine 2010 可轉散發套件</a> 有分 x86/x64 版本哦! </li>
<li>將連線字串從 Provider=Microsoft.Jet.OLEDB.4.0  改成 Provider=Microsoft.ACE.OLEDB.12.0 </li>
</ul>
<h3 id="2-移除相關的-KB"><a href="#2-移除相關的-KB" class="headerlink" title="2.移除相關的 KB"></a>2.移除相關的 KB</h3><h3 id="3-使用舊的-msexcl40-dll-v4-00-9801-1-以前的版本"><a href="#3-使用舊的-msexcl40-dll-v4-00-9801-1-以前的版本" class="headerlink" title="3.使用舊的 msexcl40.dll (v4.00.9801.1 以前的版本)"></a>3.使用舊的 msexcl40.dll (v4.00.9801.1 以前的版本)</h3><ul>
<li>先到可以運作的電腦中 Copy msexcel40.dll 存到某個目錄之中，例如 c:\excel32 。</li>
<li>修改註冊機碼 [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Jet\4.0\Engines\Excel\Win32] 從原本的 C:\Windows\SysWOW64\msexcel40.dll 改成 c:\excel32\msexcel40.dll 。<img src="/2017/10/13/20171013/002.png" alt="002.png" title="">
</li>
</ul>
<h3 id="Windows-Update-其中的內容如下，"><a href="#Windows-Update-其中的內容如下，" class="headerlink" title="Windows Update 其中的內容如下，"></a>Windows Update 其中的內容如下，</h3><p><em>Security updates to Microsoft Windows Search Component, Windows kernel-mode drivers, Microsoft Graphics Component, Internet Explorer, Windows kernel, Windows Wireless Networking, Microsoft JET Database Engine, and the Windows SMB Server.</em></p>
<h3 id="目前發現有以下幾個-kb-會影響到，"><a href="#目前發現有以下幾個-kb-會影響到，" class="headerlink" title="目前發現有以下幾個 kb 會影響到，"></a>目前發現有以下幾個 kb 會影響到，</h3><ul>
<li><p><a href="https://support.microsoft.com/en-us/help/4041678/windows-7-update-kb4041678" target="_blank" rel="external">kb4041678</a> Win 7 / Win 2008 </p>
</li>
<li><p><a href="https://support.microsoft.com/en-us/help/4041681/windows-7-update-kb4041681" target="_blank" rel="external">kb4041681</a> Win 7 / Win 2008</p>
</li>
<li><p><a href="https://support.microsoft.com/zh-hk/help/4042007/description-of-the-security-update-for-the-microsoft-jet-database-engi" target="_blank" rel="external">Kb4042007</a> Win 2008</p>
</li>
<li><p><a href="https://support.microsoft.com/en-us/help/4041691/windows-10-update-kb4041691" target="_blank" rel="external">kb4041691</a> Win 10 / Win 2016</p>
</li>
<li><p><a href="https://support.microsoft.com/en-us/help/4041676/windows-10-update-kb4041676" target="_blank" rel="external">kb4041676</a> Win 10</p>
</li>
<li><p>如果有一樣的錯誤訊息，應該是因為 windows update ，請檢查最近的 windows update 哦! 可以的話也讓小弟知道一下下 ^_^</p>
</li>
</ul>
<h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><p><a href="http://www.cnblogs.com/net-god/p/7661313.html" target="_blank" rel="external">Excel Microsoft.Jet.OLEDB.4.0 外部数据库驱动程序中(1)的意外错误</a></p>
<p><a href="https://support.microsoft.com/zh-hk/help/4042007/description-of-the-security-update-for-the-microsoft-jet-database-engi" target="_blank" rel="external">Kb4042007 Microsoft Jet 资料库引擎遠端執行程式碼弱點的安全性更新：2017 年 10 月 10 日</a></p>
<p><a href="https://blogs.msdn.microsoft.com/dataaccesstechnologies/2017/10/18/unexpected-error-from-external-database-driver-1-microsoft-jet-database-engine-after-applying-october-security-updates/" target="_blank" rel="external">“Unexpected error from external database driver (1). (Microsoft JET Database Engine)” after applying October security updates.</a></p>
<h3 id="註-在-“Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine-”-after-applying-October-security-updates-有貼出-Microsoft-修正的-Update-了哦-請參考"><a href="#註-在-“Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine-”-after-applying-October-security-updates-有貼出-Microsoft-修正的-Update-了哦-請參考" class="headerlink" title="註:在 “Unexpected error from external database driver (1). (Microsoft JET Database Engine)” after applying October security updates. 有貼出 Microsoft 修正的 Update 了哦! 請參考"></a>註:在 <a href="https://blogs.msdn.microsoft.com/dataaccesstechnologies/2017/10/18/unexpected-error-from-external-database-driver-1-microsoft-jet-database-engine-after-applying-october-security-updates/" target="_blank" rel="external">“Unexpected error from external database driver (1). (Microsoft JET Database Engine)” after applying October security updates.</a> 有貼出 Microsoft 修正的 Update 了哦! 請參考</h3><p>Windows 7/2008 R2</p>
<p>-Monthly Roll-up - <a href="https://support.microsoft.com/en-us/help/4048957/windows-7-update-kb4048957" target="_blank" rel="external">https://support.microsoft.com/en-us/help/4048957/windows-7-update-kb4048957</a></p>
<p>-Security-only update - <a href="https://support.microsoft.com/en-us/help/4048960/windows-7-update-kb4048960" target="_blank" rel="external">https://support.microsoft.com/en-us/help/4048960/windows-7-update-kb4048960</a></p>
<p>Windows 2012</p>
<p>-Monthly Roll-up - <a href="https://support.microsoft.com/en-us/help/4048959/windows-server-2012-update-kb4048959" target="_blank" rel="external">https://support.microsoft.com/en-us/help/4048959/windows-server-2012-update-kb4048959</a></p>
<p>-Security-only update - <a href="https://support.microsoft.com/en-us/help/4048962/windows-server-2012-update-kb4048962" target="_blank" rel="external">https://support.microsoft.com/en-us/help/4048962/windows-server-2012-update-kb4048962</a></p>
<p>Windows 8.1 and 2012 R2</p>
<p>-Monthly Roll-up - <a href="https://support.microsoft.com/en-us/help/4048958/windows-81-update-kb4048958" target="_blank" rel="external">https://support.microsoft.com/en-us/help/4048958/windows-81-update-kb4048958</a></p>
<p>-Security-only update - <a href="https://support.microsoft.com/en-us/help/4048961/windows-81-update-kb4048961" target="_blank" rel="external">https://support.microsoft.com/en-us/help/4048961/windows-81-update-kb4048961</a></p>
<p>Windows 10 Fall (“November”) Update, version 1511</p>
<p>-<a href="https://support.microsoft.com/en-us/help/4048952" target="_blank" rel="external">https://support.microsoft.com/en-us/help/4048952</a></p>
<p>Windows 10 Anniversary Update, version 1607, and Server 2016</p>
<p>-<a href="https://support.microsoft.com/en-us/help/4048953" target="_blank" rel="external">https://support.microsoft.com/en-us/help/4048953</a></p>
<p>Windows 10 , version 1703</p>
<p>-<a href="https://support.microsoft.com/en-us/help/4048954/windows-10-update-kb4048954" target="_blank" rel="external">https://support.microsoft.com/en-us/help/4048954/windows-10-update-kb4048954</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rainmakerho.github.io/2017/10/13/20171013/" data-id="cjawajb32000dqk9j92yetmaa" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Microsoft-Jet-OLEDB-4-0/">Microsoft.Jet.OLEDB.4.0</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unexpected-error-from-external-database-driver-1/">Unexpected error from external database driver (1)</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine/">Unexpected error from external database driver (1). (Microsoft JET Database Engine)</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kb4041676/">kb4041676</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kb4041678/">kb4041678</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kb4041681/">kb4041681</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kb4041691/">kb4041691</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/外部数据库驱动程序中-1-的意外错误/">外部数据库驱动程序中(1)的意外错误</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/從外部資料庫驅動程式產生的非預期的錯誤-1/">從外部資料庫驅動程式產生的非預期的錯誤 (1)</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/404/">404</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/utf-8-B/">=?utf-8?B?</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/號/">?號</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Aspose-Words/">Aspose.Words</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Attachments/">Attachments</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CompatibilityOptions/">CompatibilityOptions</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Composite/">Composite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Concurrent/">Concurrent</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Deployment-Target/">Deployment Target</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DetermineCurSizeRollBackups/">DetermineCurSizeRollBackups</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DocumentBuilder/">DocumentBuilder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EnableSessionState/">EnableSessionState</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Export-Options-property-list/">Export Options property list</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GrowAutofit/">GrowAutofit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/How-to-get-value-to-variable-using-execute-in-t-sql/">How to get value to variable using 'execute' in t-sql?</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IIS/">IIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/InitializeFromOneFile/">InitializeFromOneFile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/InitializeRollBackups/">InitializeRollBackups</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/InsertHtml/">InsertHtml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MailMessage/">MailMessage</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Microsoft-Jet-OLEDB-4-0/">Microsoft.Jet.OLEDB.4.0</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MinimumOSVersion/">MinimumOSVersion</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MtouchArch/">MtouchArch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Multiple/">Multiple</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NumberStyle/">NumberStyle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OPTIONS/">OPTIONS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PDF/">PDF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RollingFileAppender/">RollingFileAppender</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SMTPClient/">SMTPClient</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL-License/">SQL License</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL援權/">SQL援權</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Session/">Session</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SessionStateStoreProvider/">SessionStateStoreProvider</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Subject/">Subject</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TradChinNum3/">TradChinNum3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unexpected-error-from-external-database-driver-1/">Unexpected error from external database driver (1)</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine/">Unexpected error from external database driver (1). (Microsoft JET Database Engine)</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Xcode-9/">Xcode 9</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aspose-words/">aspose.words</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/com-apple-CoreSimulator-SimDeviceType-undefined/">com.apple.CoreSimulator.SimDeviceType.undefined</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cordova/">cordova</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deadlock/">deadlock</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exchangeEvent/">exchangeEvent</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exec/">exec</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exec-in-t-sql/">exec in t-sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/execute/">execute</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exportArchive/">exportArchive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exportOptionsPlist/">exportOptionsPlist</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ibtoolerror/">ibtoolerror</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios/">ios</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios-11/">ios 11</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios11/">ios11</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kb4041676/">kb4041676</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kb4041678/">kb4041678</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kb4041681/">kb4041681</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kb4041691/">kb4041691</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log4net/">log4net</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/provisioningProfiles/">provisioningProfiles</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scrollbar/">scrollbar</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xCode-9/">xCode 9</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xamarin/">xamarin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xcodebuild/">xcodebuild</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/交換事件/">交換事件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/外部数据库驱动程序中-1-的意外错误/">外部数据库驱动程序中(1)的意外错误</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/從外部資料庫驅動程式產生的非預期的錯誤-1/">從外部資料庫驅動程式產生的非預期的錯誤 (1)</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/要求篩選/">要求篩選</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/404/" style="font-size: 10px;">404</a> <a href="/tags/utf-8-B/" style="font-size: 10px;">=?utf-8?B?</a> <a href="/tags/號/" style="font-size: 10px;">?號</a> <a href="/tags/Aspose-Words/" style="font-size: 10px;">Aspose.Words</a> <a href="/tags/Attachments/" style="font-size: 10px;">Attachments</a> <a href="/tags/CompatibilityOptions/" style="font-size: 10px;">CompatibilityOptions</a> <a href="/tags/Composite/" style="font-size: 10px;">Composite</a> <a href="/tags/Concurrent/" style="font-size: 10px;">Concurrent</a> <a href="/tags/Deployment-Target/" style="font-size: 10px;">Deployment Target</a> <a href="/tags/DetermineCurSizeRollBackups/" style="font-size: 10px;">DetermineCurSizeRollBackups</a> <a href="/tags/DocumentBuilder/" style="font-size: 10px;">DocumentBuilder</a> <a href="/tags/EnableSessionState/" style="font-size: 10px;">EnableSessionState</a> <a href="/tags/Export-Options-property-list/" style="font-size: 10px;">Export Options property list</a> <a href="/tags/GrowAutofit/" style="font-size: 10px;">GrowAutofit</a> <a href="/tags/How-to-get-value-to-variable-using-execute-in-t-sql/" style="font-size: 10px;">How to get value to variable using 'execute' in t-sql?</a> <a href="/tags/IIS/" style="font-size: 10px;">IIS</a> <a href="/tags/InitializeFromOneFile/" style="font-size: 10px;">InitializeFromOneFile</a> <a href="/tags/InitializeRollBackups/" style="font-size: 10px;">InitializeRollBackups</a> <a href="/tags/InsertHtml/" style="font-size: 10px;">InsertHtml</a> <a href="/tags/MailMessage/" style="font-size: 10px;">MailMessage</a> <a href="/tags/Microsoft-Jet-OLEDB-4-0/" style="font-size: 10px;">Microsoft.Jet.OLEDB.4.0</a> <a href="/tags/MinimumOSVersion/" style="font-size: 10px;">MinimumOSVersion</a> <a href="/tags/MtouchArch/" style="font-size: 10px;">MtouchArch</a> <a href="/tags/Multiple/" style="font-size: 10px;">Multiple</a> <a href="/tags/NumberStyle/" style="font-size: 10px;">NumberStyle</a> <a href="/tags/OPTIONS/" style="font-size: 10px;">OPTIONS</a> <a href="/tags/PDF/" style="font-size: 10px;">PDF</a> <a href="/tags/RollingFileAppender/" style="font-size: 10px;">RollingFileAppender</a> <a href="/tags/SMTPClient/" style="font-size: 10px;">SMTPClient</a> <a href="/tags/SQL/" style="font-size: 10px;">SQL</a> <a href="/tags/SQL-License/" style="font-size: 10px;">SQL License</a> <a href="/tags/SQL援權/" style="font-size: 10px;">SQL援權</a> <a href="/tags/Session/" style="font-size: 10px;">Session</a> <a href="/tags/SessionStateStoreProvider/" style="font-size: 10px;">SessionStateStoreProvider</a> <a href="/tags/Subject/" style="font-size: 10px;">Subject</a> <a href="/tags/TradChinNum3/" style="font-size: 10px;">TradChinNum3</a> <a href="/tags/Unexpected-error-from-external-database-driver-1/" style="font-size: 10px;">Unexpected error from external database driver (1)</a> <a href="/tags/Unexpected-error-from-external-database-driver-1-Microsoft-JET-Database-Engine/" style="font-size: 10px;">Unexpected error from external database driver (1). (Microsoft JET Database Engine)</a> <a href="/tags/Xcode-9/" style="font-size: 10px;">Xcode 9</a> <a href="/tags/aspose-words/" style="font-size: 10px;">aspose.words</a> <a href="/tags/com-apple-CoreSimulator-SimDeviceType-undefined/" style="font-size: 10px;">com.apple.CoreSimulator.SimDeviceType.undefined</a> <a href="/tags/cordova/" style="font-size: 10px;">cordova</a> <a href="/tags/deadlock/" style="font-size: 10px;">deadlock</a> <a href="/tags/exchangeEvent/" style="font-size: 10px;">exchangeEvent</a> <a href="/tags/exec/" style="font-size: 10px;">exec</a> <a href="/tags/exec-in-t-sql/" style="font-size: 10px;">exec in t-sql</a> <a href="/tags/execute/" style="font-size: 10px;">execute</a> <a href="/tags/exportArchive/" style="font-size: 10px;">exportArchive</a> <a href="/tags/exportOptionsPlist/" style="font-size: 10px;">exportOptionsPlist</a> <a href="/tags/ibtoolerror/" style="font-size: 10px;">ibtoolerror</a> <a href="/tags/ios/" style="font-size: 20px;">ios</a> <a href="/tags/ios-11/" style="font-size: 10px;">ios 11</a> <a href="/tags/ios11/" style="font-size: 10px;">ios11</a> <a href="/tags/kb4041676/" style="font-size: 10px;">kb4041676</a> <a href="/tags/kb4041678/" style="font-size: 10px;">kb4041678</a> <a href="/tags/kb4041681/" style="font-size: 10px;">kb4041681</a> <a href="/tags/kb4041691/" style="font-size: 10px;">kb4041691</a> <a href="/tags/log4net/" style="font-size: 10px;">log4net</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/provisioningProfiles/" style="font-size: 10px;">provisioningProfiles</a> <a href="/tags/scrollbar/" style="font-size: 10px;">scrollbar</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/xCode-9/" style="font-size: 10px;">xCode 9</a> <a href="/tags/xamarin/" style="font-size: 10px;">xamarin</a> <a href="/tags/xcodebuild/" style="font-size: 10px;">xcodebuild</a> <a href="/tags/交換事件/" style="font-size: 10px;">交換事件</a> <a href="/tags/外部数据库驱动程序中-1-的意外错误/" style="font-size: 10px;">外部数据库驱动程序中(1)的意外错误</a> <a href="/tags/從外部資料庫驅動程式產生的非預期的錯誤-1/" style="font-size: 10px;">從外部資料庫驅動程式產生的非預期的錯誤 (1)</a> <a href="/tags/要求篩選/" style="font-size: 10px;">要求篩選</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Arkiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Siste innlegg</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/12/07/2017015/">為什麼 OPTIONS 時會給 404 呢?</a>
          </li>
        
          <li>
            <a href="/2017/11/30/2017014/">Writeable Session 造成網頁被卡住的問題</a>
          </li>
        
          <li>
            <a href="/2017/11/29/2017013/">為什麼 scrollbar 在 mac os 的 browser 無法顯示出來呢?</a>
          </li>
        
          <li>
            <a href="/2017/11/16/2017012/">解析 SQL Server Deadlocks</a>
          </li>
        
          <li>
            <a href="/2017/11/09/2017011/">Aspose.Words DocumentBuilder 加入 htmlTable 轉成 PDF 檔問題</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Rainmaker<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>